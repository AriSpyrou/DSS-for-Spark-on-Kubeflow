++ id -u
+ myuid=1000
++ id -g
+ mygid=1000
+ set +e
++ getent passwd 1000
+ uidentry=hadoop:x:1000:1000::/home/hadoop:/bin/sh
+ set -e
+ '[' -z hadoop:x:1000:1000::/home/hadoop:/bin/sh ']'
+ SPARK_CLASSPATH=':/opt/spark/jars/*'
+ env
+ sed 's/[^=]*=\(.*\)/\1/g'
+ sort -t_ -k4 -n
+ grep SPARK_JAVA_OPT_
+ readarray -t SPARK_EXECUTOR_JAVA_OPTS
+ '[' -n '/opt/hadoop/etc/hadoop:/opt/hadoop/share/hadoop/common/lib/*:/opt/hadoop/share/hadoop/common/*:/opt/hadoop/share/hadoop/hdfs:/opt/hadoop/share/hadoop/hdfs/lib/*:/opt/hadoop/share/hadoop/hdfs/*:/opt/hadoop/share/hadoop/yarn:/opt/hadoop/share/hadoop/yarn/lib/*:/opt/hadoop/share/hadoop/yarn/*:/opt/hadoop/share/hadoop/mapreduce/lib/*:/opt/hadoop/share/hadoop/mapreduce/*:/contrib/capacity-scheduler/*.jar:/opt/hadoop/share/hadoop/tools/lib/*' ']'
+ SPARK_CLASSPATH=':/opt/spark/jars/*:/opt/hadoop/etc/hadoop:/opt/hadoop/share/hadoop/common/lib/*:/opt/hadoop/share/hadoop/common/*:/opt/hadoop/share/hadoop/hdfs:/opt/hadoop/share/hadoop/hdfs/lib/*:/opt/hadoop/share/hadoop/hdfs/*:/opt/hadoop/share/hadoop/yarn:/opt/hadoop/share/hadoop/yarn/lib/*:/opt/hadoop/share/hadoop/yarn/*:/opt/hadoop/share/hadoop/mapreduce/lib/*:/opt/hadoop/share/hadoop/mapreduce/*:/contrib/capacity-scheduler/*.jar:/opt/hadoop/share/hadoop/tools/lib/*'
+ '[' -z ']'
+ '[' -z ']'
+ '[' -n /opt/hadoop ']'
+ '[' -z '/opt/hadoop/etc/hadoop:/opt/hadoop/share/hadoop/common/lib/*:/opt/hadoop/share/hadoop/common/*:/opt/hadoop/share/hadoop/hdfs:/opt/hadoop/share/hadoop/hdfs/lib/*:/opt/hadoop/share/hadoop/hdfs/*:/opt/hadoop/share/hadoop/yarn:/opt/hadoop/share/hadoop/yarn/lib/*:/opt/hadoop/share/hadoop/yarn/*:/opt/hadoop/share/hadoop/mapreduce/lib/*:/opt/hadoop/share/hadoop/mapreduce/*:/contrib/capacity-scheduler/*.jar:/opt/hadoop/share/hadoop/tools/lib/*' ']'
+ '[' -z ']'
+ '[' -z x ']'
+ SPARK_CLASSPATH='/opt/spark/conf::/opt/spark/jars/*:/opt/hadoop/etc/hadoop:/opt/hadoop/share/hadoop/common/lib/*:/opt/hadoop/share/hadoop/common/*:/opt/hadoop/share/hadoop/hdfs:/opt/hadoop/share/hadoop/hdfs/lib/*:/opt/hadoop/share/hadoop/hdfs/*:/opt/hadoop/share/hadoop/yarn:/opt/hadoop/share/hadoop/yarn/lib/*:/opt/hadoop/share/hadoop/yarn/*:/opt/hadoop/share/hadoop/mapreduce/lib/*:/opt/hadoop/share/hadoop/mapreduce/*:/contrib/capacity-scheduler/*.jar:/opt/hadoop/share/hadoop/tools/lib/*'
+ case "$1" in
+ shift 1
+ CMD=("$SPARK_HOME/bin/spark-submit" --conf "spark.driver.bindAddress=$SPARK_DRIVER_BIND_ADDRESS" --deploy-mode client "$@")
+ exec /usr/bin/tini -s -- /opt/spark/bin/spark-submit --conf spark.driver.bindAddress=10.1.91.227 --deploy-mode client --properties-file /opt/spark/conf/spark.properties --class com.amazonaws.eks.tpcds.BenchmarkSQL local:///opt/spark/examples/jars/eks-spark-benchmark-assembly-1.0.jar hdfs:///tpcds-data hdfs:///tpcds-result /opt/tpcds-kit/tools parquet 10 3 false q64-v2.4,q70-v2.4,q82-v2.4 true
2022-09-08 15:10:35,233 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
DATA DIR is hdfs:///tpcds-data
2022-09-08 15:10:35,635 INFO spark.SparkContext: Running Spark version 3.1.2
2022-09-08 15:10:35,783 INFO resource.ResourceUtils: ==============================================================
2022-09-08 15:10:35,784 INFO resource.ResourceUtils: No custom resources configured for spark.driver.
2022-09-08 15:10:35,784 INFO resource.ResourceUtils: ==============================================================
2022-09-08 15:10:35,785 INFO spark.SparkContext: Submitted application: TPCDS SQL Benchmark 10 GB
2022-09-08 15:10:35,844 INFO resource.ResourceProfile: Default ResourceProfile created, executor resources: Map(cores -> name: cores, amount: 2, script: , vendor: , memory -> name: memory, amount: 3072, script: , vendor: , offHeap -> name: offHeap, amount: 0, script: , vendor: ), task resources: Map(cpus -> name: cpus, amount: 1.0)
2022-09-08 15:10:35,876 INFO resource.ResourceProfile: Limiting resource is cpus at 2 tasks per executor
2022-09-08 15:10:35,880 INFO resource.ResourceProfileManager: Added ResourceProfile id: 0
2022-09-08 15:10:36,048 INFO spark.SecurityManager: Changing view acls to: hadoop,root
2022-09-08 15:10:36,049 INFO spark.SecurityManager: Changing modify acls to: hadoop,root
2022-09-08 15:10:36,049 INFO spark.SecurityManager: Changing view acls groups to: 
2022-09-08 15:10:36,050 INFO spark.SecurityManager: Changing modify acls groups to: 
2022-09-08 15:10:36,050 INFO spark.SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users  with view permissions: Set(hadoop, root); groups with view permissions: Set(); users  with modify permissions: Set(hadoop, root); groups with modify permissions: Set()
2022-09-08 15:10:36,078 INFO Configuration.deprecation: fs.default.name is deprecated. Instead, use fs.defaultFS
2022-09-08 15:10:36,772 INFO util.Utils: Successfully started service 'sparkDriver' on port 7078.
2022-09-08 15:10:36,858 INFO spark.SparkEnv: Registering MapOutputTracker
2022-09-08 15:10:36,947 INFO spark.SparkEnv: Registering BlockManagerMaster
2022-09-08 15:10:37,006 INFO storage.BlockManagerMasterEndpoint: Using org.apache.spark.storage.DefaultTopologyMapper for getting topology information
2022-09-08 15:10:37,007 INFO storage.BlockManagerMasterEndpoint: BlockManagerMasterEndpoint up
2022-09-08 15:10:37,018 INFO spark.SparkEnv: Registering BlockManagerMasterHeartbeat
2022-09-08 15:10:37,058 INFO storage.DiskBlockManager: Created local directory at /tmp/spark-local-dir/blockmgr-5e13d670-9547-4558-83de-b28fa9e32979
2022-09-08 15:10:37,105 INFO memory.MemoryStore: MemoryStore started with capacity 1458.6 MiB
2022-09-08 15:10:37,150 INFO spark.SparkEnv: Registering OutputCommitCoordinator
2022-09-08 15:10:37,426 INFO util.log: Logging initialized @5700ms to org.sparkproject.jetty.util.log.Slf4jLog
2022-09-08 15:10:37,675 INFO server.Server: jetty-9.4.40.v20210413; built: 2021-04-13T20:42:42.668Z; git: b881a572662e1943a14ae12e7e1207989f218b74; jvm 1.8.0_322-b06
2022-09-08 15:10:37,762 INFO server.Server: Started @6039ms
2022-09-08 15:10:37,841 INFO server.AbstractConnector: Started ServerConnector@3e681bc{HTTP/1.1, (http/1.1)}{0.0.0.0:4040}
2022-09-08 15:10:37,841 INFO util.Utils: Successfully started service 'SparkUI' on port 4040.
2022-09-08 15:10:37,889 INFO handler.ContextHandler: Started o.s.j.s.ServletContextHandler@867ba60{/jobs,null,AVAILABLE,@Spark}
2022-09-08 15:10:37,892 INFO handler.ContextHandler: Started o.s.j.s.ServletContextHandler@2d140a7{/jobs/json,null,AVAILABLE,@Spark}
2022-09-08 15:10:37,893 INFO handler.ContextHandler: Started o.s.j.s.ServletContextHandler@2aa27288{/jobs/job,null,AVAILABLE,@Spark}
2022-09-08 15:10:37,902 INFO handler.ContextHandler: Started o.s.j.s.ServletContextHandler@240139e1{/jobs/job/json,null,AVAILABLE,@Spark}
2022-09-08 15:10:37,903 INFO handler.ContextHandler: Started o.s.j.s.ServletContextHandler@49298ce7{/stages,null,AVAILABLE,@Spark}
2022-09-08 15:10:37,904 INFO handler.ContextHandler: Started o.s.j.s.ServletContextHandler@8dfe921{/stages/json,null,AVAILABLE,@Spark}
2022-09-08 15:10:37,904 INFO handler.ContextHandler: Started o.s.j.s.ServletContextHandler@55f45b92{/stages/stage,null,AVAILABLE,@Spark}
2022-09-08 15:10:37,906 INFO handler.ContextHandler: Started o.s.j.s.ServletContextHandler@3dedb4a6{/stages/stage/json,null,AVAILABLE,@Spark}
2022-09-08 15:10:37,907 INFO handler.ContextHandler: Started o.s.j.s.ServletContextHandler@415e0bcb{/stages/pool,null,AVAILABLE,@Spark}
2022-09-08 15:10:37,908 INFO handler.ContextHandler: Started o.s.j.s.ServletContextHandler@49d98dc5{/stages/pool/json,null,AVAILABLE,@Spark}
2022-09-08 15:10:37,909 INFO handler.ContextHandler: Started o.s.j.s.ServletContextHandler@1d81e101{/storage,null,AVAILABLE,@Spark}
2022-09-08 15:10:37,910 INFO handler.ContextHandler: Started o.s.j.s.ServletContextHandler@bf71cec{/storage/json,null,AVAILABLE,@Spark}
2022-09-08 15:10:37,910 INFO handler.ContextHandler: Started o.s.j.s.ServletContextHandler@30cdae70{/storage/rdd,null,AVAILABLE,@Spark}
2022-09-08 15:10:37,911 INFO handler.ContextHandler: Started o.s.j.s.ServletContextHandler@2577d6c8{/storage/rdd/json,null,AVAILABLE,@Spark}
2022-09-08 15:10:37,912 INFO handler.ContextHandler: Started o.s.j.s.ServletContextHandler@6c000e0c{/environment,null,AVAILABLE,@Spark}
2022-09-08 15:10:37,913 INFO handler.ContextHandler: Started o.s.j.s.ServletContextHandler@44f9779c{/environment/json,null,AVAILABLE,@Spark}
2022-09-08 15:10:37,914 INFO handler.ContextHandler: Started o.s.j.s.ServletContextHandler@5e8a459{/executors,null,AVAILABLE,@Spark}
2022-09-08 15:10:37,915 INFO handler.ContextHandler: Started o.s.j.s.ServletContextHandler@4c9e9fb8{/executors/json,null,AVAILABLE,@Spark}
2022-09-08 15:10:37,916 INFO handler.ContextHandler: Started o.s.j.s.ServletContextHandler@40147317{/executors/threadDump,null,AVAILABLE,@Spark}
2022-09-08 15:10:37,917 INFO handler.ContextHandler: Started o.s.j.s.ServletContextHandler@19542407{/executors/threadDump/json,null,AVAILABLE,@Spark}
2022-09-08 15:10:37,935 INFO handler.ContextHandler: Started o.s.j.s.ServletContextHandler@c7a977f{/static,null,AVAILABLE,@Spark}
2022-09-08 15:10:37,936 INFO handler.ContextHandler: Started o.s.j.s.ServletContextHandler@3956b302{/,null,AVAILABLE,@Spark}
2022-09-08 15:10:37,937 INFO handler.ContextHandler: Started o.s.j.s.ServletContextHandler@1fd386c3{/api,null,AVAILABLE,@Spark}
2022-09-08 15:10:37,938 INFO handler.ContextHandler: Started o.s.j.s.ServletContextHandler@673bb956{/jobs/job/kill,null,AVAILABLE,@Spark}
2022-09-08 15:10:37,939 INFO handler.ContextHandler: Started o.s.j.s.ServletContextHandler@60e949e1{/stages/stage/kill,null,AVAILABLE,@Spark}
2022-09-08 15:10:37,941 INFO ui.SparkUI: Bound SparkUI to 0.0.0.0, and started at http://tpcds-benchmark-10g-3iter-1inst-1ef265831da6f468-driver-svc.spark-operator.svc:4040
2022-09-08 15:10:37,952 INFO Configuration.deprecation: fs.default.name is deprecated. Instead, use fs.defaultFS
2022-09-08 15:10:37,955 INFO spark.SparkContext: Added JAR local:///opt/spark/examples/jars/eks-spark-benchmark-assembly-1.0.jar at file:/opt/spark/examples/jars/eks-spark-benchmark-assembly-1.0.jar with timestamp 1662649835619
2022-09-08 15:10:37,955 WARN spark.SparkContext: The jar local:///opt/spark/examples/jars/eks-spark-benchmark-assembly-1.0.jar has been added already. Overwriting of added jars is not supported in the current version.
2022-09-08 15:10:38,127 INFO k8s.SparkKubernetesClientFactory: Auto-configuring K8S client using current context from users K8S config file
2022-09-08 15:10:40,637 INFO k8s.ExecutorPodsAllocator: Going to request 1 executors from Kubernetes for ResourceProfile Id: 0, target: 1 running: 0.
2022-09-08 15:10:40,802 INFO features.BasicExecutorFeatureStep: Decommissioning not enabled, skipping shutdown script
2022-09-08 15:10:40,914 INFO util.Utils: Successfully started service 'org.apache.spark.network.netty.NettyBlockTransferService' on port 7079.
2022-09-08 15:10:40,914 INFO netty.NettyBlockTransferService: Server created on tpcds-benchmark-10g-3iter-1inst-1ef265831da6f468-driver-svc.spark-operator.svc:7079
2022-09-08 15:10:40,933 INFO storage.BlockManager: Using org.apache.spark.storage.RandomBlockReplicationPolicy for block replication policy
2022-09-08 15:10:40,964 INFO storage.BlockManagerMaster: Registering BlockManager BlockManagerId(driver, tpcds-benchmark-10g-3iter-1inst-1ef265831da6f468-driver-svc.spark-operator.svc, 7079, None)
2022-09-08 15:10:40,969 INFO storage.BlockManagerMasterEndpoint: Registering block manager tpcds-benchmark-10g-3iter-1inst-1ef265831da6f468-driver-svc.spark-operator.svc:7079 with 1458.6 MiB RAM, BlockManagerId(driver, tpcds-benchmark-10g-3iter-1inst-1ef265831da6f468-driver-svc.spark-operator.svc, 7079, None)
2022-09-08 15:10:40,977 INFO storage.BlockManagerMaster: Registered BlockManager BlockManagerId(driver, tpcds-benchmark-10g-3iter-1inst-1ef265831da6f468-driver-svc.spark-operator.svc, 7079, None)
2022-09-08 15:10:40,981 INFO storage.BlockManager: Initialized BlockManager: BlockManagerId(driver, tpcds-benchmark-10g-3iter-1inst-1ef265831da6f468-driver-svc.spark-operator.svc, 7079, None)
2022-09-08 15:10:41,010 INFO handler.ContextHandler: Started o.s.j.s.ServletContextHandler@68d7a2df{/metrics/json,null,AVAILABLE,@Spark}
2022-09-08 15:10:49,532 INFO k8s.KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (10.1.236.159:56418) with ID 1,  ResourceProfileId 0
2022-09-08 15:10:49,584 INFO k8s.KubernetesClusterSchedulerBackend: SchedulerBackend is ready for scheduling beginning after reached minRegisteredResourcesRatio: 0.8
Only WARN
Creating temporary table catalog_sales using data stored in hdfs:///tpcds-data/catalog_sales.
2022-09-08 15:10:50,262 INFO tpcds.TPCDSTables: Creating temporary table catalog_sales using data stored in hdfs:///tpcds-data/catalog_sales.
2022-09-08 15:11:21,647 WARN util.package: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.sql.debug.maxToStringFields'.
Creating temporary table catalog_returns using data stored in hdfs:///tpcds-data/catalog_returns.
2022-09-08 15:11:21,677 INFO tpcds.TPCDSTables: Creating temporary table catalog_returns using data stored in hdfs:///tpcds-data/catalog_returns.
Creating temporary table inventory using data stored in hdfs:///tpcds-data/inventory.
2022-09-08 15:11:39,823 INFO tpcds.TPCDSTables: Creating temporary table inventory using data stored in hdfs:///tpcds-data/inventory.
Creating temporary table store_sales using data stored in hdfs:///tpcds-data/store_sales.
2022-09-08 15:11:42,475 INFO tpcds.TPCDSTables: Creating temporary table store_sales using data stored in hdfs:///tpcds-data/store_sales.
Creating temporary table store_returns using data stored in hdfs:///tpcds-data/store_returns.
2022-09-08 15:11:58,360 INFO tpcds.TPCDSTables: Creating temporary table store_returns using data stored in hdfs:///tpcds-data/store_returns.
2022-09-08 15:12:14,877 INFO tpcds.TPCDSTables: Creating temporary table web_sales using data stored in hdfs:///tpcds-data/web_sales.
Creating temporary table web_sales using data stored in hdfs:///tpcds-data/web_sales.
Creating temporary table web_returns using data stored in hdfs:///tpcds-data/web_returns.
2022-09-08 15:12:30,031 INFO tpcds.TPCDSTables: Creating temporary table web_returns using data stored in hdfs:///tpcds-data/web_returns.
Creating temporary table call_center using data stored in hdfs:///tpcds-data/call_center.
2022-09-08 15:12:47,387 INFO tpcds.TPCDSTables: Creating temporary table call_center using data stored in hdfs:///tpcds-data/call_center.
2022-09-08 15:12:47,656 INFO tpcds.TPCDSTables: Creating temporary table catalog_page using data stored in hdfs:///tpcds-data/catalog_page.
Creating temporary table catalog_page using data stored in hdfs:///tpcds-data/catalog_page.
Creating temporary table customer using data stored in hdfs:///tpcds-data/customer.
2022-09-08 15:12:47,845 INFO tpcds.TPCDSTables: Creating temporary table customer using data stored in hdfs:///tpcds-data/customer.
Creating temporary table customer_address using data stored in hdfs:///tpcds-data/customer_address.
2022-09-08 15:12:48,052 INFO tpcds.TPCDSTables: Creating temporary table customer_address using data stored in hdfs:///tpcds-data/customer_address.
Creating temporary table customer_demographics using data stored in hdfs:///tpcds-data/customer_demographics.
2022-09-08 15:12:48,248 INFO tpcds.TPCDSTables: Creating temporary table customer_demographics using data stored in hdfs:///tpcds-data/customer_demographics.
Creating temporary table date_dim using data stored in hdfs:///tpcds-data/date_dim.
2022-09-08 15:12:48,391 INFO tpcds.TPCDSTables: Creating temporary table date_dim using data stored in hdfs:///tpcds-data/date_dim.
Creating temporary table household_demographics using data stored in hdfs:///tpcds-data/household_demographics.
2022-09-08 15:12:48,587 INFO tpcds.TPCDSTables: Creating temporary table household_demographics using data stored in hdfs:///tpcds-data/household_demographics.
Creating temporary table income_band using data stored in hdfs:///tpcds-data/income_band.
2022-09-08 15:12:48,745 INFO tpcds.TPCDSTables: Creating temporary table income_band using data stored in hdfs:///tpcds-data/income_band.
Creating temporary table item using data stored in hdfs:///tpcds-data/item.
2022-09-08 15:12:48,902 INFO tpcds.TPCDSTables: Creating temporary table item using data stored in hdfs:///tpcds-data/item.
Creating temporary table promotion using data stored in hdfs:///tpcds-data/promotion.
2022-09-08 15:12:49,058 INFO tpcds.TPCDSTables: Creating temporary table promotion using data stored in hdfs:///tpcds-data/promotion.
Creating temporary table reason using data stored in hdfs:///tpcds-data/reason.
2022-09-08 15:12:49,228 INFO tpcds.TPCDSTables: Creating temporary table reason using data stored in hdfs:///tpcds-data/reason.
Creating temporary table ship_mode using data stored in hdfs:///tpcds-data/ship_mode.
2022-09-08 15:12:49,684 INFO tpcds.TPCDSTables: Creating temporary table ship_mode using data stored in hdfs:///tpcds-data/ship_mode.
Creating temporary table store using data stored in hdfs:///tpcds-data/store.
2022-09-08 15:12:49,850 INFO tpcds.TPCDSTables: Creating temporary table store using data stored in hdfs:///tpcds-data/store.
Creating temporary table time_dim using data stored in hdfs:///tpcds-data/time_dim.
2022-09-08 15:12:50,004 INFO tpcds.TPCDSTables: Creating temporary table time_dim using data stored in hdfs:///tpcds-data/time_dim.
Creating temporary table warehouse using data stored in hdfs:///tpcds-data/warehouse.
2022-09-08 15:12:50,153 INFO tpcds.TPCDSTables: Creating temporary table warehouse using data stored in hdfs:///tpcds-data/warehouse.
Creating temporary table web_page using data stored in hdfs:///tpcds-data/web_page.
2022-09-08 15:12:50,305 INFO tpcds.TPCDSTables: Creating temporary table web_page using data stored in hdfs:///tpcds-data/web_page.
2022-09-08 15:12:50,440 INFO tpcds.TPCDSTables: Creating temporary table web_site using data stored in hdfs:///tpcds-data/web_site.
Creating temporary table web_site using data stored in hdfs:///tpcds-data/web_site.
Running only queries: q64-v2.4,q70-v2.4,q82-v2.4
Couldn't read table cross_sales and its not defined as a Benchmark.Table.
Table store_sales exists.
Table date_dim exists.
Table store exists.
Table item exists.
Table inventory exists.
Running execution q64-v2.4 iteration: 1, StandardRun=true
2022-09-08 15:12:55,161 WARN adaptive.InsertAdaptiveSparkPlan: spark.sql.adaptive.enabled is enabled but is not supported for query: Sort [product_name#1280 ASC NULLS FIRST, store_name#1282 ASC NULLS FIRST, cnt#1514L ASC NULLS FIRST], true, 0
+- Project [product_name#1280, store_name#1282, store_zip#1283, b_street_number#1284, b_streen_name#1285, b_city#1286, b_zip#1287, c_street_number#1288, c_street_name#1289, c_city#1290, c_zip#1291, syear#1292, cnt#1295L, s1#1296, s2#1297, s3#1298, s1#1515, s2#1516, s3#1517, syear#1511, cnt#1514L]
   +- SortMergeJoin [item_sk#1281, store_name#1282, store_zip#1283], [item_sk#1500, store_name#1501, store_zip#1502], Inner, (cnt#1514L <= cnt#1295L)
      :- HashAggregate(keys=[i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#1387, ca_street_name#1388, ca_city#1391, ca_zip#1394, d_year#498, d_year#1321, d_year#1349], functions=[count(1), sum(UnscaledValue(ss_wholesale_cost#140)), sum(UnscaledValue(ss_list_price#141)), sum(UnscaledValue(ss_coupon_amt#148))], output=[product_name#1280, item_sk#1281, store_name#1282, store_zip#1283, b_street_number#1284, b_streen_name#1285, b_city#1286, b_zip#1287, c_street_number#1288, c_street_name#1289, c_city#1290, c_zip#1291, syear#1292, cnt#1295L, s1#1296, s2#1297, s3#1298])
      :  +- HashAggregate(keys=[i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#1387, ca_street_name#1388, ca_city#1391, ca_zip#1394, d_year#498, d_year#1321, d_year#1349], functions=[partial_count(1), partial_sum(UnscaledValue(ss_wholesale_cost#140)), partial_sum(UnscaledValue(ss_list_price#141)), partial_sum(UnscaledValue(ss_coupon_amt#148))], output=[i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#1387, ca_street_name#1388, ca_city#1391, ca_zip#1394, d_year#498, d_year#1321, d_year#1349, count#1549L, sum#1550L, sum#1551L, sum#1552L])
      :     +- Project [ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, d_year#1321, d_year#1349, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#1387, ca_street_name#1388, ca_city#1391, ca_zip#1394, i_item_sk#564, i_product_name#585]
      :        +- BroadcastHashJoin [ss_item_sk#131], [i_item_sk#564], Inner, BuildRight, false
      :           :- Project [ss_item_sk#131, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, d_year#1321, d_year#1349, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#1387, ca_street_name#1388, ca_city#1391, ca_zip#1394]
      :           :  +- BroadcastHashJoin [hd_income_band_sk#1381], [ib_income_band_sk#1398], Inner, BuildRight, false
      :           :     :- Project [ss_item_sk#131, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, d_year#1321, d_year#1349, hd_income_band_sk#1381, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#1387, ca_street_name#1388, ca_city#1391, ca_zip#1394]
      :           :     :  +- BroadcastHashJoin [hd_income_band_sk#549], [ib_income_band_sk#558], Inner, BuildRight, false
      :           :     :     :- Project [ss_item_sk#131, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, d_year#1321, d_year#1349, hd_income_band_sk#549, hd_income_band_sk#1381, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#1387, ca_street_name#1388, ca_city#1391, ca_zip#1394]
      :           :     :     :  +- BroadcastHashJoin [c_current_addr_sk#416], [ca_address_sk#1385], Inner, BuildRight, false
      :           :     :     :     :- Project [ss_item_sk#131, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_addr_sk#416, d_year#1321, d_year#1349, hd_income_band_sk#549, hd_income_band_sk#1381, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457]
      :           :     :     :     :  +- BroadcastHashJoin [ss_addr_sk#135], [ca_address_sk#448], Inner, BuildRight, false
      :           :     :     :     :     :- Project [ss_item_sk#131, ss_addr_sk#135, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_addr_sk#416, d_year#1321, d_year#1349, hd_income_band_sk#549, hd_income_band_sk#1381]
      :           :     :     :     :     :  +- BroadcastHashJoin [c_current_hdemo_sk#415], [hd_demo_sk#1380], Inner, BuildRight, false
      :           :     :     :     :     :     :- Project [ss_item_sk#131, ss_addr_sk#135, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_hdemo_sk#415, c_current_addr_sk#416, d_year#1321, d_year#1349, hd_income_band_sk#549]
      :           :     :     :     :     :     :  +- BroadcastHashJoin [ss_hdemo_sk#134], [hd_demo_sk#548], Inner, BuildRight, false
      :           :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_hdemo_sk#134, ss_addr_sk#135, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_hdemo_sk#415, c_current_addr_sk#416, d_year#1321, d_year#1349]
      :           :     :     :     :     :     :     :  +- BroadcastHashJoin [ss_promo_sk#137], [p_promo_sk#608], Inner, BuildRight, false
      :           :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_hdemo_sk#134, ss_addr_sk#135, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_hdemo_sk#415, c_current_addr_sk#416, d_year#1321, d_year#1349]
      :           :     :     :     :     :     :     :     :  +- BroadcastHashJoin [c_current_cdemo_sk#414], [cd_demo_sk#1371], Inner, BuildRight, NOT (cd_marital_status#476 = cd_marital_status#1373), false
      :           :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_hdemo_sk#134, ss_addr_sk#135, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_cdemo_sk#414, c_current_hdemo_sk#415, c_current_addr_sk#416, d_year#1321, d_year#1349, cd_marital_status#476]
      :           :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [ss_cdemo_sk#133], [cd_demo_sk#474], Inner, BuildRight, false
      :           :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_cdemo_sk#414, c_current_hdemo_sk#415, c_current_addr_sk#416, d_year#1321, d_year#1349]
      :           :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [c_first_shipto_date_sk#417], [d_date_sk#1343], Inner, BuildRight, false
      :           :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_cdemo_sk#414, c_current_hdemo_sk#415, c_current_addr_sk#416, c_first_shipto_date_sk#417, d_year#1321]
      :           :     :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [c_first_sales_date_sk#418], [d_date_sk#1315], Inner, BuildRight, false
      :           :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_cdemo_sk#414, c_current_hdemo_sk#415, c_current_addr_sk#416, c_first_shipto_date_sk#417, c_first_sales_date_sk#418]
      :           :     :     :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [ss_customer_sk#132], [c_customer_sk#412], Inner, BuildRight, false
      :           :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_customer_sk#132, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689]
      :           :     :     :     :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [ss_store_sk#136], [s_store_sk#664], Inner, BuildRight, false
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_customer_sk#132, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_store_sk#136, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498]
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [ss_sold_date_sk#152], [d_date_sk#492], Inner, BuildRight, false
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_customer_sk#132, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_store_sk#136, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, ss_sold_date_sk#152]
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- SortMergeJoin [ss_item_sk#131], [cs_item_sk#14], Inner
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_customer_sk#132, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_store_sk#136, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, ss_sold_date_sk#152]
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- SortMergeJoin [ss_item_sk#131, ss_ticket_number#138L], [sr_item_sk#177, sr_ticket_number#184L], Inner
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_customer_sk#132, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_store_sk#136, ss_promo_sk#137, ss_ticket_number#138L, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, ss_sold_date_sk#152]
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- Filter (((((((isnotnull(ss_item_sk#131) AND isnotnull(ss_ticket_number#138L)) AND isnotnull(ss_store_sk#136)) AND isnotnull(ss_customer_sk#132)) AND isnotnull(ss_cdemo_sk#133)) AND isnotnull(ss_promo_sk#137)) AND isnotnull(ss_hdemo_sk#134)) AND isnotnull(ss_addr_sk#135))
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- FileScan parquet [ss_item_sk#131,ss_customer_sk#132,ss_cdemo_sk#133,ss_hdemo_sk#134,ss_addr_sk#135,ss_store_sk#136,ss_promo_sk#137,ss_ticket_number#138L,ss_wholesale_cost#140,ss_list_price#141,ss_coupon_amt#148,ss_sold_date_sk#152] Batched: true, DataFilters: [isnotnull(ss_item_sk#131), isnotnull(ss_ticket_number#138L), isnotnull(ss_store_sk#136), isnotnu..., Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/store_sales], PartitionFilters: [isnotnull(ss_sold_date_sk#152), dynamicpruning#1543 [ss_sold_date_sk#152]], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_ticket_number), IsNotNull(ss_store_sk), IsNotNull(ss_custome..., ReadSchema: struct<ss_item_sk:int,ss_customer_sk:int,ss_cdemo_sk:int,ss_hdemo_sk:int,ss_addr_sk:int,ss_store_...
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- Project [d_date_sk#492, d_year#498]
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :              +- Filter ((isnotnull(d_year#498) AND (d_year#498 = 1999)) AND isnotnull(d_date_sk#492))
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                 +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [sr_item_sk#177, sr_ticket_number#184L]
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter (isnotnull(sr_item_sk#177) AND isnotnull(sr_ticket_number#184L))
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- FileScan parquet [sr_item_sk#177,sr_ticket_number#184L,sr_returned_date_sk#195] Batched: true, DataFilters: [isnotnull(sr_item_sk#177), isnotnull(sr_ticket_number#184L)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/store_returns], PartitionFilters: [], PushedFilters: [IsNotNull(sr_item_sk), IsNotNull(sr_ticket_number)], ReadSchema: struct<sr_item_sk:int,sr_ticket_number:bigint>
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [cs_item_sk#14]
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter (isnotnull(sum(cs_ext_list_price#24)#1308) AND (cast(sum(cs_ext_list_price#24)#1308 as decimal(21,2)) > CheckOverflow((2.00 * promote_precision(sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#90 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#91 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#92 as decimal(9,2)))), DecimalType(9,2), true))#1309)), DecimalType(21,2), true)))
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- HashAggregate(keys=[cs_item_sk#14], functions=[sum(UnscaledValue(cs_ext_list_price#24)), sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#90 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#91 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#92 as decimal(9,2)))), DecimalType(9,2), true))], output=[cs_item_sk#14, sum(cs_ext_list_price#24)#1308, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#90 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#91 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#92 as decimal(9,2)))), DecimalType(9,2), true))#1309])
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :              +- HashAggregate(keys=[cs_item_sk#14], functions=[partial_sum(UnscaledValue(cs_ext_list_price#24)), partial_sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#90 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#91 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#92 as decimal(9,2)))), DecimalType(9,2), true))], output=[cs_item_sk#14, sum#1556L, sum#1557, isEmpty#1558])
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                 +- Project [cs_item_sk#14, cs_ext_list_price#24, cr_refunded_cash#90, cr_reversed_charge#91, cr_store_credit#92]
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                    +- SortMergeJoin [cs_item_sk#14, cs_order_number#16L], [cr_item_sk#69, cr_order_number#83L], Inner
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                       :- Project [cs_item_sk#14, cs_order_number#16L, cs_ext_list_price#24]
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                       :  +- Filter (isnotnull(cs_item_sk#14) AND isnotnull(cs_order_number#16L))
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                       :     +- FileScan parquet [cs_item_sk#14,cs_order_number#16L,cs_ext_list_price#24,cs_sold_date_sk#33] Batched: true, DataFilters: [isnotnull(cs_item_sk#14), isnotnull(cs_order_number#16L)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/catalog_sales], PartitionFilters: [], PushedFilters: [IsNotNull(cs_item_sk), IsNotNull(cs_order_number)], ReadSchema: struct<cs_item_sk:int,cs_order_number:bigint,cs_ext_list_price:decimal(7,2)>
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                       +- Project [cr_item_sk#69, cr_order_number#83L, cr_refunded_cash#90, cr_reversed_charge#91, cr_store_credit#92]
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                          +- Filter (isnotnull(cr_item_sk#69) AND isnotnull(cr_order_number#83L))
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                             +- FileScan parquet [cr_item_sk#69,cr_order_number#83L,cr_refunded_cash#90,cr_reversed_charge#91,cr_store_credit#92,cr_returned_date_sk#94] Batched: true, DataFilters: [isnotnull(cr_item_sk#69), isnotnull(cr_order_number#83L)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/catalog_returns], PartitionFilters: [], PushedFilters: [IsNotNull(cr_item_sk), IsNotNull(cr_order_number)], ReadSchema: struct<cr_item_sk:int,cr_order_number:bigint,cr_refunded_cash:decimal(7,2),cr_reversed_charge:dec...
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [d_date_sk#492, d_year#498]
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter ((isnotnull(d_year#498) AND (d_year#498 = 1999)) AND isnotnull(d_date_sk#492))
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- FileScan parquet [d_date_sk#492,d_year#498] Batched: true, DataFilters: [isnotnull(d_year#498), (d_year#498 = 1999), isnotnull(d_date_sk#492)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), EqualTo(d_year,1999), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [s_store_sk#664, s_store_name#669, s_zip#689]
      :           :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter ((isnotnull(s_store_sk#664) AND isnotnull(s_store_name#669)) AND isnotnull(s_zip#689))
      :           :     :     :     :     :     :     :     :     :     :     :     :     :           +- FileScan parquet [s_store_sk#664,s_store_name#669,s_zip#689] Batched: true, DataFilters: [isnotnull(s_store_sk#664), isnotnull(s_store_name#669), isnotnull(s_zip#689)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/store], PartitionFilters: [], PushedFilters: [IsNotNull(s_store_sk), IsNotNull(s_store_name), IsNotNull(s_zip)], ReadSchema: struct<s_store_sk:int,s_store_name:string,s_zip:string>
      :           :     :     :     :     :     :     :     :     :     :     :     :     +- Project [c_customer_sk#412, c_current_cdemo_sk#414, c_current_hdemo_sk#415, c_current_addr_sk#416, c_first_shipto_date_sk#417, c_first_sales_date_sk#418]
      :           :     :     :     :     :     :     :     :     :     :     :     :        +- Filter (((((isnotnull(c_customer_sk#412) AND isnotnull(c_first_sales_date_sk#418)) AND isnotnull(c_first_shipto_date_sk#417)) AND isnotnull(c_current_cdemo_sk#414)) AND isnotnull(c_current_hdemo_sk#415)) AND isnotnull(c_current_addr_sk#416))
      :           :     :     :     :     :     :     :     :     :     :     :     :           +- FileScan parquet [c_customer_sk#412,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418] Batched: true, DataFilters: [isnotnull(c_customer_sk#412), isnotnull(c_first_sales_date_sk#418), isnotnull(c_first_shipto_dat..., Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/customer], PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk), IsNotNull(c_first_sales_date_sk), IsNotNull(c_first_shipto_date_sk), I..., ReadSchema: struct<c_customer_sk:int,c_current_cdemo_sk:int,c_current_hdemo_sk:int,c_current_addr_sk:int,c_fi...
      :           :     :     :     :     :     :     :     :     :     :     :     +- Project [d_date_sk#1315, d_year#1321]
      :           :     :     :     :     :     :     :     :     :     :     :        +- Filter isnotnull(d_date_sk#1315)
      :           :     :     :     :     :     :     :     :     :     :     :           +- FileScan parquet [d_date_sk#1315,d_year#1321] Batched: true, DataFilters: [isnotnull(d_date_sk#1315)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
      :           :     :     :     :     :     :     :     :     :     :     +- Project [d_date_sk#1343, d_year#1349]
      :           :     :     :     :     :     :     :     :     :     :        +- Filter isnotnull(d_date_sk#1343)
      :           :     :     :     :     :     :     :     :     :     :           +- FileScan parquet [d_date_sk#1343,d_year#1349] Batched: true, DataFilters: [isnotnull(d_date_sk#1343)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
      :           :     :     :     :     :     :     :     :     :     +- Project [cd_demo_sk#474, cd_marital_status#476]
      :           :     :     :     :     :     :     :     :     :        +- Filter (isnotnull(cd_demo_sk#474) AND isnotnull(cd_marital_status#476))
      :           :     :     :     :     :     :     :     :     :           +- FileScan parquet [cd_demo_sk#474,cd_marital_status#476] Batched: true, DataFilters: [isnotnull(cd_demo_sk#474), isnotnull(cd_marital_status#476)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/customer_demographics], PartitionFilters: [], PushedFilters: [IsNotNull(cd_demo_sk), IsNotNull(cd_marital_status)], ReadSchema: struct<cd_demo_sk:int,cd_marital_status:string>
      :           :     :     :     :     :     :     :     :     +- Project [cd_demo_sk#1371, cd_marital_status#1373]
      :           :     :     :     :     :     :     :     :        +- Filter (isnotnull(cd_demo_sk#1371) AND isnotnull(cd_marital_status#1373))
      :           :     :     :     :     :     :     :     :           +- FileScan parquet [cd_demo_sk#1371,cd_marital_status#1373] Batched: true, DataFilters: [isnotnull(cd_demo_sk#1371), isnotnull(cd_marital_status#1373)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/customer_demographics], PartitionFilters: [], PushedFilters: [IsNotNull(cd_demo_sk), IsNotNull(cd_marital_status)], ReadSchema: struct<cd_demo_sk:int,cd_marital_status:string>
      :           :     :     :     :     :     :     :     +- Project [p_promo_sk#608]
      :           :     :     :     :     :     :     :        +- Filter isnotnull(p_promo_sk#608)
      :           :     :     :     :     :     :     :           +- FileScan parquet [p_promo_sk#608] Batched: true, DataFilters: [isnotnull(p_promo_sk#608)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/promotion], PartitionFilters: [], PushedFilters: [IsNotNull(p_promo_sk)], ReadSchema: struct<p_promo_sk:int>
      :           :     :     :     :     :     :     +- Project [hd_demo_sk#548, hd_income_band_sk#549]
      :           :     :     :     :     :     :        +- Filter (isnotnull(hd_demo_sk#548) AND isnotnull(hd_income_band_sk#549))
      :           :     :     :     :     :     :           +- FileScan parquet [hd_demo_sk#548,hd_income_band_sk#549] Batched: true, DataFilters: [isnotnull(hd_demo_sk#548), isnotnull(hd_income_band_sk#549)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/household_demographics], PartitionFilters: [], PushedFilters: [IsNotNull(hd_demo_sk), IsNotNull(hd_income_band_sk)], ReadSchema: struct<hd_demo_sk:int,hd_income_band_sk:int>
      :           :     :     :     :     :     +- Project [hd_demo_sk#1380, hd_income_band_sk#1381]
      :           :     :     :     :     :        +- Filter (isnotnull(hd_demo_sk#1380) AND isnotnull(hd_income_band_sk#1381))
      :           :     :     :     :     :           +- FileScan parquet [hd_demo_sk#1380,hd_income_band_sk#1381] Batched: true, DataFilters: [isnotnull(hd_demo_sk#1380), isnotnull(hd_income_band_sk#1381)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/household_demographics], PartitionFilters: [], PushedFilters: [IsNotNull(hd_demo_sk), IsNotNull(hd_income_band_sk)], ReadSchema: struct<hd_demo_sk:int,hd_income_band_sk:int>
      :           :     :     :     :     +- Project [ca_address_sk#448, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457]
      :           :     :     :     :        +- Filter isnotnull(ca_address_sk#448)
      :           :     :     :     :           +- FileScan parquet [ca_address_sk#448,ca_street_number#450,ca_street_name#451,ca_city#454,ca_zip#457] Batched: true, DataFilters: [isnotnull(ca_address_sk#448)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/customer_address], PartitionFilters: [], PushedFilters: [IsNotNull(ca_address_sk)], ReadSchema: struct<ca_address_sk:int,ca_street_number:string,ca_street_name:string,ca_city:string,ca_zip:string>
      :           :     :     :     +- Project [ca_address_sk#1385, ca_street_number#1387, ca_street_name#1388, ca_city#1391, ca_zip#1394]
      :           :     :     :        +- Filter isnotnull(ca_address_sk#1385)
      :           :     :     :           +- FileScan parquet [ca_address_sk#1385,ca_street_number#1387,ca_street_name#1388,ca_city#1391,ca_zip#1394] Batched: true, DataFilters: [isnotnull(ca_address_sk#1385)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/customer_address], PartitionFilters: [], PushedFilters: [IsNotNull(ca_address_sk)], ReadSchema: struct<ca_address_sk:int,ca_street_number:string,ca_street_name:string,ca_city:string,ca_zip:string>
      :           :     :     +- Project [ib_income_band_sk#558]
      :           :     :        +- Filter isnotnull(ib_income_band_sk#558)
      :           :     :           +- FileScan parquet [ib_income_band_sk#558] Batched: true, DataFilters: [isnotnull(ib_income_band_sk#558)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/income_band], PartitionFilters: [], PushedFilters: [IsNotNull(ib_income_band_sk)], ReadSchema: struct<ib_income_band_sk:int>
      :           :     +- Project [ib_income_band_sk#1398]
      :           :        +- Filter isnotnull(ib_income_band_sk#1398)
      :           :           +- FileScan parquet [ib_income_band_sk#1398] Batched: true, DataFilters: [isnotnull(ib_income_band_sk#1398)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/income_band], PartitionFilters: [], PushedFilters: [IsNotNull(ib_income_band_sk)], ReadSchema: struct<ib_income_band_sk:int>
      :           +- Project [i_item_sk#564, i_product_name#585]
      :              +- Filter ((((((isnotnull(i_current_price#569) AND i_color#581 IN (purple,burlywood,indian,spring,floral,medium)) AND (i_current_price#569 >= 64.00)) AND (i_current_price#569 <= 74.00)) AND (i_current_price#569 >= 65.00)) AND (i_current_price#569 <= 79.00)) AND isnotnull(i_item_sk#564))
      :                 +- FileScan parquet [i_item_sk#564,i_current_price#569,i_color#581,i_product_name#585] Batched: true, DataFilters: [isnotnull(i_current_price#569), i_color#581 IN (purple,burlywood,indian,spring,floral,medium), (..., Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/item], PartitionFilters: [], PushedFilters: [IsNotNull(i_current_price), In(i_color, [purple,burlywood,indian,spring,floral,medium]), Greater..., ReadSchema: struct<i_item_sk:int,i_current_price:decimal(7,2),i_color:string,i_product_name:string>
      +- HashAggregate(keys=[i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#1473, ca_street_name#1474, ca_city#1477, ca_zip#1480, d_year#498, d_year#1407, d_year#1435], functions=[count(1), sum(UnscaledValue(ss_wholesale_cost#140)), sum(UnscaledValue(ss_list_price#141)), sum(UnscaledValue(ss_coupon_amt#148))], output=[item_sk#1500, store_name#1501, store_zip#1502, syear#1511, cnt#1514L, s1#1515, s2#1516, s3#1517])
         +- HashAggregate(keys=[i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#1473, ca_street_name#1474, ca_city#1477, ca_zip#1480, d_year#498, d_year#1407, d_year#1435], functions=[partial_count(1), partial_sum(UnscaledValue(ss_wholesale_cost#140)), partial_sum(UnscaledValue(ss_list_price#141)), partial_sum(UnscaledValue(ss_coupon_amt#148))], output=[i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#1473, ca_street_name#1474, ca_city#1477, ca_zip#1480, d_year#498, d_year#1407, d_year#1435, count#1563L, sum#1564L, sum#1565L, sum#1566L])
            +- Project [ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, d_year#1407, d_year#1435, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#1473, ca_street_name#1474, ca_city#1477, ca_zip#1480, i_item_sk#564, i_product_name#585]
               +- BroadcastHashJoin [ss_item_sk#131], [i_item_sk#564], Inner, BuildRight, false
                  :- Project [ss_item_sk#131, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, d_year#1407, d_year#1435, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#1473, ca_street_name#1474, ca_city#1477, ca_zip#1480]
                  :  +- BroadcastHashJoin [hd_income_band_sk#1467], [ib_income_band_sk#1484], Inner, BuildRight, false
                  :     :- Project [ss_item_sk#131, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, d_year#1407, d_year#1435, hd_income_band_sk#1467, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#1473, ca_street_name#1474, ca_city#1477, ca_zip#1480]
                  :     :  +- BroadcastHashJoin [hd_income_band_sk#549], [ib_income_band_sk#558], Inner, BuildRight, false
                  :     :     :- Project [ss_item_sk#131, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, d_year#1407, d_year#1435, hd_income_band_sk#549, hd_income_band_sk#1467, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#1473, ca_street_name#1474, ca_city#1477, ca_zip#1480]
                  :     :     :  +- BroadcastHashJoin [c_current_addr_sk#416], [ca_address_sk#1471], Inner, BuildRight, false
                  :     :     :     :- Project [ss_item_sk#131, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_addr_sk#416, d_year#1407, d_year#1435, hd_income_band_sk#549, hd_income_band_sk#1467, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457]
                  :     :     :     :  +- BroadcastHashJoin [ss_addr_sk#135], [ca_address_sk#448], Inner, BuildRight, false
                  :     :     :     :     :- Project [ss_item_sk#131, ss_addr_sk#135, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_addr_sk#416, d_year#1407, d_year#1435, hd_income_band_sk#549, hd_income_band_sk#1467]
                  :     :     :     :     :  +- BroadcastHashJoin [c_current_hdemo_sk#415], [hd_demo_sk#1466], Inner, BuildRight, false
                  :     :     :     :     :     :- Project [ss_item_sk#131, ss_addr_sk#135, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_hdemo_sk#415, c_current_addr_sk#416, d_year#1407, d_year#1435, hd_income_band_sk#549]
                  :     :     :     :     :     :  +- BroadcastHashJoin [ss_hdemo_sk#134], [hd_demo_sk#548], Inner, BuildRight, false
                  :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_hdemo_sk#134, ss_addr_sk#135, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_hdemo_sk#415, c_current_addr_sk#416, d_year#1407, d_year#1435]
                  :     :     :     :     :     :     :  +- BroadcastHashJoin [ss_promo_sk#137], [p_promo_sk#608], Inner, BuildRight, false
                  :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_hdemo_sk#134, ss_addr_sk#135, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_hdemo_sk#415, c_current_addr_sk#416, d_year#1407, d_year#1435]
                  :     :     :     :     :     :     :     :  +- BroadcastHashJoin [c_current_cdemo_sk#414], [cd_demo_sk#1457], Inner, BuildRight, NOT (cd_marital_status#476 = cd_marital_status#1459), false
                  :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_hdemo_sk#134, ss_addr_sk#135, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_cdemo_sk#414, c_current_hdemo_sk#415, c_current_addr_sk#416, d_year#1407, d_year#1435, cd_marital_status#476]
                  :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [ss_cdemo_sk#133], [cd_demo_sk#474], Inner, BuildRight, false
                  :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_cdemo_sk#414, c_current_hdemo_sk#415, c_current_addr_sk#416, d_year#1407, d_year#1435]
                  :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [c_first_shipto_date_sk#417], [d_date_sk#1429], Inner, BuildRight, false
                  :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_cdemo_sk#414, c_current_hdemo_sk#415, c_current_addr_sk#416, c_first_shipto_date_sk#417, d_year#1407]
                  :     :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [c_first_sales_date_sk#418], [d_date_sk#1401], Inner, BuildRight, false
                  :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_cdemo_sk#414, c_current_hdemo_sk#415, c_current_addr_sk#416, c_first_shipto_date_sk#417, c_first_sales_date_sk#418]
                  :     :     :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [ss_customer_sk#132], [c_customer_sk#412], Inner, BuildRight, false
                  :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_customer_sk#132, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689]
                  :     :     :     :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [ss_store_sk#136], [s_store_sk#664], Inner, BuildRight, false
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_customer_sk#132, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_store_sk#136, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498]
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [ss_sold_date_sk#152], [d_date_sk#492], Inner, BuildRight, false
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_customer_sk#132, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_store_sk#136, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, ss_sold_date_sk#152]
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- SortMergeJoin [ss_item_sk#131], [cs_item_sk#14], Inner
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_customer_sk#132, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_store_sk#136, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, ss_sold_date_sk#152]
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- SortMergeJoin [ss_item_sk#131, ss_ticket_number#138L], [sr_item_sk#177, sr_ticket_number#184L], Inner
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_customer_sk#132, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_store_sk#136, ss_promo_sk#137, ss_ticket_number#138L, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, ss_sold_date_sk#152]
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- Filter (((((((isnotnull(ss_item_sk#131) AND isnotnull(ss_ticket_number#138L)) AND isnotnull(ss_store_sk#136)) AND isnotnull(ss_customer_sk#132)) AND isnotnull(ss_cdemo_sk#133)) AND isnotnull(ss_promo_sk#137)) AND isnotnull(ss_hdemo_sk#134)) AND isnotnull(ss_addr_sk#135))
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- FileScan parquet [ss_item_sk#131,ss_customer_sk#132,ss_cdemo_sk#133,ss_hdemo_sk#134,ss_addr_sk#135,ss_store_sk#136,ss_promo_sk#137,ss_ticket_number#138L,ss_wholesale_cost#140,ss_list_price#141,ss_coupon_amt#148,ss_sold_date_sk#152] Batched: true, DataFilters: [isnotnull(ss_item_sk#131), isnotnull(ss_ticket_number#138L), isnotnull(ss_store_sk#136), isnotnu..., Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/store_sales], PartitionFilters: [isnotnull(ss_sold_date_sk#152), dynamicpruning#1544 [ss_sold_date_sk#152]], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_ticket_number), IsNotNull(ss_store_sk), IsNotNull(ss_custome..., ReadSchema: struct<ss_item_sk:int,ss_customer_sk:int,ss_cdemo_sk:int,ss_hdemo_sk:int,ss_addr_sk:int,ss_store_...
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- Project [d_date_sk#492, d_year#498]
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :              +- Filter ((isnotnull(d_year#498) AND (d_year#498 = 2000)) AND isnotnull(d_date_sk#492))
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                 +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [sr_item_sk#177, sr_ticket_number#184L]
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter (isnotnull(sr_item_sk#177) AND isnotnull(sr_ticket_number#184L))
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- FileScan parquet [sr_item_sk#177,sr_ticket_number#184L,sr_returned_date_sk#195] Batched: true, DataFilters: [isnotnull(sr_item_sk#177), isnotnull(sr_ticket_number#184L)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/store_returns], PartitionFilters: [], PushedFilters: [IsNotNull(sr_item_sk), IsNotNull(sr_ticket_number)], ReadSchema: struct<sr_item_sk:int,sr_ticket_number:bigint>
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [cs_item_sk#14]
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter (isnotnull(sum(cs_ext_list_price#24)#1313) AND (cast(sum(cs_ext_list_price#24)#1313 as decimal(21,2)) > CheckOverflow((2.00 * promote_precision(sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#90 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#91 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#92 as decimal(9,2)))), DecimalType(9,2), true))#1314)), DecimalType(21,2), true)))
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- HashAggregate(keys=[cs_item_sk#14], functions=[sum(UnscaledValue(cs_ext_list_price#24)), sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#90 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#91 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#92 as decimal(9,2)))), DecimalType(9,2), true))], output=[cs_item_sk#14, sum(cs_ext_list_price#24)#1313, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#90 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#91 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#92 as decimal(9,2)))), DecimalType(9,2), true))#1314])
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :              +- HashAggregate(keys=[cs_item_sk#14], functions=[partial_sum(UnscaledValue(cs_ext_list_price#24)), partial_sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#90 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#91 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#92 as decimal(9,2)))), DecimalType(9,2), true))], output=[cs_item_sk#14, sum#1570L, sum#1571, isEmpty#1572])
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                 +- Project [cs_item_sk#14, cs_ext_list_price#24, cr_refunded_cash#90, cr_reversed_charge#91, cr_store_credit#92]
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                    +- SortMergeJoin [cs_item_sk#14, cs_order_number#16L], [cr_item_sk#69, cr_order_number#83L], Inner
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                       :- Project [cs_item_sk#14, cs_order_number#16L, cs_ext_list_price#24]
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                       :  +- Filter (isnotnull(cs_item_sk#14) AND isnotnull(cs_order_number#16L))
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                       :     +- FileScan parquet [cs_item_sk#14,cs_order_number#16L,cs_ext_list_price#24,cs_sold_date_sk#33] Batched: true, DataFilters: [isnotnull(cs_item_sk#14), isnotnull(cs_order_number#16L)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/catalog_sales], PartitionFilters: [], PushedFilters: [IsNotNull(cs_item_sk), IsNotNull(cs_order_number)], ReadSchema: struct<cs_item_sk:int,cs_order_number:bigint,cs_ext_list_price:decimal(7,2)>
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                       +- Project [cr_item_sk#69, cr_order_number#83L, cr_refunded_cash#90, cr_reversed_charge#91, cr_store_credit#92]
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                          +- Filter (isnotnull(cr_item_sk#69) AND isnotnull(cr_order_number#83L))
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                             +- FileScan parquet [cr_item_sk#69,cr_order_number#83L,cr_refunded_cash#90,cr_reversed_charge#91,cr_store_credit#92,cr_returned_date_sk#94] Batched: true, DataFilters: [isnotnull(cr_item_sk#69), isnotnull(cr_order_number#83L)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/catalog_returns], PartitionFilters: [], PushedFilters: [IsNotNull(cr_item_sk), IsNotNull(cr_order_number)], ReadSchema: struct<cr_item_sk:int,cr_order_number:bigint,cr_refunded_cash:decimal(7,2),cr_reversed_charge:dec...
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [d_date_sk#492, d_year#498]
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter ((isnotnull(d_year#498) AND (d_year#498 = 2000)) AND isnotnull(d_date_sk#492))
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- FileScan parquet [d_date_sk#492,d_year#498] Batched: true, DataFilters: [isnotnull(d_year#498), (d_year#498 = 2000), isnotnull(d_date_sk#492)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), EqualTo(d_year,2000), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
                  :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [s_store_sk#664, s_store_name#669, s_zip#689]
                  :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter ((isnotnull(s_store_sk#664) AND isnotnull(s_store_name#669)) AND isnotnull(s_zip#689))
                  :     :     :     :     :     :     :     :     :     :     :     :     :           +- FileScan parquet [s_store_sk#664,s_store_name#669,s_zip#689] Batched: true, DataFilters: [isnotnull(s_store_sk#664), isnotnull(s_store_name#669), isnotnull(s_zip#689)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/store], PartitionFilters: [], PushedFilters: [IsNotNull(s_store_sk), IsNotNull(s_store_name), IsNotNull(s_zip)], ReadSchema: struct<s_store_sk:int,s_store_name:string,s_zip:string>
                  :     :     :     :     :     :     :     :     :     :     :     :     +- Project [c_customer_sk#412, c_current_cdemo_sk#414, c_current_hdemo_sk#415, c_current_addr_sk#416, c_first_shipto_date_sk#417, c_first_sales_date_sk#418]
                  :     :     :     :     :     :     :     :     :     :     :     :        +- Filter (((((isnotnull(c_customer_sk#412) AND isnotnull(c_first_sales_date_sk#418)) AND isnotnull(c_first_shipto_date_sk#417)) AND isnotnull(c_current_cdemo_sk#414)) AND isnotnull(c_current_hdemo_sk#415)) AND isnotnull(c_current_addr_sk#416))
                  :     :     :     :     :     :     :     :     :     :     :     :           +- FileScan parquet [c_customer_sk#412,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418] Batched: true, DataFilters: [isnotnull(c_customer_sk#412), isnotnull(c_first_sales_date_sk#418), isnotnull(c_first_shipto_dat..., Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/customer], PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk), IsNotNull(c_first_sales_date_sk), IsNotNull(c_first_shipto_date_sk), I..., ReadSchema: struct<c_customer_sk:int,c_current_cdemo_sk:int,c_current_hdemo_sk:int,c_current_addr_sk:int,c_fi...
                  :     :     :     :     :     :     :     :     :     :     :     +- Project [d_date_sk#1401, d_year#1407]
                  :     :     :     :     :     :     :     :     :     :     :        +- Filter isnotnull(d_date_sk#1401)
                  :     :     :     :     :     :     :     :     :     :     :           +- FileScan parquet [d_date_sk#1401,d_year#1407] Batched: true, DataFilters: [isnotnull(d_date_sk#1401)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
                  :     :     :     :     :     :     :     :     :     :     +- Project [d_date_sk#1429, d_year#1435]
                  :     :     :     :     :     :     :     :     :     :        +- Filter isnotnull(d_date_sk#1429)
                  :     :     :     :     :     :     :     :     :     :           +- FileScan parquet [d_date_sk#1429,d_year#1435] Batched: true, DataFilters: [isnotnull(d_date_sk#1429)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
                  :     :     :     :     :     :     :     :     :     +- Project [cd_demo_sk#474, cd_marital_status#476]
                  :     :     :     :     :     :     :     :     :        +- Filter (isnotnull(cd_demo_sk#474) AND isnotnull(cd_marital_status#476))
                  :     :     :     :     :     :     :     :     :           +- FileScan parquet [cd_demo_sk#474,cd_marital_status#476] Batched: true, DataFilters: [isnotnull(cd_demo_sk#474), isnotnull(cd_marital_status#476)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/customer_demographics], PartitionFilters: [], PushedFilters: [IsNotNull(cd_demo_sk), IsNotNull(cd_marital_status)], ReadSchema: struct<cd_demo_sk:int,cd_marital_status:string>
                  :     :     :     :     :     :     :     :     +- Project [cd_demo_sk#1457, cd_marital_status#1459]
                  :     :     :     :     :     :     :     :        +- Filter (isnotnull(cd_demo_sk#1457) AND isnotnull(cd_marital_status#1459))
                  :     :     :     :     :     :     :     :           +- FileScan parquet [cd_demo_sk#1457,cd_marital_status#1459] Batched: true, DataFilters: [isnotnull(cd_demo_sk#1457), isnotnull(cd_marital_status#1459)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/customer_demographics], PartitionFilters: [], PushedFilters: [IsNotNull(cd_demo_sk), IsNotNull(cd_marital_status)], ReadSchema: struct<cd_demo_sk:int,cd_marital_status:string>
                  :     :     :     :     :     :     :     +- Project [p_promo_sk#608]
                  :     :     :     :     :     :     :        +- Filter isnotnull(p_promo_sk#608)
                  :     :     :     :     :     :     :           +- FileScan parquet [p_promo_sk#608] Batched: true, DataFilters: [isnotnull(p_promo_sk#608)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/promotion], PartitionFilters: [], PushedFilters: [IsNotNull(p_promo_sk)], ReadSchema: struct<p_promo_sk:int>
                  :     :     :     :     :     :     +- Project [hd_demo_sk#548, hd_income_band_sk#549]
                  :     :     :     :     :     :        +- Filter (isnotnull(hd_demo_sk#548) AND isnotnull(hd_income_band_sk#549))
                  :     :     :     :     :     :           +- FileScan parquet [hd_demo_sk#548,hd_income_band_sk#549] Batched: true, DataFilters: [isnotnull(hd_demo_sk#548), isnotnull(hd_income_band_sk#549)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/household_demographics], PartitionFilters: [], PushedFilters: [IsNotNull(hd_demo_sk), IsNotNull(hd_income_band_sk)], ReadSchema: struct<hd_demo_sk:int,hd_income_band_sk:int>
                  :     :     :     :     :     +- Project [hd_demo_sk#1466, hd_income_band_sk#1467]
                  :     :     :     :     :        +- Filter (isnotnull(hd_demo_sk#1466) AND isnotnull(hd_income_band_sk#1467))
                  :     :     :     :     :           +- FileScan parquet [hd_demo_sk#1466,hd_income_band_sk#1467] Batched: true, DataFilters: [isnotnull(hd_demo_sk#1466), isnotnull(hd_income_band_sk#1467)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/household_demographics], PartitionFilters: [], PushedFilters: [IsNotNull(hd_demo_sk), IsNotNull(hd_income_band_sk)], ReadSchema: struct<hd_demo_sk:int,hd_income_band_sk:int>
                  :     :     :     :     +- Project [ca_address_sk#448, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457]
                  :     :     :     :        +- Filter isnotnull(ca_address_sk#448)
                  :     :     :     :           +- FileScan parquet [ca_address_sk#448,ca_street_number#450,ca_street_name#451,ca_city#454,ca_zip#457] Batched: true, DataFilters: [isnotnull(ca_address_sk#448)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/customer_address], PartitionFilters: [], PushedFilters: [IsNotNull(ca_address_sk)], ReadSchema: struct<ca_address_sk:int,ca_street_number:string,ca_street_name:string,ca_city:string,ca_zip:string>
                  :     :     :     +- Project [ca_address_sk#1471, ca_street_number#1473, ca_street_name#1474, ca_city#1477, ca_zip#1480]
                  :     :     :        +- Filter isnotnull(ca_address_sk#1471)
                  :     :     :           +- FileScan parquet [ca_address_sk#1471,ca_street_number#1473,ca_street_name#1474,ca_city#1477,ca_zip#1480] Batched: true, DataFilters: [isnotnull(ca_address_sk#1471)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/customer_address], PartitionFilters: [], PushedFilters: [IsNotNull(ca_address_sk)], ReadSchema: struct<ca_address_sk:int,ca_street_number:string,ca_street_name:string,ca_city:string,ca_zip:string>
                  :     :     +- Project [ib_income_band_sk#558]
                  :     :        +- Filter isnotnull(ib_income_band_sk#558)
                  :     :           +- FileScan parquet [ib_income_band_sk#558] Batched: true, DataFilters: [isnotnull(ib_income_band_sk#558)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/income_band], PartitionFilters: [], PushedFilters: [IsNotNull(ib_income_band_sk)], ReadSchema: struct<ib_income_band_sk:int>
                  :     +- Project [ib_income_band_sk#1484]
                  :        +- Filter isnotnull(ib_income_band_sk#1484)
                  :           +- FileScan parquet [ib_income_band_sk#1484] Batched: true, DataFilters: [isnotnull(ib_income_band_sk#1484)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/income_band], PartitionFilters: [], PushedFilters: [IsNotNull(ib_income_band_sk)], ReadSchema: struct<ib_income_band_sk:int>
                  +- Project [i_item_sk#564, i_product_name#585]
                     +- Filter ((((((isnotnull(i_current_price#569) AND i_color#581 IN (purple,burlywood,indian,spring,floral,medium)) AND (i_current_price#569 >= 64.00)) AND (i_current_price#569 <= 74.00)) AND (i_current_price#569 >= 65.00)) AND (i_current_price#569 <= 79.00)) AND isnotnull(i_item_sk#564))
                        +- FileScan parquet [i_item_sk#564,i_current_price#569,i_color#581,i_product_name#585] Batched: true, DataFilters: [isnotnull(i_current_price#569), i_color#581 IN (purple,burlywood,indian,spring,floral,medium), (..., Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/item], PartitionFilters: [], PushedFilters: [IsNotNull(i_current_price), In(i_color, [purple,burlywood,indian,spring,floral,medium]), Greater..., ReadSchema: struct<i_item_sk:int,i_current_price:decimal(7,2),i_color:string,i_product_name:string>
.
2022-09-08 15:12:55,985 INFO perf.Query: 
== Query: q64-v2.4 ==
Sort [product_name#1583 ASC NULLS FIRST, store_name#1585 ASC NULLS FIRST, cnt#1817L ASC NULLS FIRST], true
+- Project [product_name#1583, store_name#1585, store_zip#1586, b_street_number#1587, b_streen_name#1588, b_city#1589, b_zip#1590, c_street_number#1591, c_street_name#1592, c_city#1593, c_zip#1594, syear#1595, cnt#1598L, s1#1599, s2#1600, s3#1601, s1#1818, s2#1819, s3#1820, syear#1814, cnt#1817L]
   +- Filter ((((item_sk#1584 = item_sk#1803) AND (syear#1595 = 1999)) AND (syear#1814 = (1999 + 1))) AND (((cnt#1817L <= cnt#1598L) AND (store_name#1585 = store_name#1804)) AND (store_zip#1586 = store_zip#1805)))
      +- Join Inner
         :- SubqueryAlias cs1
         :  +- SubqueryAlias cross_sales
         :     +- Aggregate [i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#1690, ca_street_name#1691, ca_city#1694, ca_zip#1697, d_year#498, d_year#1624, d_year#1652], [i_product_name#585 AS product_name#1583, i_item_sk#564 AS item_sk#1584, s_store_name#669 AS store_name#1585, s_zip#689 AS store_zip#1586, ca_street_number#450 AS b_street_number#1587, ca_street_name#451 AS b_streen_name#1588, ca_city#454 AS b_city#1589, ca_zip#457 AS b_zip#1590, ca_street_number#1690 AS c_street_number#1591, ca_street_name#1691 AS c_street_name#1592, ca_city#1694 AS c_city#1593, ca_zip#1697 AS c_zip#1594, d_year#498 AS syear#1595, d_year#1624 AS fsyear#1596, d_year#1652 AS s2year#1597, count(1) AS cnt#1598L, sum(ss_wholesale_cost#140) AS s1#1599, sum(ss_list_price#141) AS s2#1600, sum(ss_coupon_amt#148) AS s3#1601]
         :        +- Filter ((((((ss_store_sk#136 = s_store_sk#664) AND (ss_sold_date_sk#152 = d_date_sk#492)) AND (ss_customer_sk#132 = c_customer_sk#412)) AND (((ss_cdemo_sk#133 = cd_demo_sk#474) AND (ss_hdemo_sk#134 = hd_demo_sk#548)) AND (ss_addr_sk#135 = ca_address_sk#448))) AND ((((ss_item_sk#131 = i_item_sk#564) AND (ss_item_sk#131 = sr_item_sk#177)) AND (ss_ticket_number#138L = sr_ticket_number#184L)) AND ((ss_item_sk#131 = cs_item_sk#14) AND (c_current_cdemo_sk#414 = cd_demo_sk#1674)))) AND (((((c_current_hdemo_sk#415 = hd_demo_sk#1683) AND (c_current_addr_sk#416 = ca_address_sk#1688)) AND (c_first_sales_date_sk#418 = d_date_sk#1618)) AND (((c_first_shipto_date_sk#417 = d_date_sk#1646) AND (ss_promo_sk#137 = p_promo_sk#608)) AND (hd_income_band_sk#549 = ib_income_band_sk#558))) AND ((((hd_income_band_sk#1684 = ib_income_band_sk#1701) AND NOT (cd_marital_status#476 = cd_marital_status#1676)) AND i_color#581 IN (purple,burlywood,indian,spring,floral,medium)) AND (((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(64 as decimal(2,0)) as decimal(7,2))) AND (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 10) as decimal(10,0)) as decimal(12,2)))) AND ((cast(i_current_price#569 as decimal(12,2)) >= cast(cast((64 + 1) as decimal(10,0)) as decimal(12,2))) AND (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 15) as decimal(10,0)) as decimal(12,2))))))))
         :           +- Join Inner
         :              :- Join Inner
         :              :  :- Join Inner
         :              :  :  :- Join Inner
         :              :  :  :  :- Join Inner
         :              :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- SubqueryAlias store_sales
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- Relation[ss_sold_time_sk#130,ss_item_sk#131,ss_customer_sk#132,ss_cdemo_sk#133,ss_hdemo_sk#134,ss_addr_sk#135,ss_store_sk#136,ss_promo_sk#137,ss_ticket_number#138L,ss_quantity#139,ss_wholesale_cost#140,ss_list_price#141,ss_sales_price#142,ss_ext_discount_amt#143,ss_ext_sales_price#144,ss_ext_wholesale_cost#145,ss_ext_list_price#146,ss_ext_tax#147,ss_coupon_amt#148,ss_net_paid#149,ss_net_paid_inc_tax#150,ss_net_profit#151,ss_sold_date_sk#152] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias store_returns
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Relation[sr_return_time_sk#176,sr_item_sk#177,sr_customer_sk#178,sr_cdemo_sk#179,sr_hdemo_sk#180,sr_addr_sk#181,sr_store_sk#182,sr_reason_sk#183,sr_ticket_number#184L,sr_return_quantity#185,sr_return_amt#186,sr_return_tax#187,sr_return_amt_inc_tax#188,sr_fee#189,sr_return_ship_cost#190,sr_refunded_cash#191,sr_reversed_charge#192,sr_store_credit#193,sr_net_loss#194,sr_returned_date_sk#195] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias cs_ui
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Project [cs_item_sk#14, sale#1581, refund#1582]
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Filter (cast(sum(cs_ext_list_price#24)#1611 as decimal(21,2)) > cast(CheckOverflow((promote_precision(cast(cast(2 as decimal(1,0)) as decimal(19,2))) * promote_precision(cast(sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#90 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#91 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#92 as decimal(9,2)))), DecimalType(9,2), true))#1612 as decimal(19,2)))), DecimalType(21,2), true) as decimal(21,2)))
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :           +- Aggregate [cs_item_sk#14], [cs_item_sk#14, sum(cs_ext_list_price#24) AS sale#1581, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#90 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#91 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#92 as decimal(9,2)))), DecimalType(9,2), true)) AS refund#1582, sum(cs_ext_list_price#24) AS sum(cs_ext_list_price#24)#1611, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#90 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#91 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#92 as decimal(9,2)))), DecimalType(9,2), true)) AS sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#90 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#91 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#92 as decimal(9,2)))), DecimalType(9,2), true))#1612]
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :              +- Filter ((cs_item_sk#14 = cr_item_sk#69) AND (cs_order_number#16L = cr_order_number#83L))
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                 +- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :- SubqueryAlias catalog_sales
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :  +- Relation[cs_sold_time_sk#0,cs_ship_date_sk#1,cs_bill_customer_sk#2,cs_bill_cdemo_sk#3,cs_bill_hdemo_sk#4,cs_bill_addr_sk#5,cs_ship_customer_sk#6,cs_ship_cdemo_sk#7,cs_ship_hdemo_sk#8,cs_ship_addr_sk#9,cs_call_center_sk#10,cs_catalog_page_sk#11,cs_ship_mode_sk#12,cs_warehouse_sk#13,cs_item_sk#14,cs_promo_sk#15,cs_order_number#16L,cs_quantity#17,cs_wholesale_cost#18,cs_list_price#19,cs_sales_price#20,cs_ext_discount_amt#21,cs_ext_sales_price#22,cs_ext_wholesale_cost#23,... 10 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    +- SubqueryAlias catalog_returns
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                       +- Relation[cr_returned_time_sk#68,cr_item_sk#69,cr_refunded_customer_sk#70,cr_refunded_cdemo_sk#71,cr_refunded_hdemo_sk#72,cr_refunded_addr_sk#73,cr_returning_customer_sk#74,cr_returning_cdemo_sk#75,cr_returning_hdemo_sk#76,cr_returning_addr_sk#77,cr_call_center_sk#78,cr_catalog_page_sk#79,cr_ship_mode_sk#80,cr_warehouse_sk#81,cr_reason_sk#82,cr_order_number#83L,cr_return_quantity#84,cr_return_amount#85,cr_return_tax#86,cr_return_amt_inc_tax#87,cr_fee#88,cr_return_ship_cost#89,cr_refunded_cash#90,cr_reversed_charge#91,... 3 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias d1
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias date_dim
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias d2
         :              :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias date_dim
         :              :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#1618,d_date_id#1619,d_date#1620,d_month_seq#1621,d_week_seq#1622,d_quarter_seq#1623,d_year#1624,d_dow#1625,d_moy#1626,d_dom#1627,d_qoy#1628,d_fy_year#1629,d_fy_quarter_seq#1630,d_fy_week_seq#1631,d_day_name#1632,d_quarter_name#1633,d_holiday#1634,d_weekend#1635,d_following_holiday#1636,d_first_dom#1637,d_last_dom#1638,d_same_day_ly#1639,d_same_day_lq#1640,d_current_day#1641,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias d3
         :              :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias date_dim
         :              :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#1646,d_date_id#1647,d_date#1648,d_month_seq#1649,d_week_seq#1650,d_quarter_seq#1651,d_year#1652,d_dow#1653,d_moy#1654,d_dom#1655,d_qoy#1656,d_fy_year#1657,d_fy_quarter_seq#1658,d_fy_week_seq#1659,d_day_name#1660,d_quarter_name#1661,d_holiday#1662,d_weekend#1663,d_following_holiday#1664,d_first_dom#1665,d_last_dom#1666,d_same_day_ly#1667,d_same_day_lq#1668,d_current_day#1669,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias store
         :              :  :  :  :  :  :  :  :  :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias customer
         :              :  :  :  :  :  :  :  :  :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
         :              :  :  :  :  :  :  :  :  :  +- SubqueryAlias cd1
         :              :  :  :  :  :  :  :  :  :     +- SubqueryAlias customer_demographics
         :              :  :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
         :              :  :  :  :  :  :  :  :  +- SubqueryAlias cd2
         :              :  :  :  :  :  :  :  :     +- SubqueryAlias customer_demographics
         :              :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#1674,cd_gender#1675,cd_marital_status#1676,cd_education_status#1677,cd_purchase_estimate#1678,cd_credit_rating#1679,cd_dep_count#1680,cd_dep_employed_count#1681,cd_dep_college_count#1682] parquet
         :              :  :  :  :  :  :  :  +- SubqueryAlias promotion
         :              :  :  :  :  :  :  :     +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet
         :              :  :  :  :  :  :  +- SubqueryAlias hd1
         :              :  :  :  :  :  :     +- SubqueryAlias household_demographics
         :              :  :  :  :  :  :        +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
         :              :  :  :  :  :  +- SubqueryAlias hd2
         :              :  :  :  :  :     +- SubqueryAlias household_demographics
         :              :  :  :  :  :        +- Relation[hd_demo_sk#1683,hd_income_band_sk#1684,hd_buy_potential#1685,hd_dep_count#1686,hd_vehicle_count#1687] parquet
         :              :  :  :  :  +- SubqueryAlias ad1
         :              :  :  :  :     +- SubqueryAlias customer_address
         :              :  :  :  :        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
         :              :  :  :  +- SubqueryAlias ad2
         :              :  :  :     +- SubqueryAlias customer_address
         :              :  :  :        +- Relation[ca_address_sk#1688,ca_address_id#1689,ca_street_number#1690,ca_street_name#1691,ca_street_type#1692,ca_suite_number#1693,ca_city#1694,ca_county#1695,ca_state#1696,ca_zip#1697,ca_country#1698,ca_gmt_offset#1699,ca_location_type#1700] parquet
         :              :  :  +- SubqueryAlias ib1
         :              :  :     +- SubqueryAlias income_band
         :              :  :        +- Relation[ib_income_band_sk#558,ib_lower_bound#559,ib_upper_bound#560] parquet
         :              :  +- SubqueryAlias ib2
         :              :     +- SubqueryAlias income_band
         :              :        +- Relation[ib_income_band_sk#1701,ib_lower_bound#1702,ib_upper_bound#1703] parquet
         :              +- SubqueryAlias item
         :                 +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
         +- SubqueryAlias cs2
            +- SubqueryAlias cross_sales
               +- Aggregate [i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#1776, ca_street_name#1777, ca_city#1780, ca_zip#1783, d_year#498, d_year#1710, d_year#1738], [i_product_name#585 AS product_name#1802, i_item_sk#564 AS item_sk#1803, s_store_name#669 AS store_name#1804, s_zip#689 AS store_zip#1805, ca_street_number#450 AS b_street_number#1806, ca_street_name#451 AS b_streen_name#1807, ca_city#454 AS b_city#1808, ca_zip#457 AS b_zip#1809, ca_street_number#1776 AS c_street_number#1810, ca_street_name#1777 AS c_street_name#1811, ca_city#1780 AS c_city#1812, ca_zip#1783 AS c_zip#1813, d_year#498 AS syear#1814, d_year#1710 AS fsyear#1815, d_year#1738 AS s2year#1816, count(1) AS cnt#1817L, sum(ss_wholesale_cost#140) AS s1#1818, sum(ss_list_price#141) AS s2#1819, sum(ss_coupon_amt#148) AS s3#1820]
                  +- Filter ((((((ss_store_sk#136 = s_store_sk#664) AND (ss_sold_date_sk#152 = d_date_sk#492)) AND (ss_customer_sk#132 = c_customer_sk#412)) AND (((ss_cdemo_sk#133 = cd_demo_sk#474) AND (ss_hdemo_sk#134 = hd_demo_sk#548)) AND (ss_addr_sk#135 = ca_address_sk#448))) AND ((((ss_item_sk#131 = i_item_sk#564) AND (ss_item_sk#131 = sr_item_sk#177)) AND (ss_ticket_number#138L = sr_ticket_number#184L)) AND ((ss_item_sk#131 = cs_item_sk#14) AND (c_current_cdemo_sk#414 = cd_demo_sk#1760)))) AND (((((c_current_hdemo_sk#415 = hd_demo_sk#1769) AND (c_current_addr_sk#416 = ca_address_sk#1774)) AND (c_first_sales_date_sk#418 = d_date_sk#1704)) AND (((c_first_shipto_date_sk#417 = d_date_sk#1732) AND (ss_promo_sk#137 = p_promo_sk#608)) AND (hd_income_band_sk#549 = ib_income_band_sk#558))) AND ((((hd_income_band_sk#1770 = ib_income_band_sk#1787) AND NOT (cd_marital_status#476 = cd_marital_status#1762)) AND i_color#581 IN (purple,burlywood,indian,spring,floral,medium)) AND (((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(64 as decimal(2,0)) as decimal(7,2))) AND (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 10) as decimal(10,0)) as decimal(12,2)))) AND ((cast(i_current_price#569 as decimal(12,2)) >= cast(cast((64 + 1) as decimal(10,0)) as decimal(12,2))) AND (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 15) as decimal(10,0)) as decimal(12,2))))))))
                     +- Join Inner
                        :- Join Inner
                        :  :- Join Inner
                        :  :  :- Join Inner
                        :  :  :  :- Join Inner
                        :  :  :  :  :- Join Inner
                        :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- SubqueryAlias store_sales
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- Relation[ss_sold_time_sk#130,ss_item_sk#131,ss_customer_sk#132,ss_cdemo_sk#133,ss_hdemo_sk#134,ss_addr_sk#135,ss_store_sk#136,ss_promo_sk#137,ss_ticket_number#138L,ss_quantity#139,ss_wholesale_cost#140,ss_list_price#141,ss_sales_price#142,ss_ext_discount_amt#143,ss_ext_sales_price#144,ss_ext_wholesale_cost#145,ss_ext_list_price#146,ss_ext_tax#147,ss_coupon_amt#148,ss_net_paid#149,ss_net_paid_inc_tax#150,ss_net_profit#151,ss_sold_date_sk#152] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias store_returns
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Relation[sr_return_time_sk#176,sr_item_sk#177,sr_customer_sk#178,sr_cdemo_sk#179,sr_hdemo_sk#180,sr_addr_sk#181,sr_store_sk#182,sr_reason_sk#183,sr_ticket_number#184L,sr_return_quantity#185,sr_return_amt#186,sr_return_tax#187,sr_return_amt_inc_tax#188,sr_fee#189,sr_return_ship_cost#190,sr_refunded_cash#191,sr_reversed_charge#192,sr_store_credit#193,sr_net_loss#194,sr_returned_date_sk#195] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias cs_ui
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Project [cs_item_sk#14, sale#1581, refund#1582]
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Filter (cast(sum(cs_ext_list_price#24)#1616 as decimal(21,2)) > cast(CheckOverflow((promote_precision(cast(cast(2 as decimal(1,0)) as decimal(19,2))) * promote_precision(cast(sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#90 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#91 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#92 as decimal(9,2)))), DecimalType(9,2), true))#1617 as decimal(19,2)))), DecimalType(21,2), true) as decimal(21,2)))
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :           +- Aggregate [cs_item_sk#14], [cs_item_sk#14, sum(cs_ext_list_price#24) AS sale#1581, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#90 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#91 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#92 as decimal(9,2)))), DecimalType(9,2), true)) AS refund#1582, sum(cs_ext_list_price#24) AS sum(cs_ext_list_price#24)#1616, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#90 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#91 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#92 as decimal(9,2)))), DecimalType(9,2), true)) AS sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#90 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#91 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#92 as decimal(9,2)))), DecimalType(9,2), true))#1617]
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :              +- Filter ((cs_item_sk#14 = cr_item_sk#69) AND (cs_order_number#16L = cr_order_number#83L))
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                 +- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :- SubqueryAlias catalog_sales
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :  +- Relation[cs_sold_time_sk#0,cs_ship_date_sk#1,cs_bill_customer_sk#2,cs_bill_cdemo_sk#3,cs_bill_hdemo_sk#4,cs_bill_addr_sk#5,cs_ship_customer_sk#6,cs_ship_cdemo_sk#7,cs_ship_hdemo_sk#8,cs_ship_addr_sk#9,cs_call_center_sk#10,cs_catalog_page_sk#11,cs_ship_mode_sk#12,cs_warehouse_sk#13,cs_item_sk#14,cs_promo_sk#15,cs_order_number#16L,cs_quantity#17,cs_wholesale_cost#18,cs_list_price#19,cs_sales_price#20,cs_ext_discount_amt#21,cs_ext_sales_price#22,cs_ext_wholesale_cost#23,... 10 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    +- SubqueryAlias catalog_returns
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                       +- Relation[cr_returned_time_sk#68,cr_item_sk#69,cr_refunded_customer_sk#70,cr_refunded_cdemo_sk#71,cr_refunded_hdemo_sk#72,cr_refunded_addr_sk#73,cr_returning_customer_sk#74,cr_returning_cdemo_sk#75,cr_returning_hdemo_sk#76,cr_returning_addr_sk#77,cr_call_center_sk#78,cr_catalog_page_sk#79,cr_ship_mode_sk#80,cr_warehouse_sk#81,cr_reason_sk#82,cr_order_number#83L,cr_return_quantity#84,cr_return_amount#85,cr_return_tax#86,cr_return_amt_inc_tax#87,cr_fee#88,cr_return_ship_cost#89,cr_refunded_cash#90,cr_reversed_charge#91,... 3 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias d1
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias date_dim
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias d2
                        :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias date_dim
                        :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#1704,d_date_id#1705,d_date#1706,d_month_seq#1707,d_week_seq#1708,d_quarter_seq#1709,d_year#1710,d_dow#1711,d_moy#1712,d_dom#1713,d_qoy#1714,d_fy_year#1715,d_fy_quarter_seq#1716,d_fy_week_seq#1717,d_day_name#1718,d_quarter_name#1719,d_holiday#1720,d_weekend#1721,d_following_holiday#1722,d_first_dom#1723,d_last_dom#1724,d_same_day_ly#1725,d_same_day_lq#1726,d_current_day#1727,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias d3
                        :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias date_dim
                        :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#1732,d_date_id#1733,d_date#1734,d_month_seq#1735,d_week_seq#1736,d_quarter_seq#1737,d_year#1738,d_dow#1739,d_moy#1740,d_dom#1741,d_qoy#1742,d_fy_year#1743,d_fy_quarter_seq#1744,d_fy_week_seq#1745,d_day_name#1746,d_quarter_name#1747,d_holiday#1748,d_weekend#1749,d_following_holiday#1750,d_first_dom#1751,d_last_dom#1752,d_same_day_ly#1753,d_same_day_lq#1754,d_current_day#1755,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias store
                        :  :  :  :  :  :  :  :  :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias customer
                        :  :  :  :  :  :  :  :  :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                        :  :  :  :  :  :  :  :  :  +- SubqueryAlias cd1
                        :  :  :  :  :  :  :  :  :     +- SubqueryAlias customer_demographics
                        :  :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
                        :  :  :  :  :  :  :  :  +- SubqueryAlias cd2
                        :  :  :  :  :  :  :  :     +- SubqueryAlias customer_demographics
                        :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#1760,cd_gender#1761,cd_marital_status#1762,cd_education_status#1763,cd_purchase_estimate#1764,cd_credit_rating#1765,cd_dep_count#1766,cd_dep_employed_count#1767,cd_dep_college_count#1768] parquet
                        :  :  :  :  :  :  :  +- SubqueryAlias promotion
                        :  :  :  :  :  :  :     +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet
                        :  :  :  :  :  :  +- SubqueryAlias hd1
                        :  :  :  :  :  :     +- SubqueryAlias household_demographics
                        :  :  :  :  :  :        +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
                        :  :  :  :  :  +- SubqueryAlias hd2
                        :  :  :  :  :     +- SubqueryAlias household_demographics
                        :  :  :  :  :        +- Relation[hd_demo_sk#1769,hd_income_band_sk#1770,hd_buy_potential#1771,hd_dep_count#1772,hd_vehicle_count#1773] parquet
                        :  :  :  :  +- SubqueryAlias ad1
                        :  :  :  :     +- SubqueryAlias customer_address
                        :  :  :  :        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                        :  :  :  +- SubqueryAlias ad2
                        :  :  :     +- SubqueryAlias customer_address
                        :  :  :        +- Relation[ca_address_sk#1774,ca_address_id#1775,ca_street_number#1776,ca_street_name#1777,ca_street_type#1778,ca_suite_number#1779,ca_city#1780,ca_county#1781,ca_state#1782,ca_zip#1783,ca_country#1784,ca_gmt_offset#1785,ca_location_type#1786] parquet
                        :  :  +- SubqueryAlias ib1
                        :  :     +- SubqueryAlias income_band
                        :  :        +- Relation[ib_income_band_sk#558,ib_lower_bound#559,ib_upper_bound#560] parquet
                        :  +- SubqueryAlias ib2
                        :     +- SubqueryAlias income_band
                        :        +- Relation[ib_income_band_sk#1787,ib_lower_bound#1788,ib_upper_bound#1789] parquet
                        +- SubqueryAlias item
                           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

     : benchmark
2022-09-08 15:12:56,573 INFO perf.Query: 
== Query: q64-v2.4 ==
Sort [product_name#1848 ASC NULLS FIRST, store_name#1850 ASC NULLS FIRST, cnt#2082L ASC NULLS FIRST], true
+- Project [product_name#1848, store_name#1850, store_zip#1851, b_street_number#1852, b_streen_name#1853, b_city#1854, b_zip#1855, c_street_number#1856, c_street_name#1857, c_city#1858, c_zip#1859, syear#1860, cnt#1863L, s1#1864, s2#1865, s3#1866, s1#2083, s2#2084, s3#2085, syear#2079, cnt#2082L]
   +- Filter ((((item_sk#1849 = item_sk#2068) AND (syear#1860 = 1999)) AND (syear#2079 = (1999 + 1))) AND (((cnt#2082L <= cnt#1863L) AND (store_name#1850 = store_name#2069)) AND (store_zip#1851 = store_zip#2070)))
      +- Join Inner
         :- SubqueryAlias cs1
         :  +- SubqueryAlias cross_sales
         :     +- Aggregate [i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#1955, ca_street_name#1956, ca_city#1959, ca_zip#1962, d_year#498, d_year#1889, d_year#1917], [i_product_name#585 AS product_name#1848, i_item_sk#564 AS item_sk#1849, s_store_name#669 AS store_name#1850, s_zip#689 AS store_zip#1851, ca_street_number#450 AS b_street_number#1852, ca_street_name#451 AS b_streen_name#1853, ca_city#454 AS b_city#1854, ca_zip#457 AS b_zip#1855, ca_street_number#1955 AS c_street_number#1856, ca_street_name#1956 AS c_street_name#1857, ca_city#1959 AS c_city#1858, ca_zip#1962 AS c_zip#1859, d_year#498 AS syear#1860, d_year#1889 AS fsyear#1861, d_year#1917 AS s2year#1862, count(1) AS cnt#1863L, sum(ss_wholesale_cost#140) AS s1#1864, sum(ss_list_price#141) AS s2#1865, sum(ss_coupon_amt#148) AS s3#1866]
         :        +- Filter ((((((ss_store_sk#136 = s_store_sk#664) AND (ss_sold_date_sk#152 = d_date_sk#492)) AND (ss_customer_sk#132 = c_customer_sk#412)) AND (((ss_cdemo_sk#133 = cd_demo_sk#474) AND (ss_hdemo_sk#134 = hd_demo_sk#548)) AND (ss_addr_sk#135 = ca_address_sk#448))) AND ((((ss_item_sk#131 = i_item_sk#564) AND (ss_item_sk#131 = sr_item_sk#177)) AND (ss_ticket_number#138L = sr_ticket_number#184L)) AND ((ss_item_sk#131 = cs_item_sk#14) AND (c_current_cdemo_sk#414 = cd_demo_sk#1939)))) AND (((((c_current_hdemo_sk#415 = hd_demo_sk#1948) AND (c_current_addr_sk#416 = ca_address_sk#1953)) AND (c_first_sales_date_sk#418 = d_date_sk#1883)) AND (((c_first_shipto_date_sk#417 = d_date_sk#1911) AND (ss_promo_sk#137 = p_promo_sk#608)) AND (hd_income_band_sk#549 = ib_income_band_sk#558))) AND ((((hd_income_band_sk#1949 = ib_income_band_sk#1966) AND NOT (cd_marital_status#476 = cd_marital_status#1941)) AND i_color#581 IN (purple,burlywood,indian,spring,floral,medium)) AND (((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(64 as decimal(2,0)) as decimal(7,2))) AND (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 10) as decimal(10,0)) as decimal(12,2)))) AND ((cast(i_current_price#569 as decimal(12,2)) >= cast(cast((64 + 1) as decimal(10,0)) as decimal(12,2))) AND (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 15) as decimal(10,0)) as decimal(12,2))))))))
         :           +- Join Inner
         :              :- Join Inner
         :              :  :- Join Inner
         :              :  :  :- Join Inner
         :              :  :  :  :- Join Inner
         :              :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- SubqueryAlias store_sales
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- Relation[ss_sold_time_sk#130,ss_item_sk#131,ss_customer_sk#132,ss_cdemo_sk#133,ss_hdemo_sk#134,ss_addr_sk#135,ss_store_sk#136,ss_promo_sk#137,ss_ticket_number#138L,ss_quantity#139,ss_wholesale_cost#140,ss_list_price#141,ss_sales_price#142,ss_ext_discount_amt#143,ss_ext_sales_price#144,ss_ext_wholesale_cost#145,ss_ext_list_price#146,ss_ext_tax#147,ss_coupon_amt#148,ss_net_paid#149,ss_net_paid_inc_tax#150,ss_net_profit#151,ss_sold_date_sk#152] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias store_returns
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Relation[sr_return_time_sk#176,sr_item_sk#177,sr_customer_sk#178,sr_cdemo_sk#179,sr_hdemo_sk#180,sr_addr_sk#181,sr_store_sk#182,sr_reason_sk#183,sr_ticket_number#184L,sr_return_quantity#185,sr_return_amt#186,sr_return_tax#187,sr_return_amt_inc_tax#188,sr_fee#189,sr_return_ship_cost#190,sr_refunded_cash#191,sr_reversed_charge#192,sr_store_credit#193,sr_net_loss#194,sr_returned_date_sk#195] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias cs_ui
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Project [cs_item_sk#14, sale#1846, refund#1847]
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Filter (cast(sum(cs_ext_list_price#24)#1876 as decimal(21,2)) > cast(CheckOverflow((promote_precision(cast(cast(2 as decimal(1,0)) as decimal(19,2))) * promote_precision(cast(sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#90 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#91 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#92 as decimal(9,2)))), DecimalType(9,2), true))#1877 as decimal(19,2)))), DecimalType(21,2), true) as decimal(21,2)))
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :           +- Aggregate [cs_item_sk#14], [cs_item_sk#14, sum(cs_ext_list_price#24) AS sale#1846, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#90 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#91 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#92 as decimal(9,2)))), DecimalType(9,2), true)) AS refund#1847, sum(cs_ext_list_price#24) AS sum(cs_ext_list_price#24)#1876, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#90 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#91 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#92 as decimal(9,2)))), DecimalType(9,2), true)) AS sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#90 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#91 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#92 as decimal(9,2)))), DecimalType(9,2), true))#1877]
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :              +- Filter ((cs_item_sk#14 = cr_item_sk#69) AND (cs_order_number#16L = cr_order_number#83L))
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                 +- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :- SubqueryAlias catalog_sales
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :  +- Relation[cs_sold_time_sk#0,cs_ship_date_sk#1,cs_bill_customer_sk#2,cs_bill_cdemo_sk#3,cs_bill_hdemo_sk#4,cs_bill_addr_sk#5,cs_ship_customer_sk#6,cs_ship_cdemo_sk#7,cs_ship_hdemo_sk#8,cs_ship_addr_sk#9,cs_call_center_sk#10,cs_catalog_page_sk#11,cs_ship_mode_sk#12,cs_warehouse_sk#13,cs_item_sk#14,cs_promo_sk#15,cs_order_number#16L,cs_quantity#17,cs_wholesale_cost#18,cs_list_price#19,cs_sales_price#20,cs_ext_discount_amt#21,cs_ext_sales_price#22,cs_ext_wholesale_cost#23,... 10 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    +- SubqueryAlias catalog_returns
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                       +- Relation[cr_returned_time_sk#68,cr_item_sk#69,cr_refunded_customer_sk#70,cr_refunded_cdemo_sk#71,cr_refunded_hdemo_sk#72,cr_refunded_addr_sk#73,cr_returning_customer_sk#74,cr_returning_cdemo_sk#75,cr_returning_hdemo_sk#76,cr_returning_addr_sk#77,cr_call_center_sk#78,cr_catalog_page_sk#79,cr_ship_mode_sk#80,cr_warehouse_sk#81,cr_reason_sk#82,cr_order_number#83L,cr_return_quantity#84,cr_return_amount#85,cr_return_tax#86,cr_return_amt_inc_tax#87,cr_fee#88,cr_return_ship_cost#89,cr_refunded_cash#90,cr_reversed_charge#91,... 3 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias d1
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias date_dim
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias d2
         :              :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias date_dim
         :              :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#1883,d_date_id#1884,d_date#1885,d_month_seq#1886,d_week_seq#1887,d_quarter_seq#1888,d_year#1889,d_dow#1890,d_moy#1891,d_dom#1892,d_qoy#1893,d_fy_year#1894,d_fy_quarter_seq#1895,d_fy_week_seq#1896,d_day_name#1897,d_quarter_name#1898,d_holiday#1899,d_weekend#1900,d_following_holiday#1901,d_first_dom#1902,d_last_dom#1903,d_same_day_ly#1904,d_same_day_lq#1905,d_current_day#1906,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias d3
         :              :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias date_dim
         :              :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#1911,d_date_id#1912,d_date#1913,d_month_seq#1914,d_week_seq#1915,d_quarter_seq#1916,d_year#1917,d_dow#1918,d_moy#1919,d_dom#1920,d_qoy#1921,d_fy_year#1922,d_fy_quarter_seq#1923,d_fy_week_seq#1924,d_day_name#1925,d_quarter_name#1926,d_holiday#1927,d_weekend#1928,d_following_holiday#1929,d_first_dom#1930,d_last_dom#1931,d_same_day_ly#1932,d_same_day_lq#1933,d_current_day#1934,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias store
         :              :  :  :  :  :  :  :  :  :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias customer
         :              :  :  :  :  :  :  :  :  :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
         :              :  :  :  :  :  :  :  :  :  +- SubqueryAlias cd1
         :              :  :  :  :  :  :  :  :  :     +- SubqueryAlias customer_demographics
         :              :  :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
         :              :  :  :  :  :  :  :  :  +- SubqueryAlias cd2
         :              :  :  :  :  :  :  :  :     +- SubqueryAlias customer_demographics
         :              :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#1939,cd_gender#1940,cd_marital_status#1941,cd_education_status#1942,cd_purchase_estimate#1943,cd_credit_rating#1944,cd_dep_count#1945,cd_dep_employed_count#1946,cd_dep_college_count#1947] parquet
         :              :  :  :  :  :  :  :  +- SubqueryAlias promotion
         :              :  :  :  :  :  :  :     +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet
         :              :  :  :  :  :  :  +- SubqueryAlias hd1
         :              :  :  :  :  :  :     +- SubqueryAlias household_demographics
         :              :  :  :  :  :  :        +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
         :              :  :  :  :  :  +- SubqueryAlias hd2
         :              :  :  :  :  :     +- SubqueryAlias household_demographics
         :              :  :  :  :  :        +- Relation[hd_demo_sk#1948,hd_income_band_sk#1949,hd_buy_potential#1950,hd_dep_count#1951,hd_vehicle_count#1952] parquet
         :              :  :  :  :  +- SubqueryAlias ad1
         :              :  :  :  :     +- SubqueryAlias customer_address
         :              :  :  :  :        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
         :              :  :  :  +- SubqueryAlias ad2
         :              :  :  :     +- SubqueryAlias customer_address
         :              :  :  :        +- Relation[ca_address_sk#1953,ca_address_id#1954,ca_street_number#1955,ca_street_name#1956,ca_street_type#1957,ca_suite_number#1958,ca_city#1959,ca_county#1960,ca_state#1961,ca_zip#1962,ca_country#1963,ca_gmt_offset#1964,ca_location_type#1965] parquet
         :              :  :  +- SubqueryAlias ib1
         :              :  :     +- SubqueryAlias income_band
         :              :  :        +- Relation[ib_income_band_sk#558,ib_lower_bound#559,ib_upper_bound#560] parquet
         :              :  +- SubqueryAlias ib2
         :              :     +- SubqueryAlias income_band
         :              :        +- Relation[ib_income_band_sk#1966,ib_lower_bound#1967,ib_upper_bound#1968] parquet
         :              +- SubqueryAlias item
         :                 +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
         +- SubqueryAlias cs2
            +- SubqueryAlias cross_sales
               +- Aggregate [i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#2041, ca_street_name#2042, ca_city#2045, ca_zip#2048, d_year#498, d_year#1975, d_year#2003], [i_product_name#585 AS product_name#2067, i_item_sk#564 AS item_sk#2068, s_store_name#669 AS store_name#2069, s_zip#689 AS store_zip#2070, ca_street_number#450 AS b_street_number#2071, ca_street_name#451 AS b_streen_name#2072, ca_city#454 AS b_city#2073, ca_zip#457 AS b_zip#2074, ca_street_number#2041 AS c_street_number#2075, ca_street_name#2042 AS c_street_name#2076, ca_city#2045 AS c_city#2077, ca_zip#2048 AS c_zip#2078, d_year#498 AS syear#2079, d_year#1975 AS fsyear#2080, d_year#2003 AS s2year#2081, count(1) AS cnt#2082L, sum(ss_wholesale_cost#140) AS s1#2083, sum(ss_list_price#141) AS s2#2084, sum(ss_coupon_amt#148) AS s3#2085]
                  +- Filter ((((((ss_store_sk#136 = s_store_sk#664) AND (ss_sold_date_sk#152 = d_date_sk#492)) AND (ss_customer_sk#132 = c_customer_sk#412)) AND (((ss_cdemo_sk#133 = cd_demo_sk#474) AND (ss_hdemo_sk#134 = hd_demo_sk#548)) AND (ss_addr_sk#135 = ca_address_sk#448))) AND ((((ss_item_sk#131 = i_item_sk#564) AND (ss_item_sk#131 = sr_item_sk#177)) AND (ss_ticket_number#138L = sr_ticket_number#184L)) AND ((ss_item_sk#131 = cs_item_sk#14) AND (c_current_cdemo_sk#414 = cd_demo_sk#2025)))) AND (((((c_current_hdemo_sk#415 = hd_demo_sk#2034) AND (c_current_addr_sk#416 = ca_address_sk#2039)) AND (c_first_sales_date_sk#418 = d_date_sk#1969)) AND (((c_first_shipto_date_sk#417 = d_date_sk#1997) AND (ss_promo_sk#137 = p_promo_sk#608)) AND (hd_income_band_sk#549 = ib_income_band_sk#558))) AND ((((hd_income_band_sk#2035 = ib_income_band_sk#2052) AND NOT (cd_marital_status#476 = cd_marital_status#2027)) AND i_color#581 IN (purple,burlywood,indian,spring,floral,medium)) AND (((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(64 as decimal(2,0)) as decimal(7,2))) AND (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 10) as decimal(10,0)) as decimal(12,2)))) AND ((cast(i_current_price#569 as decimal(12,2)) >= cast(cast((64 + 1) as decimal(10,0)) as decimal(12,2))) AND (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 15) as decimal(10,0)) as decimal(12,2))))))))
                     +- Join Inner
                        :- Join Inner
                        :  :- Join Inner
                        :  :  :- Join Inner
                        :  :  :  :- Join Inner
                        :  :  :  :  :- Join Inner
                        :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- SubqueryAlias store_sales
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- Relation[ss_sold_time_sk#130,ss_item_sk#131,ss_customer_sk#132,ss_cdemo_sk#133,ss_hdemo_sk#134,ss_addr_sk#135,ss_store_sk#136,ss_promo_sk#137,ss_ticket_number#138L,ss_quantity#139,ss_wholesale_cost#140,ss_list_price#141,ss_sales_price#142,ss_ext_discount_amt#143,ss_ext_sales_price#144,ss_ext_wholesale_cost#145,ss_ext_list_price#146,ss_ext_tax#147,ss_coupon_amt#148,ss_net_paid#149,ss_net_paid_inc_tax#150,ss_net_profit#151,ss_sold_date_sk#152] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias store_returns
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Relation[sr_return_time_sk#176,sr_item_sk#177,sr_customer_sk#178,sr_cdemo_sk#179,sr_hdemo_sk#180,sr_addr_sk#181,sr_store_sk#182,sr_reason_sk#183,sr_ticket_number#184L,sr_return_quantity#185,sr_return_amt#186,sr_return_tax#187,sr_return_amt_inc_tax#188,sr_fee#189,sr_return_ship_cost#190,sr_refunded_cash#191,sr_reversed_charge#192,sr_store_credit#193,sr_net_loss#194,sr_returned_date_sk#195] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias cs_ui
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Project [cs_item_sk#14, sale#1846, refund#1847]
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Filter (cast(sum(cs_ext_list_price#24)#1881 as decimal(21,2)) > cast(CheckOverflow((promote_precision(cast(cast(2 as decimal(1,0)) as decimal(19,2))) * promote_precision(cast(sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#90 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#91 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#92 as decimal(9,2)))), DecimalType(9,2), true))#1882 as decimal(19,2)))), DecimalType(21,2), true) as decimal(21,2)))
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :           +- Aggregate [cs_item_sk#14], [cs_item_sk#14, sum(cs_ext_list_price#24) AS sale#1846, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#90 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#91 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#92 as decimal(9,2)))), DecimalType(9,2), true)) AS refund#1847, sum(cs_ext_list_price#24) AS sum(cs_ext_list_price#24)#1881, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#90 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#91 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#92 as decimal(9,2)))), DecimalType(9,2), true)) AS sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#90 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#91 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#92 as decimal(9,2)))), DecimalType(9,2), true))#1882]
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :              +- Filter ((cs_item_sk#14 = cr_item_sk#69) AND (cs_order_number#16L = cr_order_number#83L))
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                 +- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :- SubqueryAlias catalog_sales
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :  +- Relation[cs_sold_time_sk#0,cs_ship_date_sk#1,cs_bill_customer_sk#2,cs_bill_cdemo_sk#3,cs_bill_hdemo_sk#4,cs_bill_addr_sk#5,cs_ship_customer_sk#6,cs_ship_cdemo_sk#7,cs_ship_hdemo_sk#8,cs_ship_addr_sk#9,cs_call_center_sk#10,cs_catalog_page_sk#11,cs_ship_mode_sk#12,cs_warehouse_sk#13,cs_item_sk#14,cs_promo_sk#15,cs_order_number#16L,cs_quantity#17,cs_wholesale_cost#18,cs_list_price#19,cs_sales_price#20,cs_ext_discount_amt#21,cs_ext_sales_price#22,cs_ext_wholesale_cost#23,... 10 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    +- SubqueryAlias catalog_returns
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                       +- Relation[cr_returned_time_sk#68,cr_item_sk#69,cr_refunded_customer_sk#70,cr_refunded_cdemo_sk#71,cr_refunded_hdemo_sk#72,cr_refunded_addr_sk#73,cr_returning_customer_sk#74,cr_returning_cdemo_sk#75,cr_returning_hdemo_sk#76,cr_returning_addr_sk#77,cr_call_center_sk#78,cr_catalog_page_sk#79,cr_ship_mode_sk#80,cr_warehouse_sk#81,cr_reason_sk#82,cr_order_number#83L,cr_return_quantity#84,cr_return_amount#85,cr_return_tax#86,cr_return_amt_inc_tax#87,cr_fee#88,cr_return_ship_cost#89,cr_refunded_cash#90,cr_reversed_charge#91,... 3 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias d1
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias date_dim
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias d2
                        :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias date_dim
                        :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#1969,d_date_id#1970,d_date#1971,d_month_seq#1972,d_week_seq#1973,d_quarter_seq#1974,d_year#1975,d_dow#1976,d_moy#1977,d_dom#1978,d_qoy#1979,d_fy_year#1980,d_fy_quarter_seq#1981,d_fy_week_seq#1982,d_day_name#1983,d_quarter_name#1984,d_holiday#1985,d_weekend#1986,d_following_holiday#1987,d_first_dom#1988,d_last_dom#1989,d_same_day_ly#1990,d_same_day_lq#1991,d_current_day#1992,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias d3
                        :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias date_dim
                        :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#1997,d_date_id#1998,d_date#1999,d_month_seq#2000,d_week_seq#2001,d_quarter_seq#2002,d_year#2003,d_dow#2004,d_moy#2005,d_dom#2006,d_qoy#2007,d_fy_year#2008,d_fy_quarter_seq#2009,d_fy_week_seq#2010,d_day_name#2011,d_quarter_name#2012,d_holiday#2013,d_weekend#2014,d_following_holiday#2015,d_first_dom#2016,d_last_dom#2017,d_same_day_ly#2018,d_same_day_lq#2019,d_current_day#2020,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias store
                        :  :  :  :  :  :  :  :  :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias customer
                        :  :  :  :  :  :  :  :  :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                        :  :  :  :  :  :  :  :  :  +- SubqueryAlias cd1
                        :  :  :  :  :  :  :  :  :     +- SubqueryAlias customer_demographics
                        :  :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
                        :  :  :  :  :  :  :  :  +- SubqueryAlias cd2
                        :  :  :  :  :  :  :  :     +- SubqueryAlias customer_demographics
                        :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#2025,cd_gender#2026,cd_marital_status#2027,cd_education_status#2028,cd_purchase_estimate#2029,cd_credit_rating#2030,cd_dep_count#2031,cd_dep_employed_count#2032,cd_dep_college_count#2033] parquet
                        :  :  :  :  :  :  :  +- SubqueryAlias promotion
                        :  :  :  :  :  :  :     +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet
                        :  :  :  :  :  :  +- SubqueryAlias hd1
                        :  :  :  :  :  :     +- SubqueryAlias household_demographics
                        :  :  :  :  :  :        +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
                        :  :  :  :  :  +- SubqueryAlias hd2
                        :  :  :  :  :     +- SubqueryAlias household_demographics
                        :  :  :  :  :        +- Relation[hd_demo_sk#2034,hd_income_band_sk#2035,hd_buy_potential#2036,hd_dep_count#2037,hd_vehicle_count#2038] parquet
                        :  :  :  :  +- SubqueryAlias ad1
                        :  :  :  :     +- SubqueryAlias customer_address
                        :  :  :  :        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                        :  :  :  +- SubqueryAlias ad2
                        :  :  :     +- SubqueryAlias customer_address
                        :  :  :        +- Relation[ca_address_sk#2039,ca_address_id#2040,ca_street_number#2041,ca_street_name#2042,ca_street_type#2043,ca_suite_number#2044,ca_city#2045,ca_county#2046,ca_state#2047,ca_zip#2048,ca_country#2049,ca_gmt_offset#2050,ca_location_type#2051] parquet
                        :  :  +- SubqueryAlias ib1
                        :  :     +- SubqueryAlias income_band
                        :  :        +- Relation[ib_income_band_sk#558,ib_lower_bound#559,ib_upper_bound#560] parquet
                        :  +- SubqueryAlias ib2
                        :     +- SubqueryAlias income_band
                        :        +- Relation[ib_income_band_sk#2052,ib_lower_bound#2053,ib_upper_bound#2054] parquet
                        +- SubqueryAlias item
                           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

      running Thread[benchmark runner,5,main]
2022-09-08 15:12:57,997 WARN adaptive.InsertAdaptiveSparkPlan: spark.sql.adaptive.enabled is enabled but is not supported for query: Sort [product_name#2113 ASC NULLS FIRST, store_name#2115 ASC NULLS FIRST, cnt#2347L ASC NULLS FIRST], true, 0
+- Project [product_name#2113, store_name#2115, store_zip#2116, b_street_number#2117, b_streen_name#2118, b_city#2119, b_zip#2120, c_street_number#2121, c_street_name#2122, c_city#2123, c_zip#2124, syear#2125, cnt#2128L, s1#2129, s2#2130, s3#2131, s1#2348, s2#2349, s3#2350, syear#2344, cnt#2347L]
   +- SortMergeJoin [item_sk#2114, store_name#2115, store_zip#2116], [item_sk#2333, store_name#2334, store_zip#2335], Inner, (cnt#2347L <= cnt#2128L)
      :- HashAggregate(keys=[i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#2220, ca_street_name#2221, ca_city#2224, ca_zip#2227, d_year#498, d_year#2154, d_year#2182], functions=[count(1), sum(UnscaledValue(ss_wholesale_cost#140)), sum(UnscaledValue(ss_list_price#141)), sum(UnscaledValue(ss_coupon_amt#148))], output=[product_name#2113, item_sk#2114, store_name#2115, store_zip#2116, b_street_number#2117, b_streen_name#2118, b_city#2119, b_zip#2120, c_street_number#2121, c_street_name#2122, c_city#2123, c_zip#2124, syear#2125, cnt#2128L, s1#2129, s2#2130, s3#2131])
      :  +- HashAggregate(keys=[i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#2220, ca_street_name#2221, ca_city#2224, ca_zip#2227, d_year#498, d_year#2154, d_year#2182], functions=[partial_count(1), partial_sum(UnscaledValue(ss_wholesale_cost#140)), partial_sum(UnscaledValue(ss_list_price#141)), partial_sum(UnscaledValue(ss_coupon_amt#148))], output=[i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#2220, ca_street_name#2221, ca_city#2224, ca_zip#2227, d_year#498, d_year#2154, d_year#2182, count#2382L, sum#2383L, sum#2384L, sum#2385L])
      :     +- Project [ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, d_year#2154, d_year#2182, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#2220, ca_street_name#2221, ca_city#2224, ca_zip#2227, i_item_sk#564, i_product_name#585]
      :        +- BroadcastHashJoin [ss_item_sk#131], [i_item_sk#564], Inner, BuildRight, false
      :           :- Project [ss_item_sk#131, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, d_year#2154, d_year#2182, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#2220, ca_street_name#2221, ca_city#2224, ca_zip#2227]
      :           :  +- BroadcastHashJoin [hd_income_band_sk#2214], [ib_income_band_sk#2231], Inner, BuildRight, false
      :           :     :- Project [ss_item_sk#131, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, d_year#2154, d_year#2182, hd_income_band_sk#2214, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#2220, ca_street_name#2221, ca_city#2224, ca_zip#2227]
      :           :     :  +- BroadcastHashJoin [hd_income_band_sk#549], [ib_income_band_sk#558], Inner, BuildRight, false
      :           :     :     :- Project [ss_item_sk#131, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, d_year#2154, d_year#2182, hd_income_band_sk#549, hd_income_band_sk#2214, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#2220, ca_street_name#2221, ca_city#2224, ca_zip#2227]
      :           :     :     :  +- BroadcastHashJoin [c_current_addr_sk#416], [ca_address_sk#2218], Inner, BuildRight, false
      :           :     :     :     :- Project [ss_item_sk#131, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_addr_sk#416, d_year#2154, d_year#2182, hd_income_band_sk#549, hd_income_band_sk#2214, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457]
      :           :     :     :     :  +- BroadcastHashJoin [ss_addr_sk#135], [ca_address_sk#448], Inner, BuildRight, false
      :           :     :     :     :     :- Project [ss_item_sk#131, ss_addr_sk#135, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_addr_sk#416, d_year#2154, d_year#2182, hd_income_band_sk#549, hd_income_band_sk#2214]
      :           :     :     :     :     :  +- BroadcastHashJoin [c_current_hdemo_sk#415], [hd_demo_sk#2213], Inner, BuildRight, false
      :           :     :     :     :     :     :- Project [ss_item_sk#131, ss_addr_sk#135, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_hdemo_sk#415, c_current_addr_sk#416, d_year#2154, d_year#2182, hd_income_band_sk#549]
      :           :     :     :     :     :     :  +- BroadcastHashJoin [ss_hdemo_sk#134], [hd_demo_sk#548], Inner, BuildRight, false
      :           :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_hdemo_sk#134, ss_addr_sk#135, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_hdemo_sk#415, c_current_addr_sk#416, d_year#2154, d_year#2182]
      :           :     :     :     :     :     :     :  +- BroadcastHashJoin [ss_promo_sk#137], [p_promo_sk#608], Inner, BuildRight, false
      :           :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_hdemo_sk#134, ss_addr_sk#135, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_hdemo_sk#415, c_current_addr_sk#416, d_year#2154, d_year#2182]
      :           :     :     :     :     :     :     :     :  +- BroadcastHashJoin [c_current_cdemo_sk#414], [cd_demo_sk#2204], Inner, BuildRight, NOT (cd_marital_status#476 = cd_marital_status#2206), false
      :           :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_hdemo_sk#134, ss_addr_sk#135, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_cdemo_sk#414, c_current_hdemo_sk#415, c_current_addr_sk#416, d_year#2154, d_year#2182, cd_marital_status#476]
      :           :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [ss_cdemo_sk#133], [cd_demo_sk#474], Inner, BuildRight, false
      :           :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_cdemo_sk#414, c_current_hdemo_sk#415, c_current_addr_sk#416, d_year#2154, d_year#2182]
      :           :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [c_first_shipto_date_sk#417], [d_date_sk#2176], Inner, BuildRight, false
      :           :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_cdemo_sk#414, c_current_hdemo_sk#415, c_current_addr_sk#416, c_first_shipto_date_sk#417, d_year#2154]
      :           :     :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [c_first_sales_date_sk#418], [d_date_sk#2148], Inner, BuildRight, false
      :           :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_cdemo_sk#414, c_current_hdemo_sk#415, c_current_addr_sk#416, c_first_shipto_date_sk#417, c_first_sales_date_sk#418]
      :           :     :     :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [ss_customer_sk#132], [c_customer_sk#412], Inner, BuildRight, false
      :           :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_customer_sk#132, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689]
      :           :     :     :     :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [ss_store_sk#136], [s_store_sk#664], Inner, BuildRight, false
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_customer_sk#132, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_store_sk#136, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498]
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [ss_sold_date_sk#152], [d_date_sk#492], Inner, BuildRight, false
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_customer_sk#132, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_store_sk#136, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, ss_sold_date_sk#152]
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- SortMergeJoin [ss_item_sk#131], [cs_item_sk#14], Inner
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_customer_sk#132, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_store_sk#136, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, ss_sold_date_sk#152]
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- SortMergeJoin [ss_item_sk#131, ss_ticket_number#138L], [sr_item_sk#177, sr_ticket_number#184L], Inner
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_customer_sk#132, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_store_sk#136, ss_promo_sk#137, ss_ticket_number#138L, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, ss_sold_date_sk#152]
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- Filter (((((((isnotnull(ss_item_sk#131) AND isnotnull(ss_ticket_number#138L)) AND isnotnull(ss_store_sk#136)) AND isnotnull(ss_customer_sk#132)) AND isnotnull(ss_cdemo_sk#133)) AND isnotnull(ss_promo_sk#137)) AND isnotnull(ss_hdemo_sk#134)) AND isnotnull(ss_addr_sk#135))
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- FileScan parquet [ss_item_sk#131,ss_customer_sk#132,ss_cdemo_sk#133,ss_hdemo_sk#134,ss_addr_sk#135,ss_store_sk#136,ss_promo_sk#137,ss_ticket_number#138L,ss_wholesale_cost#140,ss_list_price#141,ss_coupon_amt#148,ss_sold_date_sk#152] Batched: true, DataFilters: [isnotnull(ss_item_sk#131), isnotnull(ss_ticket_number#138L), isnotnull(ss_store_sk#136), isnotnu..., Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/store_sales], PartitionFilters: [isnotnull(ss_sold_date_sk#152), dynamicpruning#2376 [ss_sold_date_sk#152]], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_ticket_number), IsNotNull(ss_store_sk), IsNotNull(ss_custome..., ReadSchema: struct<ss_item_sk:int,ss_customer_sk:int,ss_cdemo_sk:int,ss_hdemo_sk:int,ss_addr_sk:int,ss_store_...
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- Project [d_date_sk#492, d_year#498]
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :              +- Filter ((isnotnull(d_year#498) AND (d_year#498 = 1999)) AND isnotnull(d_date_sk#492))
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                 +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [sr_item_sk#177, sr_ticket_number#184L]
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter (isnotnull(sr_item_sk#177) AND isnotnull(sr_ticket_number#184L))
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- FileScan parquet [sr_item_sk#177,sr_ticket_number#184L,sr_returned_date_sk#195] Batched: true, DataFilters: [isnotnull(sr_item_sk#177), isnotnull(sr_ticket_number#184L)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/store_returns], PartitionFilters: [], PushedFilters: [IsNotNull(sr_item_sk), IsNotNull(sr_ticket_number)], ReadSchema: struct<sr_item_sk:int,sr_ticket_number:bigint>
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [cs_item_sk#14]
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter (isnotnull(sum(cs_ext_list_price#24)#2141) AND (cast(sum(cs_ext_list_price#24)#2141 as decimal(21,2)) > CheckOverflow((2.00 * promote_precision(sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#90 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#91 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#92 as decimal(9,2)))), DecimalType(9,2), true))#2142)), DecimalType(21,2), true)))
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- HashAggregate(keys=[cs_item_sk#14], functions=[sum(UnscaledValue(cs_ext_list_price#24)), sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#90 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#91 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#92 as decimal(9,2)))), DecimalType(9,2), true))], output=[cs_item_sk#14, sum(cs_ext_list_price#24)#2141, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#90 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#91 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#92 as decimal(9,2)))), DecimalType(9,2), true))#2142])
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :              +- HashAggregate(keys=[cs_item_sk#14], functions=[partial_sum(UnscaledValue(cs_ext_list_price#24)), partial_sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#90 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#91 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#92 as decimal(9,2)))), DecimalType(9,2), true))], output=[cs_item_sk#14, sum#2389L, sum#2390, isEmpty#2391])
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                 +- Project [cs_item_sk#14, cs_ext_list_price#24, cr_refunded_cash#90, cr_reversed_charge#91, cr_store_credit#92]
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                    +- SortMergeJoin [cs_item_sk#14, cs_order_number#16L], [cr_item_sk#69, cr_order_number#83L], Inner
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                       :- Project [cs_item_sk#14, cs_order_number#16L, cs_ext_list_price#24]
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                       :  +- Filter (isnotnull(cs_item_sk#14) AND isnotnull(cs_order_number#16L))
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                       :     +- FileScan parquet [cs_item_sk#14,cs_order_number#16L,cs_ext_list_price#24,cs_sold_date_sk#33] Batched: true, DataFilters: [isnotnull(cs_item_sk#14), isnotnull(cs_order_number#16L)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/catalog_sales], PartitionFilters: [], PushedFilters: [IsNotNull(cs_item_sk), IsNotNull(cs_order_number)], ReadSchema: struct<cs_item_sk:int,cs_order_number:bigint,cs_ext_list_price:decimal(7,2)>
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                       +- Project [cr_item_sk#69, cr_order_number#83L, cr_refunded_cash#90, cr_reversed_charge#91, cr_store_credit#92]
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                          +- Filter (isnotnull(cr_item_sk#69) AND isnotnull(cr_order_number#83L))
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                             +- FileScan parquet [cr_item_sk#69,cr_order_number#83L,cr_refunded_cash#90,cr_reversed_charge#91,cr_store_credit#92,cr_returned_date_sk#94] Batched: true, DataFilters: [isnotnull(cr_item_sk#69), isnotnull(cr_order_number#83L)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/catalog_returns], PartitionFilters: [], PushedFilters: [IsNotNull(cr_item_sk), IsNotNull(cr_order_number)], ReadSchema: struct<cr_item_sk:int,cr_order_number:bigint,cr_refunded_cash:decimal(7,2),cr_reversed_charge:dec...
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [d_date_sk#492, d_year#498]
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter ((isnotnull(d_year#498) AND (d_year#498 = 1999)) AND isnotnull(d_date_sk#492))
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- FileScan parquet [d_date_sk#492,d_year#498] Batched: true, DataFilters: [isnotnull(d_year#498), (d_year#498 = 1999), isnotnull(d_date_sk#492)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), EqualTo(d_year,1999), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [s_store_sk#664, s_store_name#669, s_zip#689]
      :           :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter ((isnotnull(s_store_sk#664) AND isnotnull(s_store_name#669)) AND isnotnull(s_zip#689))
      :           :     :     :     :     :     :     :     :     :     :     :     :     :           +- FileScan parquet [s_store_sk#664,s_store_name#669,s_zip#689] Batched: true, DataFilters: [isnotnull(s_store_sk#664), isnotnull(s_store_name#669), isnotnull(s_zip#689)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/store], PartitionFilters: [], PushedFilters: [IsNotNull(s_store_sk), IsNotNull(s_store_name), IsNotNull(s_zip)], ReadSchema: struct<s_store_sk:int,s_store_name:string,s_zip:string>
      :           :     :     :     :     :     :     :     :     :     :     :     :     +- Project [c_customer_sk#412, c_current_cdemo_sk#414, c_current_hdemo_sk#415, c_current_addr_sk#416, c_first_shipto_date_sk#417, c_first_sales_date_sk#418]
      :           :     :     :     :     :     :     :     :     :     :     :     :        +- Filter (((((isnotnull(c_customer_sk#412) AND isnotnull(c_first_sales_date_sk#418)) AND isnotnull(c_first_shipto_date_sk#417)) AND isnotnull(c_current_cdemo_sk#414)) AND isnotnull(c_current_hdemo_sk#415)) AND isnotnull(c_current_addr_sk#416))
      :           :     :     :     :     :     :     :     :     :     :     :     :           +- FileScan parquet [c_customer_sk#412,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418] Batched: true, DataFilters: [isnotnull(c_customer_sk#412), isnotnull(c_first_sales_date_sk#418), isnotnull(c_first_shipto_dat..., Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/customer], PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk), IsNotNull(c_first_sales_date_sk), IsNotNull(c_first_shipto_date_sk), I..., ReadSchema: struct<c_customer_sk:int,c_current_cdemo_sk:int,c_current_hdemo_sk:int,c_current_addr_sk:int,c_fi...
      :           :     :     :     :     :     :     :     :     :     :     :     +- Project [d_date_sk#2148, d_year#2154]
      :           :     :     :     :     :     :     :     :     :     :     :        +- Filter isnotnull(d_date_sk#2148)
      :           :     :     :     :     :     :     :     :     :     :     :           +- FileScan parquet [d_date_sk#2148,d_year#2154] Batched: true, DataFilters: [isnotnull(d_date_sk#2148)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
      :           :     :     :     :     :     :     :     :     :     :     +- Project [d_date_sk#2176, d_year#2182]
      :           :     :     :     :     :     :     :     :     :     :        +- Filter isnotnull(d_date_sk#2176)
      :           :     :     :     :     :     :     :     :     :     :           +- FileScan parquet [d_date_sk#2176,d_year#2182] Batched: true, DataFilters: [isnotnull(d_date_sk#2176)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
      :           :     :     :     :     :     :     :     :     :     +- Project [cd_demo_sk#474, cd_marital_status#476]
      :           :     :     :     :     :     :     :     :     :        +- Filter (isnotnull(cd_demo_sk#474) AND isnotnull(cd_marital_status#476))
      :           :     :     :     :     :     :     :     :     :           +- FileScan parquet [cd_demo_sk#474,cd_marital_status#476] Batched: true, DataFilters: [isnotnull(cd_demo_sk#474), isnotnull(cd_marital_status#476)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/customer_demographics], PartitionFilters: [], PushedFilters: [IsNotNull(cd_demo_sk), IsNotNull(cd_marital_status)], ReadSchema: struct<cd_demo_sk:int,cd_marital_status:string>
      :           :     :     :     :     :     :     :     :     +- Project [cd_demo_sk#2204, cd_marital_status#2206]
      :           :     :     :     :     :     :     :     :        +- Filter (isnotnull(cd_demo_sk#2204) AND isnotnull(cd_marital_status#2206))
      :           :     :     :     :     :     :     :     :           +- FileScan parquet [cd_demo_sk#2204,cd_marital_status#2206] Batched: true, DataFilters: [isnotnull(cd_demo_sk#2204), isnotnull(cd_marital_status#2206)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/customer_demographics], PartitionFilters: [], PushedFilters: [IsNotNull(cd_demo_sk), IsNotNull(cd_marital_status)], ReadSchema: struct<cd_demo_sk:int,cd_marital_status:string>
      :           :     :     :     :     :     :     :     +- Project [p_promo_sk#608]
      :           :     :     :     :     :     :     :        +- Filter isnotnull(p_promo_sk#608)
      :           :     :     :     :     :     :     :           +- FileScan parquet [p_promo_sk#608] Batched: true, DataFilters: [isnotnull(p_promo_sk#608)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/promotion], PartitionFilters: [], PushedFilters: [IsNotNull(p_promo_sk)], ReadSchema: struct<p_promo_sk:int>
      :           :     :     :     :     :     :     +- Project [hd_demo_sk#548, hd_income_band_sk#549]
      :           :     :     :     :     :     :        +- Filter (isnotnull(hd_demo_sk#548) AND isnotnull(hd_income_band_sk#549))
      :           :     :     :     :     :     :           +- FileScan parquet [hd_demo_sk#548,hd_income_band_sk#549] Batched: true, DataFilters: [isnotnull(hd_demo_sk#548), isnotnull(hd_income_band_sk#549)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/household_demographics], PartitionFilters: [], PushedFilters: [IsNotNull(hd_demo_sk), IsNotNull(hd_income_band_sk)], ReadSchema: struct<hd_demo_sk:int,hd_income_band_sk:int>
      :           :     :     :     :     :     +- Project [hd_demo_sk#2213, hd_income_band_sk#2214]
      :           :     :     :     :     :        +- Filter (isnotnull(hd_demo_sk#2213) AND isnotnull(hd_income_band_sk#2214))
      :           :     :     :     :     :           +- FileScan parquet [hd_demo_sk#2213,hd_income_band_sk#2214] Batched: true, DataFilters: [isnotnull(hd_demo_sk#2213), isnotnull(hd_income_band_sk#2214)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/household_demographics], PartitionFilters: [], PushedFilters: [IsNotNull(hd_demo_sk), IsNotNull(hd_income_band_sk)], ReadSchema: struct<hd_demo_sk:int,hd_income_band_sk:int>
      :           :     :     :     :     +- Project [ca_address_sk#448, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457]
      :           :     :     :     :        +- Filter isnotnull(ca_address_sk#448)
      :           :     :     :     :           +- FileScan parquet [ca_address_sk#448,ca_street_number#450,ca_street_name#451,ca_city#454,ca_zip#457] Batched: true, DataFilters: [isnotnull(ca_address_sk#448)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/customer_address], PartitionFilters: [], PushedFilters: [IsNotNull(ca_address_sk)], ReadSchema: struct<ca_address_sk:int,ca_street_number:string,ca_street_name:string,ca_city:string,ca_zip:string>
      :           :     :     :     +- Project [ca_address_sk#2218, ca_street_number#2220, ca_street_name#2221, ca_city#2224, ca_zip#2227]
      :           :     :     :        +- Filter isnotnull(ca_address_sk#2218)
      :           :     :     :           +- FileScan parquet [ca_address_sk#2218,ca_street_number#2220,ca_street_name#2221,ca_city#2224,ca_zip#2227] Batched: true, DataFilters: [isnotnull(ca_address_sk#2218)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/customer_address], PartitionFilters: [], PushedFilters: [IsNotNull(ca_address_sk)], ReadSchema: struct<ca_address_sk:int,ca_street_number:string,ca_street_name:string,ca_city:string,ca_zip:string>
      :           :     :     +- Project [ib_income_band_sk#558]
      :           :     :        +- Filter isnotnull(ib_income_band_sk#558)
      :           :     :           +- FileScan parquet [ib_income_band_sk#558] Batched: true, DataFilters: [isnotnull(ib_income_band_sk#558)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/income_band], PartitionFilters: [], PushedFilters: [IsNotNull(ib_income_band_sk)], ReadSchema: struct<ib_income_band_sk:int>
      :           :     +- Project [ib_income_band_sk#2231]
      :           :        +- Filter isnotnull(ib_income_band_sk#2231)
      :           :           +- FileScan parquet [ib_income_band_sk#2231] Batched: true, DataFilters: [isnotnull(ib_income_band_sk#2231)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/income_band], PartitionFilters: [], PushedFilters: [IsNotNull(ib_income_band_sk)], ReadSchema: struct<ib_income_band_sk:int>
      :           +- Project [i_item_sk#564, i_product_name#585]
      :              +- Filter ((((((isnotnull(i_current_price#569) AND i_color#581 IN (purple,burlywood,indian,spring,floral,medium)) AND (i_current_price#569 >= 64.00)) AND (i_current_price#569 <= 74.00)) AND (i_current_price#569 >= 65.00)) AND (i_current_price#569 <= 79.00)) AND isnotnull(i_item_sk#564))
      :                 +- FileScan parquet [i_item_sk#564,i_current_price#569,i_color#581,i_product_name#585] Batched: true, DataFilters: [isnotnull(i_current_price#569), i_color#581 IN (purple,burlywood,indian,spring,floral,medium), (..., Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/item], PartitionFilters: [], PushedFilters: [IsNotNull(i_current_price), In(i_color, [purple,burlywood,indian,spring,floral,medium]), Greater..., ReadSchema: struct<i_item_sk:int,i_current_price:decimal(7,2),i_color:string,i_product_name:string>
      +- HashAggregate(keys=[i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#2306, ca_street_name#2307, ca_city#2310, ca_zip#2313, d_year#498, d_year#2240, d_year#2268], functions=[count(1), sum(UnscaledValue(ss_wholesale_cost#140)), sum(UnscaledValue(ss_list_price#141)), sum(UnscaledValue(ss_coupon_amt#148))], output=[item_sk#2333, store_name#2334, store_zip#2335, syear#2344, cnt#2347L, s1#2348, s2#2349, s3#2350])
         +- HashAggregate(keys=[i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#2306, ca_street_name#2307, ca_city#2310, ca_zip#2313, d_year#498, d_year#2240, d_year#2268], functions=[partial_count(1), partial_sum(UnscaledValue(ss_wholesale_cost#140)), partial_sum(UnscaledValue(ss_list_price#141)), partial_sum(UnscaledValue(ss_coupon_amt#148))], output=[i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#2306, ca_street_name#2307, ca_city#2310, ca_zip#2313, d_year#498, d_year#2240, d_year#2268, count#2396L, sum#2397L, sum#2398L, sum#2399L])
            +- Project [ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, d_year#2240, d_year#2268, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#2306, ca_street_name#2307, ca_city#2310, ca_zip#2313, i_item_sk#564, i_product_name#585]
               +- BroadcastHashJoin [ss_item_sk#131], [i_item_sk#564], Inner, BuildRight, false
                  :- Project [ss_item_sk#131, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, d_year#2240, d_year#2268, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#2306, ca_street_name#2307, ca_city#2310, ca_zip#2313]
                  :  +- BroadcastHashJoin [hd_income_band_sk#2300], [ib_income_band_sk#2317], Inner, BuildRight, false
                  :     :- Project [ss_item_sk#131, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, d_year#2240, d_year#2268, hd_income_band_sk#2300, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#2306, ca_street_name#2307, ca_city#2310, ca_zip#2313]
                  :     :  +- BroadcastHashJoin [hd_income_band_sk#549], [ib_income_band_sk#558], Inner, BuildRight, false
                  :     :     :- Project [ss_item_sk#131, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, d_year#2240, d_year#2268, hd_income_band_sk#549, hd_income_band_sk#2300, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#2306, ca_street_name#2307, ca_city#2310, ca_zip#2313]
                  :     :     :  +- BroadcastHashJoin [c_current_addr_sk#416], [ca_address_sk#2304], Inner, BuildRight, false
                  :     :     :     :- Project [ss_item_sk#131, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_addr_sk#416, d_year#2240, d_year#2268, hd_income_band_sk#549, hd_income_band_sk#2300, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457]
                  :     :     :     :  +- BroadcastHashJoin [ss_addr_sk#135], [ca_address_sk#448], Inner, BuildRight, false
                  :     :     :     :     :- Project [ss_item_sk#131, ss_addr_sk#135, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_addr_sk#416, d_year#2240, d_year#2268, hd_income_band_sk#549, hd_income_band_sk#2300]
                  :     :     :     :     :  +- BroadcastHashJoin [c_current_hdemo_sk#415], [hd_demo_sk#2299], Inner, BuildRight, false
                  :     :     :     :     :     :- Project [ss_item_sk#131, ss_addr_sk#135, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_hdemo_sk#415, c_current_addr_sk#416, d_year#2240, d_year#2268, hd_income_band_sk#549]
                  :     :     :     :     :     :  +- BroadcastHashJoin [ss_hdemo_sk#134], [hd_demo_sk#548], Inner, BuildRight, false
                  :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_hdemo_sk#134, ss_addr_sk#135, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_hdemo_sk#415, c_current_addr_sk#416, d_year#2240, d_year#2268]
                  :     :     :     :     :     :     :  +- BroadcastHashJoin [ss_promo_sk#137], [p_promo_sk#608], Inner, BuildRight, false
                  :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_hdemo_sk#134, ss_addr_sk#135, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_hdemo_sk#415, c_current_addr_sk#416, d_year#2240, d_year#2268]
                  :     :     :     :     :     :     :     :  +- BroadcastHashJoin [c_current_cdemo_sk#414], [cd_demo_sk#2290], Inner, BuildRight, NOT (cd_marital_status#476 = cd_marital_status#2292), false
                  :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_hdemo_sk#134, ss_addr_sk#135, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_cdemo_sk#414, c_current_hdemo_sk#415, c_current_addr_sk#416, d_year#2240, d_year#2268, cd_marital_status#476]
                  :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [ss_cdemo_sk#133], [cd_demo_sk#474], Inner, BuildRight, false
                  :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_cdemo_sk#414, c_current_hdemo_sk#415, c_current_addr_sk#416, d_year#2240, d_year#2268]
                  :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [c_first_shipto_date_sk#417], [d_date_sk#2262], Inner, BuildRight, false
                  :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_cdemo_sk#414, c_current_hdemo_sk#415, c_current_addr_sk#416, c_first_shipto_date_sk#417, d_year#2240]
                  :     :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [c_first_sales_date_sk#418], [d_date_sk#2234], Inner, BuildRight, false
                  :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_cdemo_sk#414, c_current_hdemo_sk#415, c_current_addr_sk#416, c_first_shipto_date_sk#417, c_first_sales_date_sk#418]
                  :     :     :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [ss_customer_sk#132], [c_customer_sk#412], Inner, BuildRight, false
                  :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_customer_sk#132, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689]
                  :     :     :     :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [ss_store_sk#136], [s_store_sk#664], Inner, BuildRight, false
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_customer_sk#132, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_store_sk#136, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498]
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [ss_sold_date_sk#152], [d_date_sk#492], Inner, BuildRight, false
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_customer_sk#132, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_store_sk#136, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, ss_sold_date_sk#152]
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- SortMergeJoin [ss_item_sk#131], [cs_item_sk#14], Inner
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_customer_sk#132, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_store_sk#136, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, ss_sold_date_sk#152]
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- SortMergeJoin [ss_item_sk#131, ss_ticket_number#138L], [sr_item_sk#177, sr_ticket_number#184L], Inner
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_customer_sk#132, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_store_sk#136, ss_promo_sk#137, ss_ticket_number#138L, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, ss_sold_date_sk#152]
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- Filter (((((((isnotnull(ss_item_sk#131) AND isnotnull(ss_ticket_number#138L)) AND isnotnull(ss_store_sk#136)) AND isnotnull(ss_customer_sk#132)) AND isnotnull(ss_cdemo_sk#133)) AND isnotnull(ss_promo_sk#137)) AND isnotnull(ss_hdemo_sk#134)) AND isnotnull(ss_addr_sk#135))
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- FileScan parquet [ss_item_sk#131,ss_customer_sk#132,ss_cdemo_sk#133,ss_hdemo_sk#134,ss_addr_sk#135,ss_store_sk#136,ss_promo_sk#137,ss_ticket_number#138L,ss_wholesale_cost#140,ss_list_price#141,ss_coupon_amt#148,ss_sold_date_sk#152] Batched: true, DataFilters: [isnotnull(ss_item_sk#131), isnotnull(ss_ticket_number#138L), isnotnull(ss_store_sk#136), isnotnu..., Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/store_sales], PartitionFilters: [isnotnull(ss_sold_date_sk#152), dynamicpruning#2377 [ss_sold_date_sk#152]], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_ticket_number), IsNotNull(ss_store_sk), IsNotNull(ss_custome..., ReadSchema: struct<ss_item_sk:int,ss_customer_sk:int,ss_cdemo_sk:int,ss_hdemo_sk:int,ss_addr_sk:int,ss_store_...
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- Project [d_date_sk#492, d_year#498]
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :              +- Filter ((isnotnull(d_year#498) AND (d_year#498 = 2000)) AND isnotnull(d_date_sk#492))
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                 +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [sr_item_sk#177, sr_ticket_number#184L]
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter (isnotnull(sr_item_sk#177) AND isnotnull(sr_ticket_number#184L))
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- FileScan parquet [sr_item_sk#177,sr_ticket_number#184L,sr_returned_date_sk#195] Batched: true, DataFilters: [isnotnull(sr_item_sk#177), isnotnull(sr_ticket_number#184L)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/store_returns], PartitionFilters: [], PushedFilters: [IsNotNull(sr_item_sk), IsNotNull(sr_ticket_number)], ReadSchema: struct<sr_item_sk:int,sr_ticket_number:bigint>
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [cs_item_sk#14]
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter (isnotnull(sum(cs_ext_list_price#24)#2146) AND (cast(sum(cs_ext_list_price#24)#2146 as decimal(21,2)) > CheckOverflow((2.00 * promote_precision(sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#90 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#91 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#92 as decimal(9,2)))), DecimalType(9,2), true))#2147)), DecimalType(21,2), true)))
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- HashAggregate(keys=[cs_item_sk#14], functions=[sum(UnscaledValue(cs_ext_list_price#24)), sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#90 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#91 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#92 as decimal(9,2)))), DecimalType(9,2), true))], output=[cs_item_sk#14, sum(cs_ext_list_price#24)#2146, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#90 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#91 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#92 as decimal(9,2)))), DecimalType(9,2), true))#2147])
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :              +- HashAggregate(keys=[cs_item_sk#14], functions=[partial_sum(UnscaledValue(cs_ext_list_price#24)), partial_sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#90 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#91 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#92 as decimal(9,2)))), DecimalType(9,2), true))], output=[cs_item_sk#14, sum#2403L, sum#2404, isEmpty#2405])
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                 +- Project [cs_item_sk#14, cs_ext_list_price#24, cr_refunded_cash#90, cr_reversed_charge#91, cr_store_credit#92]
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                    +- SortMergeJoin [cs_item_sk#14, cs_order_number#16L], [cr_item_sk#69, cr_order_number#83L], Inner
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                       :- Project [cs_item_sk#14, cs_order_number#16L, cs_ext_list_price#24]
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                       :  +- Filter (isnotnull(cs_item_sk#14) AND isnotnull(cs_order_number#16L))
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                       :     +- FileScan parquet [cs_item_sk#14,cs_order_number#16L,cs_ext_list_price#24,cs_sold_date_sk#33] Batched: true, DataFilters: [isnotnull(cs_item_sk#14), isnotnull(cs_order_number#16L)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/catalog_sales], PartitionFilters: [], PushedFilters: [IsNotNull(cs_item_sk), IsNotNull(cs_order_number)], ReadSchema: struct<cs_item_sk:int,cs_order_number:bigint,cs_ext_list_price:decimal(7,2)>
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                       +- Project [cr_item_sk#69, cr_order_number#83L, cr_refunded_cash#90, cr_reversed_charge#91, cr_store_credit#92]
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                          +- Filter (isnotnull(cr_item_sk#69) AND isnotnull(cr_order_number#83L))
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                             +- FileScan parquet [cr_item_sk#69,cr_order_number#83L,cr_refunded_cash#90,cr_reversed_charge#91,cr_store_credit#92,cr_returned_date_sk#94] Batched: true, DataFilters: [isnotnull(cr_item_sk#69), isnotnull(cr_order_number#83L)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/catalog_returns], PartitionFilters: [], PushedFilters: [IsNotNull(cr_item_sk), IsNotNull(cr_order_number)], ReadSchema: struct<cr_item_sk:int,cr_order_number:bigint,cr_refunded_cash:decimal(7,2),cr_reversed_charge:dec...
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [d_date_sk#492, d_year#498]
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter ((isnotnull(d_year#498) AND (d_year#498 = 2000)) AND isnotnull(d_date_sk#492))
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- FileScan parquet [d_date_sk#492,d_year#498] Batched: true, DataFilters: [isnotnull(d_year#498), (d_year#498 = 2000), isnotnull(d_date_sk#492)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), EqualTo(d_year,2000), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
                  :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [s_store_sk#664, s_store_name#669, s_zip#689]
                  :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter ((isnotnull(s_store_sk#664) AND isnotnull(s_store_name#669)) AND isnotnull(s_zip#689))
                  :     :     :     :     :     :     :     :     :     :     :     :     :           +- FileScan parquet [s_store_sk#664,s_store_name#669,s_zip#689] Batched: true, DataFilters: [isnotnull(s_store_sk#664), isnotnull(s_store_name#669), isnotnull(s_zip#689)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/store], PartitionFilters: [], PushedFilters: [IsNotNull(s_store_sk), IsNotNull(s_store_name), IsNotNull(s_zip)], ReadSchema: struct<s_store_sk:int,s_store_name:string,s_zip:string>
                  :     :     :     :     :     :     :     :     :     :     :     :     +- Project [c_customer_sk#412, c_current_cdemo_sk#414, c_current_hdemo_sk#415, c_current_addr_sk#416, c_first_shipto_date_sk#417, c_first_sales_date_sk#418]
                  :     :     :     :     :     :     :     :     :     :     :     :        +- Filter (((((isnotnull(c_customer_sk#412) AND isnotnull(c_first_sales_date_sk#418)) AND isnotnull(c_first_shipto_date_sk#417)) AND isnotnull(c_current_cdemo_sk#414)) AND isnotnull(c_current_hdemo_sk#415)) AND isnotnull(c_current_addr_sk#416))
                  :     :     :     :     :     :     :     :     :     :     :     :           +- FileScan parquet [c_customer_sk#412,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418] Batched: true, DataFilters: [isnotnull(c_customer_sk#412), isnotnull(c_first_sales_date_sk#418), isnotnull(c_first_shipto_dat..., Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/customer], PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk), IsNotNull(c_first_sales_date_sk), IsNotNull(c_first_shipto_date_sk), I..., ReadSchema: struct<c_customer_sk:int,c_current_cdemo_sk:int,c_current_hdemo_sk:int,c_current_addr_sk:int,c_fi...
                  :     :     :     :     :     :     :     :     :     :     :     +- Project [d_date_sk#2234, d_year#2240]
                  :     :     :     :     :     :     :     :     :     :     :        +- Filter isnotnull(d_date_sk#2234)
                  :     :     :     :     :     :     :     :     :     :     :           +- FileScan parquet [d_date_sk#2234,d_year#2240] Batched: true, DataFilters: [isnotnull(d_date_sk#2234)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
                  :     :     :     :     :     :     :     :     :     :     +- Project [d_date_sk#2262, d_year#2268]
                  :     :     :     :     :     :     :     :     :     :        +- Filter isnotnull(d_date_sk#2262)
                  :     :     :     :     :     :     :     :     :     :           +- FileScan parquet [d_date_sk#2262,d_year#2268] Batched: true, DataFilters: [isnotnull(d_date_sk#2262)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
                  :     :     :     :     :     :     :     :     :     +- Project [cd_demo_sk#474, cd_marital_status#476]
                  :     :     :     :     :     :     :     :     :        +- Filter (isnotnull(cd_demo_sk#474) AND isnotnull(cd_marital_status#476))
                  :     :     :     :     :     :     :     :     :           +- FileScan parquet [cd_demo_sk#474,cd_marital_status#476] Batched: true, DataFilters: [isnotnull(cd_demo_sk#474), isnotnull(cd_marital_status#476)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/customer_demographics], PartitionFilters: [], PushedFilters: [IsNotNull(cd_demo_sk), IsNotNull(cd_marital_status)], ReadSchema: struct<cd_demo_sk:int,cd_marital_status:string>
                  :     :     :     :     :     :     :     :     +- Project [cd_demo_sk#2290, cd_marital_status#2292]
                  :     :     :     :     :     :     :     :        +- Filter (isnotnull(cd_demo_sk#2290) AND isnotnull(cd_marital_status#2292))
                  :     :     :     :     :     :     :     :           +- FileScan parquet [cd_demo_sk#2290,cd_marital_status#2292] Batched: true, DataFilters: [isnotnull(cd_demo_sk#2290), isnotnull(cd_marital_status#2292)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/customer_demographics], PartitionFilters: [], PushedFilters: [IsNotNull(cd_demo_sk), IsNotNull(cd_marital_status)], ReadSchema: struct<cd_demo_sk:int,cd_marital_status:string>
                  :     :     :     :     :     :     :     +- Project [p_promo_sk#608]
                  :     :     :     :     :     :     :        +- Filter isnotnull(p_promo_sk#608)
                  :     :     :     :     :     :     :           +- FileScan parquet [p_promo_sk#608] Batched: true, DataFilters: [isnotnull(p_promo_sk#608)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/promotion], PartitionFilters: [], PushedFilters: [IsNotNull(p_promo_sk)], ReadSchema: struct<p_promo_sk:int>
                  :     :     :     :     :     :     +- Project [hd_demo_sk#548, hd_income_band_sk#549]
                  :     :     :     :     :     :        +- Filter (isnotnull(hd_demo_sk#548) AND isnotnull(hd_income_band_sk#549))
                  :     :     :     :     :     :           +- FileScan parquet [hd_demo_sk#548,hd_income_band_sk#549] Batched: true, DataFilters: [isnotnull(hd_demo_sk#548), isnotnull(hd_income_band_sk#549)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/household_demographics], PartitionFilters: [], PushedFilters: [IsNotNull(hd_demo_sk), IsNotNull(hd_income_band_sk)], ReadSchema: struct<hd_demo_sk:int,hd_income_band_sk:int>
                  :     :     :     :     :     +- Project [hd_demo_sk#2299, hd_income_band_sk#2300]
                  :     :     :     :     :        +- Filter (isnotnull(hd_demo_sk#2299) AND isnotnull(hd_income_band_sk#2300))
                  :     :     :     :     :           +- FileScan parquet [hd_demo_sk#2299,hd_income_band_sk#2300] Batched: true, DataFilters: [isnotnull(hd_demo_sk#2299), isnotnull(hd_income_band_sk#2300)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/household_demographics], PartitionFilters: [], PushedFilters: [IsNotNull(hd_demo_sk), IsNotNull(hd_income_band_sk)], ReadSchema: struct<hd_demo_sk:int,hd_income_band_sk:int>
                  :     :     :     :     +- Project [ca_address_sk#448, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457]
                  :     :     :     :        +- Filter isnotnull(ca_address_sk#448)
                  :     :     :     :           +- FileScan parquet [ca_address_sk#448,ca_street_number#450,ca_street_name#451,ca_city#454,ca_zip#457] Batched: true, DataFilters: [isnotnull(ca_address_sk#448)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/customer_address], PartitionFilters: [], PushedFilters: [IsNotNull(ca_address_sk)], ReadSchema: struct<ca_address_sk:int,ca_street_number:string,ca_street_name:string,ca_city:string,ca_zip:string>
                  :     :     :     +- Project [ca_address_sk#2304, ca_street_number#2306, ca_street_name#2307, ca_city#2310, ca_zip#2313]
                  :     :     :        +- Filter isnotnull(ca_address_sk#2304)
                  :     :     :           +- FileScan parquet [ca_address_sk#2304,ca_street_number#2306,ca_street_name#2307,ca_city#2310,ca_zip#2313] Batched: true, DataFilters: [isnotnull(ca_address_sk#2304)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/customer_address], PartitionFilters: [], PushedFilters: [IsNotNull(ca_address_sk)], ReadSchema: struct<ca_address_sk:int,ca_street_number:string,ca_street_name:string,ca_city:string,ca_zip:string>
                  :     :     +- Project [ib_income_band_sk#558]
                  :     :        +- Filter isnotnull(ib_income_band_sk#558)
                  :     :           +- FileScan parquet [ib_income_band_sk#558] Batched: true, DataFilters: [isnotnull(ib_income_band_sk#558)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/income_band], PartitionFilters: [], PushedFilters: [IsNotNull(ib_income_band_sk)], ReadSchema: struct<ib_income_band_sk:int>
                  :     +- Project [ib_income_band_sk#2317]
                  :        +- Filter isnotnull(ib_income_band_sk#2317)
                  :           +- FileScan parquet [ib_income_band_sk#2317] Batched: true, DataFilters: [isnotnull(ib_income_band_sk#2317)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/income_band], PartitionFilters: [], PushedFilters: [IsNotNull(ib_income_band_sk)], ReadSchema: struct<ib_income_band_sk:int>
                  +- Project [i_item_sk#564, i_product_name#585]
                     +- Filter ((((((isnotnull(i_current_price#569) AND i_color#581 IN (purple,burlywood,indian,spring,floral,medium)) AND (i_current_price#569 >= 64.00)) AND (i_current_price#569 <= 74.00)) AND (i_current_price#569 >= 65.00)) AND (i_current_price#569 <= 79.00)) AND isnotnull(i_item_sk#564))
                        +- FileScan parquet [i_item_sk#564,i_current_price#569,i_color#581,i_product_name#585] Batched: true, DataFilters: [isnotnull(i_current_price#569), i_color#581 IN (purple,burlywood,indian,spring,floral,medium), (..., Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/item], PartitionFilters: [], PushedFilters: [IsNotNull(i_current_price), In(i_color, [purple,burlywood,indian,spring,floral,medium]), Greater..., ReadSchema: struct<i_item_sk:int,i_current_price:decimal(7,2),i_color:string,i_product_name:string>
.
Execution time: 132.062850862s
Running execution q70-v2.4 iteration: 1, StandardRun=true
2022-09-08 15:15:11,741 WARN adaptive.InsertAdaptiveSparkPlan: spark.sql.adaptive.enabled is enabled but is not supported for query: TakeOrderedAndProject(limit=100, orderBy=[lochierarchy#2707 DESC NULLS LAST,CASE WHEN (lochierarchy#2707 = 0) THEN s_state#2726 END ASC NULLS FIRST,rank_within_parent#2708 ASC NULLS FIRST], output=[total_sum#2706,s_state#2726,s_county#2727,lochierarchy#2707,rank_within_parent#2708])
+- Project [total_sum#2706, s_state#2726, s_county#2727, lochierarchy#2707, rank_within_parent#2708]
   +- Window [rank(_w3#2742) windowspecdefinition(_w1#2740, _w2#2741, _w3#2742 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rank_within_parent#2708], [_w1#2740, _w2#2741], [_w3#2742 DESC NULLS LAST]
      +- HashAggregate(keys=[s_state#2726, s_county#2727, spark_grouping_id#2725L], functions=[sum(UnscaledValue(ss_net_profit#151))], output=[total_sum#2706, s_state#2726, s_county#2727, lochierarchy#2707, _w1#2740, _w2#2741, _w3#2742])
         +- HashAggregate(keys=[s_state#2726, s_county#2727, spark_grouping_id#2725L], functions=[partial_sum(UnscaledValue(ss_net_profit#151))], output=[s_state#2726, s_county#2727, spark_grouping_id#2725L, sum#2767L])
            +- Expand [List(ss_net_profit#151, s_state#688, s_county#687, 0), List(ss_net_profit#151, s_state#688, null, 1), List(ss_net_profit#151, null, null, 3)], [ss_net_profit#151, s_state#2726, s_county#2727, spark_grouping_id#2725L]
               +- Project [ss_net_profit#151, s_state#688, s_county#687]
                  +- BroadcastHashJoin [ss_store_sk#136], [s_store_sk#664], Inner, BuildRight, false
                     :- Project [ss_store_sk#136, ss_net_profit#151]
                     :  +- BroadcastHashJoin [ss_sold_date_sk#152], [d_date_sk#492], Inner, BuildRight, false
                     :     :- Project [ss_store_sk#136, ss_net_profit#151, ss_sold_date_sk#152]
                     :     :  +- Filter isnotnull(ss_store_sk#136)
                     :     :     +- FileScan parquet [ss_store_sk#136,ss_net_profit#151,ss_sold_date_sk#152] Batched: true, DataFilters: [isnotnull(ss_store_sk#136)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/store_sales], PartitionFilters: [isnotnull(ss_sold_date_sk#152), dynamicpruning#2764 [ss_sold_date_sk#152]], PushedFilters: [IsNotNull(ss_store_sk)], ReadSchema: struct<ss_store_sk:int,ss_net_profit:decimal(7,2)>
                     :     :           +- Project [d_date_sk#492]
                     :     :              +- Filter (((isnotnull(d_month_seq#495) AND (d_month_seq#495 >= 1200)) AND (d_month_seq#495 <= 1211)) AND isnotnull(d_date_sk#492))
                     :     :                 +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :     +- Project [d_date_sk#492]
                     :        +- Filter (((isnotnull(d_month_seq#495) AND (d_month_seq#495 >= 1200)) AND (d_month_seq#495 <= 1211)) AND isnotnull(d_date_sk#492))
                     :           +- FileScan parquet [d_date_sk#492,d_month_seq#495] Batched: true, DataFilters: [isnotnull(d_month_seq#495), (d_month_seq#495 >= 1200), (d_month_seq#495 <= 1211), isnotnull(d_da..., Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_month_seq), GreaterThanOrEqual(d_month_seq,1200), LessThanOrEqual(d_month_seq,1211),..., ReadSchema: struct<d_date_sk:int,d_month_seq:int>
                     +- SortMergeJoin [s_state#688], [s_state#2703], LeftSemi
                        :- Project [s_store_sk#664, s_county#687, s_state#688]
                        :  +- Filter isnotnull(s_store_sk#664)
                        :     +- FileScan parquet [s_store_sk#664,s_county#687,s_state#688] Batched: true, DataFilters: [isnotnull(s_store_sk#664)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/store], PartitionFilters: [], PushedFilters: [IsNotNull(s_store_sk)], ReadSchema: struct<s_store_sk:int,s_county:string,s_state:string>
                        +- Project [s_state#2703]
                           +- Filter (isnotnull(ranking#2704) AND (ranking#2704 <= 5))
                              +- Window [rank(_w1#2714) windowspecdefinition(s_state#688, _w1#2714 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS ranking#2704], [s_state#688], [_w1#2714 DESC NULLS LAST]
                                 +- HashAggregate(keys=[s_state#688], functions=[sum(UnscaledValue(ss_net_profit#151))], output=[s_state#2703, s_state#688, _w1#2714])
                                    +- HashAggregate(keys=[s_state#688], functions=[partial_sum(UnscaledValue(ss_net_profit#151))], output=[s_state#688, sum#2769L])
                                       +- Project [ss_net_profit#151, s_state#688]
                                          +- BroadcastHashJoin [ss_sold_date_sk#152], [d_date_sk#492], Inner, BuildRight, false
                                             :- Project [ss_net_profit#151, ss_sold_date_sk#152, s_state#688]
                                             :  +- BroadcastHashJoin [ss_store_sk#136], [s_store_sk#664], Inner, BuildRight, false
                                             :     :- Project [ss_store_sk#136, ss_net_profit#151, ss_sold_date_sk#152]
                                             :     :  +- Filter isnotnull(ss_store_sk#136)
                                             :     :     +- FileScan parquet [ss_store_sk#136,ss_net_profit#151,ss_sold_date_sk#152] Batched: true, DataFilters: [isnotnull(ss_store_sk#136)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/store_sales], PartitionFilters: [isnotnull(ss_sold_date_sk#152), dynamicpruning#2757 [ss_sold_date_sk#152]], PushedFilters: [IsNotNull(ss_store_sk)], ReadSchema: struct<ss_store_sk:int,ss_net_profit:decimal(7,2)>
                                             :     :           +- Project [d_date_sk#492]
                                             :     :              +- Filter (((isnotnull(d_month_seq#495) AND (d_month_seq#495 >= 1200)) AND (d_month_seq#495 <= 1211)) AND isnotnull(d_date_sk#492))
                                             :     :                 +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                                             :     +- Project [s_store_sk#664, s_state#688]
                                             :        +- Filter isnotnull(s_store_sk#664)
                                             :           +- FileScan parquet [s_store_sk#664,s_state#688] Batched: true, DataFilters: [isnotnull(s_store_sk#664)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/store], PartitionFilters: [], PushedFilters: [IsNotNull(s_store_sk)], ReadSchema: struct<s_store_sk:int,s_state:string>
                                             +- Project [d_date_sk#492]
                                                +- Filter (((isnotnull(d_month_seq#495) AND (d_month_seq#495 >= 1200)) AND (d_month_seq#495 <= 1211)) AND isnotnull(d_date_sk#492))
                                                   +- FileScan parquet [d_date_sk#492,d_month_seq#495] Batched: true, DataFilters: [isnotnull(d_month_seq#495), (d_month_seq#495 >= 1200), (d_month_seq#495 <= 1211), isnotnull(d_da..., Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_month_seq), GreaterThanOrEqual(d_month_seq,1200), LessThanOrEqual(d_month_seq,1211),..., ReadSchema: struct<d_date_sk:int,d_month_seq:int>
.
2022-09-08 15:15:11,883 INFO perf.Query: 
== Query: q70-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [lochierarchy#2793 DESC NULLS LAST, CASE WHEN (cast(lochierarchy#2793 as int) = 0) THEN s_state#2812 END ASC NULLS FIRST, rank_within_parent#2794 ASC NULLS FIRST], true
      +- Project [total_sum#2792, s_state#2812, s_county#2813, lochierarchy#2793, rank_within_parent#2794]
         +- Project [total_sum#2792, s_state#2812, s_county#2813, lochierarchy#2793, _w0#2822, _w1#2826, _w2#2827, _w3#2828, rank_within_parent#2794, rank_within_parent#2794]
            +- Window [rank(_w3#2828) windowspecdefinition(_w1#2826, _w2#2827, _w3#2828 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rank_within_parent#2794], [_w1#2826, _w2#2827], [_w3#2828 DESC NULLS LAST]
               +- Aggregate [s_state#2812, s_county#2813, spark_grouping_id#2811L], [sum(ss_net_profit#151) AS total_sum#2792, s_state#2812, s_county#2813, (cast((shiftright(spark_grouping_id#2811L, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#2811L, 0) & 1) as tinyint)) AS lochierarchy#2793, sum(ss_net_profit#151) AS _w0#2822, (cast((shiftright(spark_grouping_id#2811L, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#2811L, 0) & 1) as tinyint)) AS _w1#2826, CASE WHEN (cast(cast((shiftright(spark_grouping_id#2811L, 0) & 1) as tinyint) as int) = 0) THEN s_state#2812 END AS _w2#2827, sum(ss_net_profit#151) AS _w3#2828]
                  +- Expand [List(ss_sold_time_sk#130, ss_item_sk#131, ss_customer_sk#132, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_store_sk#136, ss_promo_sk#137, ss_ticket_number#138L, ss_quantity#139, ss_wholesale_cost#140, ss_list_price#141, ss_sales_price#142, ss_ext_discount_amt#143, ss_ext_sales_price#144, ss_ext_wholesale_cost#145, ss_ext_list_price#146, ss_ext_tax#147, ss_coupon_amt#148, ss_net_paid#149, ss_net_paid_inc_tax#150, ss_net_profit#151, ss_sold_date_sk#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, s_state#2809, s_county#2810, 0), List(ss_sold_time_sk#130, ss_item_sk#131, ss_customer_sk#132, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_store_sk#136, ss_promo_sk#137, ss_ticket_number#138L, ss_quantity#139, ss_wholesale_cost#140, ss_list_price#141, ss_sales_price#142, ss_ext_discount_amt#143, ss_ext_sales_price#144, ss_ext_wholesale_cost#145, ss_ext_list_price#146, ss_ext_tax#147, ss_coupon_amt#148, ss_net_paid#149, ss_net_paid_inc_tax#150, ss_net_profit#151, ss_sold_date_sk#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, s_state#2809, null, 1), List(ss_sold_time_sk#130, ss_item_sk#131, ss_customer_sk#132, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_store_sk#136, ss_promo_sk#137, ss_ticket_number#138L, ss_quantity#139, ss_wholesale_cost#140, ss_list_price#141, ss_sales_price#142, ss_ext_discount_amt#143, ss_ext_sales_price#144, ss_ext_wholesale_cost#145, ss_ext_list_price#146, ss_ext_tax#147, ss_coupon_amt#148, ss_net_paid#149, ss_net_paid_inc_tax#150, ss_net_profit#151, ss_sold_date_sk#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, null, null, 3)], [ss_sold_time_sk#130, ss_item_sk#131, ss_customer_sk#132, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_store_sk#136, ss_promo_sk#137, ss_ticket_number#138L, ss_quantity#139, ss_wholesale_cost#140, ss_list_price#141, ss_sales_price#142, ss_ext_discount_amt#143, ss_ext_sales_price#144, ss_ext_wholesale_cost#145, ss_ext_list_price#146, ss_ext_tax#147, ss_coupon_amt#148, ss_net_paid#149, ss_net_paid_inc_tax#150, ss_net_profit#151, ss_sold_date_sk#152, d_date_sk#492, ... 59 more fields]
                     +- Project [ss_sold_time_sk#130, ss_item_sk#131, ss_customer_sk#132, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_store_sk#136, ss_promo_sk#137, ss_ticket_number#138L, ss_quantity#139, ss_wholesale_cost#140, ss_list_price#141, ss_sales_price#142, ss_ext_discount_amt#143, ss_ext_sales_price#144, ss_ext_wholesale_cost#145, ss_ext_list_price#146, ss_ext_tax#147, ss_coupon_amt#148, ss_net_paid#149, ss_net_paid_inc_tax#150, ss_net_profit#151, ss_sold_date_sk#152, d_date_sk#492, ... 58 more fields]
                        +- Filter ((((d_month_seq#495 >= 1200) AND (d_month_seq#495 <= (1200 + 11))) AND (d_date_sk#492 = ss_sold_date_sk#152)) AND ((s_store_sk#664 = ss_store_sk#136) AND s_state#688 IN (list#2791 [])))
                           :  +- Project [s_state#2789]
                           :     +- Filter (ranking#2790 <= 5)
                           :        +- SubqueryAlias tmp1
                           :           +- Project [s_state#2789, ranking#2790]
                           :              +- Project [s_state#2789, s_state#688, _w1#2800, ranking#2790, ranking#2790]
                           :                 +- Window [rank(_w1#2800) windowspecdefinition(s_state#688, _w1#2800 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS ranking#2790], [s_state#688], [_w1#2800 DESC NULLS LAST]
                           :                    +- Aggregate [s_state#688], [s_state#688 AS s_state#2789, s_state#688, sum(ss_net_profit#151) AS _w1#2800]
                           :                       +- Filter ((((d_month_seq#495 >= 1200) AND (d_month_seq#495 <= (1200 + 11))) AND (d_date_sk#492 = ss_sold_date_sk#152)) AND (s_store_sk#664 = ss_store_sk#136))
                           :                          +- Join Inner
                           :                             :- Join Inner
                           :                             :  :- SubqueryAlias store_sales
                           :                             :  :  +- Relation[ss_sold_time_sk#130,ss_item_sk#131,ss_customer_sk#132,ss_cdemo_sk#133,ss_hdemo_sk#134,ss_addr_sk#135,ss_store_sk#136,ss_promo_sk#137,ss_ticket_number#138L,ss_quantity#139,ss_wholesale_cost#140,ss_list_price#141,ss_sales_price#142,ss_ext_discount_amt#143,ss_ext_sales_price#144,ss_ext_wholesale_cost#145,ss_ext_list_price#146,ss_ext_tax#147,ss_coupon_amt#148,ss_net_paid#149,ss_net_paid_inc_tax#150,ss_net_profit#151,ss_sold_date_sk#152] parquet
                           :                             :  +- SubqueryAlias store
                           :                             :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                           :                             +- SubqueryAlias date_dim
                           :                                +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                           +- Join Inner
                              :- Join Inner
                              :  :- SubqueryAlias store_sales
                              :  :  +- Relation[ss_sold_time_sk#130,ss_item_sk#131,ss_customer_sk#132,ss_cdemo_sk#133,ss_hdemo_sk#134,ss_addr_sk#135,ss_store_sk#136,ss_promo_sk#137,ss_ticket_number#138L,ss_quantity#139,ss_wholesale_cost#140,ss_list_price#141,ss_sales_price#142,ss_ext_discount_amt#143,ss_ext_sales_price#144,ss_ext_wholesale_cost#145,ss_ext_list_price#146,ss_ext_tax#147,ss_coupon_amt#148,ss_net_paid#149,ss_net_paid_inc_tax#150,ss_net_profit#151,ss_sold_date_sk#152] parquet
                              :  +- SubqueryAlias d1
                              :     +- SubqueryAlias date_dim
                              :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                              +- SubqueryAlias store
                                 +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet

     : benchmark
2022-09-08 15:15:11,980 INFO perf.Query: 
== Query: q70-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [lochierarchy#2847 DESC NULLS LAST, CASE WHEN (cast(lochierarchy#2847 as int) = 0) THEN s_state#2866 END ASC NULLS FIRST, rank_within_parent#2848 ASC NULLS FIRST], true
      +- Project [total_sum#2846, s_state#2866, s_county#2867, lochierarchy#2847, rank_within_parent#2848]
         +- Project [total_sum#2846, s_state#2866, s_county#2867, lochierarchy#2847, _w0#2876, _w1#2880, _w2#2881, _w3#2882, rank_within_parent#2848, rank_within_parent#2848]
            +- Window [rank(_w3#2882) windowspecdefinition(_w1#2880, _w2#2881, _w3#2882 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rank_within_parent#2848], [_w1#2880, _w2#2881], [_w3#2882 DESC NULLS LAST]
               +- Aggregate [s_state#2866, s_county#2867, spark_grouping_id#2865L], [sum(ss_net_profit#151) AS total_sum#2846, s_state#2866, s_county#2867, (cast((shiftright(spark_grouping_id#2865L, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#2865L, 0) & 1) as tinyint)) AS lochierarchy#2847, sum(ss_net_profit#151) AS _w0#2876, (cast((shiftright(spark_grouping_id#2865L, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#2865L, 0) & 1) as tinyint)) AS _w1#2880, CASE WHEN (cast(cast((shiftright(spark_grouping_id#2865L, 0) & 1) as tinyint) as int) = 0) THEN s_state#2866 END AS _w2#2881, sum(ss_net_profit#151) AS _w3#2882]
                  +- Expand [List(ss_sold_time_sk#130, ss_item_sk#131, ss_customer_sk#132, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_store_sk#136, ss_promo_sk#137, ss_ticket_number#138L, ss_quantity#139, ss_wholesale_cost#140, ss_list_price#141, ss_sales_price#142, ss_ext_discount_amt#143, ss_ext_sales_price#144, ss_ext_wholesale_cost#145, ss_ext_list_price#146, ss_ext_tax#147, ss_coupon_amt#148, ss_net_paid#149, ss_net_paid_inc_tax#150, ss_net_profit#151, ss_sold_date_sk#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, s_state#2863, s_county#2864, 0), List(ss_sold_time_sk#130, ss_item_sk#131, ss_customer_sk#132, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_store_sk#136, ss_promo_sk#137, ss_ticket_number#138L, ss_quantity#139, ss_wholesale_cost#140, ss_list_price#141, ss_sales_price#142, ss_ext_discount_amt#143, ss_ext_sales_price#144, ss_ext_wholesale_cost#145, ss_ext_list_price#146, ss_ext_tax#147, ss_coupon_amt#148, ss_net_paid#149, ss_net_paid_inc_tax#150, ss_net_profit#151, ss_sold_date_sk#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, s_state#2863, null, 1), List(ss_sold_time_sk#130, ss_item_sk#131, ss_customer_sk#132, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_store_sk#136, ss_promo_sk#137, ss_ticket_number#138L, ss_quantity#139, ss_wholesale_cost#140, ss_list_price#141, ss_sales_price#142, ss_ext_discount_amt#143, ss_ext_sales_price#144, ss_ext_wholesale_cost#145, ss_ext_list_price#146, ss_ext_tax#147, ss_coupon_amt#148, ss_net_paid#149, ss_net_paid_inc_tax#150, ss_net_profit#151, ss_sold_date_sk#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, null, null, 3)], [ss_sold_time_sk#130, ss_item_sk#131, ss_customer_sk#132, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_store_sk#136, ss_promo_sk#137, ss_ticket_number#138L, ss_quantity#139, ss_wholesale_cost#140, ss_list_price#141, ss_sales_price#142, ss_ext_discount_amt#143, ss_ext_sales_price#144, ss_ext_wholesale_cost#145, ss_ext_list_price#146, ss_ext_tax#147, ss_coupon_amt#148, ss_net_paid#149, ss_net_paid_inc_tax#150, ss_net_profit#151, ss_sold_date_sk#152, d_date_sk#492, ... 59 more fields]
                     +- Project [ss_sold_time_sk#130, ss_item_sk#131, ss_customer_sk#132, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_store_sk#136, ss_promo_sk#137, ss_ticket_number#138L, ss_quantity#139, ss_wholesale_cost#140, ss_list_price#141, ss_sales_price#142, ss_ext_discount_amt#143, ss_ext_sales_price#144, ss_ext_wholesale_cost#145, ss_ext_list_price#146, ss_ext_tax#147, ss_coupon_amt#148, ss_net_paid#149, ss_net_paid_inc_tax#150, ss_net_profit#151, ss_sold_date_sk#152, d_date_sk#492, ... 58 more fields]
                        +- Filter ((((d_month_seq#495 >= 1200) AND (d_month_seq#495 <= (1200 + 11))) AND (d_date_sk#492 = ss_sold_date_sk#152)) AND ((s_store_sk#664 = ss_store_sk#136) AND s_state#688 IN (list#2845 [])))
                           :  +- Project [s_state#2843]
                           :     +- Filter (ranking#2844 <= 5)
                           :        +- SubqueryAlias tmp1
                           :           +- Project [s_state#2843, ranking#2844]
                           :              +- Project [s_state#2843, s_state#688, _w1#2854, ranking#2844, ranking#2844]
                           :                 +- Window [rank(_w1#2854) windowspecdefinition(s_state#688, _w1#2854 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS ranking#2844], [s_state#688], [_w1#2854 DESC NULLS LAST]
                           :                    +- Aggregate [s_state#688], [s_state#688 AS s_state#2843, s_state#688, sum(ss_net_profit#151) AS _w1#2854]
                           :                       +- Filter ((((d_month_seq#495 >= 1200) AND (d_month_seq#495 <= (1200 + 11))) AND (d_date_sk#492 = ss_sold_date_sk#152)) AND (s_store_sk#664 = ss_store_sk#136))
                           :                          +- Join Inner
                           :                             :- Join Inner
                           :                             :  :- SubqueryAlias store_sales
                           :                             :  :  +- Relation[ss_sold_time_sk#130,ss_item_sk#131,ss_customer_sk#132,ss_cdemo_sk#133,ss_hdemo_sk#134,ss_addr_sk#135,ss_store_sk#136,ss_promo_sk#137,ss_ticket_number#138L,ss_quantity#139,ss_wholesale_cost#140,ss_list_price#141,ss_sales_price#142,ss_ext_discount_amt#143,ss_ext_sales_price#144,ss_ext_wholesale_cost#145,ss_ext_list_price#146,ss_ext_tax#147,ss_coupon_amt#148,ss_net_paid#149,ss_net_paid_inc_tax#150,ss_net_profit#151,ss_sold_date_sk#152] parquet
                           :                             :  +- SubqueryAlias store
                           :                             :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                           :                             +- SubqueryAlias date_dim
                           :                                +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                           +- Join Inner
                              :- Join Inner
                              :  :- SubqueryAlias store_sales
                              :  :  +- Relation[ss_sold_time_sk#130,ss_item_sk#131,ss_customer_sk#132,ss_cdemo_sk#133,ss_hdemo_sk#134,ss_addr_sk#135,ss_store_sk#136,ss_promo_sk#137,ss_ticket_number#138L,ss_quantity#139,ss_wholesale_cost#140,ss_list_price#141,ss_sales_price#142,ss_ext_discount_amt#143,ss_ext_sales_price#144,ss_ext_wholesale_cost#145,ss_ext_list_price#146,ss_ext_tax#147,ss_coupon_amt#148,ss_net_paid#149,ss_net_paid_inc_tax#150,ss_net_profit#151,ss_sold_date_sk#152] parquet
                              :  +- SubqueryAlias d1
                              :     +- SubqueryAlias date_dim
                              :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                              +- SubqueryAlias store
                                 +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet

      running Thread[benchmark runner,5,main]
2022-09-08 15:15:12,178 WARN adaptive.InsertAdaptiveSparkPlan: spark.sql.adaptive.enabled is enabled but is not supported for query: TakeOrderedAndProject(limit=100, orderBy=[lochierarchy#2901 DESC NULLS LAST,CASE WHEN (lochierarchy#2901 = 0) THEN s_state#2920 END ASC NULLS FIRST,rank_within_parent#2902 ASC NULLS FIRST], output=[total_sum#2900,s_state#2920,s_county#2921,lochierarchy#2901,rank_within_parent#2902])
+- Project [total_sum#2900, s_state#2920, s_county#2921, lochierarchy#2901, rank_within_parent#2902]
   +- Window [rank(_w3#2936) windowspecdefinition(_w1#2934, _w2#2935, _w3#2936 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rank_within_parent#2902], [_w1#2934, _w2#2935], [_w3#2936 DESC NULLS LAST]
      +- HashAggregate(keys=[s_state#2920, s_county#2921, spark_grouping_id#2919L], functions=[sum(UnscaledValue(ss_net_profit#151))], output=[total_sum#2900, s_state#2920, s_county#2921, lochierarchy#2901, _w1#2934, _w2#2935, _w3#2936])
         +- HashAggregate(keys=[s_state#2920, s_county#2921, spark_grouping_id#2919L], functions=[partial_sum(UnscaledValue(ss_net_profit#151))], output=[s_state#2920, s_county#2921, spark_grouping_id#2919L, sum#2961L])
            +- Expand [List(ss_net_profit#151, s_state#688, s_county#687, 0), List(ss_net_profit#151, s_state#688, null, 1), List(ss_net_profit#151, null, null, 3)], [ss_net_profit#151, s_state#2920, s_county#2921, spark_grouping_id#2919L]
               +- Project [ss_net_profit#151, s_state#688, s_county#687]
                  +- BroadcastHashJoin [ss_store_sk#136], [s_store_sk#664], Inner, BuildRight, false
                     :- Project [ss_store_sk#136, ss_net_profit#151]
                     :  +- BroadcastHashJoin [ss_sold_date_sk#152], [d_date_sk#492], Inner, BuildRight, false
                     :     :- Project [ss_store_sk#136, ss_net_profit#151, ss_sold_date_sk#152]
                     :     :  +- Filter isnotnull(ss_store_sk#136)
                     :     :     +- FileScan parquet [ss_store_sk#136,ss_net_profit#151,ss_sold_date_sk#152] Batched: true, DataFilters: [isnotnull(ss_store_sk#136)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/store_sales], PartitionFilters: [isnotnull(ss_sold_date_sk#152), dynamicpruning#2958 [ss_sold_date_sk#152]], PushedFilters: [IsNotNull(ss_store_sk)], ReadSchema: struct<ss_store_sk:int,ss_net_profit:decimal(7,2)>
                     :     :           +- Project [d_date_sk#492]
                     :     :              +- Filter (((isnotnull(d_month_seq#495) AND (d_month_seq#495 >= 1200)) AND (d_month_seq#495 <= 1211)) AND isnotnull(d_date_sk#492))
                     :     :                 +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :     +- Project [d_date_sk#492]
                     :        +- Filter (((isnotnull(d_month_seq#495) AND (d_month_seq#495 >= 1200)) AND (d_month_seq#495 <= 1211)) AND isnotnull(d_date_sk#492))
                     :           +- FileScan parquet [d_date_sk#492,d_month_seq#495] Batched: true, DataFilters: [isnotnull(d_month_seq#495), (d_month_seq#495 >= 1200), (d_month_seq#495 <= 1211), isnotnull(d_da..., Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_month_seq), GreaterThanOrEqual(d_month_seq,1200), LessThanOrEqual(d_month_seq,1211),..., ReadSchema: struct<d_date_sk:int,d_month_seq:int>
                     +- SortMergeJoin [s_state#688], [s_state#2897], LeftSemi
                        :- Project [s_store_sk#664, s_county#687, s_state#688]
                        :  +- Filter isnotnull(s_store_sk#664)
                        :     +- FileScan parquet [s_store_sk#664,s_county#687,s_state#688] Batched: true, DataFilters: [isnotnull(s_store_sk#664)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/store], PartitionFilters: [], PushedFilters: [IsNotNull(s_store_sk)], ReadSchema: struct<s_store_sk:int,s_county:string,s_state:string>
                        +- Project [s_state#2897]
                           +- Filter (isnotnull(ranking#2898) AND (ranking#2898 <= 5))
                              +- Window [rank(_w1#2908) windowspecdefinition(s_state#688, _w1#2908 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS ranking#2898], [s_state#688], [_w1#2908 DESC NULLS LAST]
                                 +- HashAggregate(keys=[s_state#688], functions=[sum(UnscaledValue(ss_net_profit#151))], output=[s_state#2897, s_state#688, _w1#2908])
                                    +- HashAggregate(keys=[s_state#688], functions=[partial_sum(UnscaledValue(ss_net_profit#151))], output=[s_state#688, sum#2963L])
                                       +- Project [ss_net_profit#151, s_state#688]
                                          +- BroadcastHashJoin [ss_sold_date_sk#152], [d_date_sk#492], Inner, BuildRight, false
                                             :- Project [ss_net_profit#151, ss_sold_date_sk#152, s_state#688]
                                             :  +- BroadcastHashJoin [ss_store_sk#136], [s_store_sk#664], Inner, BuildRight, false
                                             :     :- Project [ss_store_sk#136, ss_net_profit#151, ss_sold_date_sk#152]
                                             :     :  +- Filter isnotnull(ss_store_sk#136)
                                             :     :     +- FileScan parquet [ss_store_sk#136,ss_net_profit#151,ss_sold_date_sk#152] Batched: true, DataFilters: [isnotnull(ss_store_sk#136)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/store_sales], PartitionFilters: [isnotnull(ss_sold_date_sk#152), dynamicpruning#2951 [ss_sold_date_sk#152]], PushedFilters: [IsNotNull(ss_store_sk)], ReadSchema: struct<ss_store_sk:int,ss_net_profit:decimal(7,2)>
                                             :     :           +- Project [d_date_sk#492]
                                             :     :              +- Filter (((isnotnull(d_month_seq#495) AND (d_month_seq#495 >= 1200)) AND (d_month_seq#495 <= 1211)) AND isnotnull(d_date_sk#492))
                                             :     :                 +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                                             :     +- Project [s_store_sk#664, s_state#688]
                                             :        +- Filter isnotnull(s_store_sk#664)
                                             :           +- FileScan parquet [s_store_sk#664,s_state#688] Batched: true, DataFilters: [isnotnull(s_store_sk#664)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/store], PartitionFilters: [], PushedFilters: [IsNotNull(s_store_sk)], ReadSchema: struct<s_store_sk:int,s_state:string>
                                             +- Project [d_date_sk#492]
                                                +- Filter (((isnotnull(d_month_seq#495) AND (d_month_seq#495 >= 1200)) AND (d_month_seq#495 <= 1211)) AND isnotnull(d_date_sk#492))
                                                   +- FileScan parquet [d_date_sk#492,d_month_seq#495] Batched: true, DataFilters: [isnotnull(d_month_seq#495), (d_month_seq#495 >= 1200), (d_month_seq#495 <= 1211), isnotnull(d_da..., Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_month_seq), GreaterThanOrEqual(d_month_seq,1200), LessThanOrEqual(d_month_seq,1211),..., ReadSchema: struct<d_date_sk:int,d_month_seq:int>
.
Execution time: 15.216641577s
Running execution q82-v2.4 iteration: 1, StandardRun=true
2022-09-08 15:15:28,242 WARN adaptive.InsertAdaptiveSparkPlan: spark.sql.adaptive.enabled is enabled but is not supported for query: TakeOrderedAndProject(limit=100, orderBy=[i_item_id#565 ASC NULLS FIRST], output=[i_item_id#565,i_item_desc#568,i_current_price#569])
+- HashAggregate(keys=[i_item_id#565, i_item_desc#568, i_current_price#569], functions=[], output=[i_item_id#565, i_item_desc#568, i_current_price#569])
   +- HashAggregate(keys=[i_item_id#565, i_item_desc#568, i_current_price#569], functions=[], output=[i_item_id#565, i_item_desc#568, i_current_price#569])
      +- Project [i_item_id#565, i_item_desc#568, i_current_price#569]
         +- SortMergeJoin [i_item_sk#564], [ss_item_sk#131], Inner
            :- Project [i_item_sk#564, i_item_id#565, i_item_desc#568, i_current_price#569]
            :  +- BroadcastHashJoin [inv_date_sk#125], [d_date_sk#492], Inner, BuildRight, false
            :     :- Project [i_item_sk#564, i_item_id#565, i_item_desc#568, i_current_price#569, inv_date_sk#125]
            :     :  +- BroadcastHashJoin [i_item_sk#564], [inv_item_sk#122], Inner, BuildLeft, false
            :     :     :- Project [i_item_sk#564, i_item_id#565, i_item_desc#568, i_current_price#569]
            :     :     :  +- Filter ((((isnotnull(i_current_price#569) AND (i_current_price#569 >= 62.00)) AND (i_current_price#569 <= 92.00)) AND i_manufact_id#577 IN (129,270,821,423)) AND isnotnull(i_item_sk#564))
            :     :     :     +- FileScan parquet [i_item_sk#564,i_item_id#565,i_item_desc#568,i_current_price#569,i_manufact_id#577] Batched: true, DataFilters: [isnotnull(i_current_price#569), (i_current_price#569 >= 62.00), (i_current_price#569 <= 92.00), ..., Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/item], PartitionFilters: [], PushedFilters: [IsNotNull(i_current_price), GreaterThanOrEqual(i_current_price,62.00), LessThanOrEqual(i_current..., ReadSchema: struct<i_item_sk:int,i_item_id:string,i_item_desc:string,i_current_price:decimal(7,2),i_manufact_...
            :     :     +- Project [inv_item_sk#122, inv_date_sk#125]
            :     :        +- Filter (((isnotnull(inv_quantity_on_hand#124) AND (inv_quantity_on_hand#124 >= 100)) AND (inv_quantity_on_hand#124 <= 500)) AND isnotnull(inv_item_sk#122))
            :     :           +- FileScan parquet [inv_item_sk#122,inv_quantity_on_hand#124,inv_date_sk#125] Batched: true, DataFilters: [isnotnull(inv_quantity_on_hand#124), (inv_quantity_on_hand#124 >= 100), (inv_quantity_on_hand#12..., Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/inventory], PartitionFilters: [isnotnull(inv_date_sk#125), dynamicpruning#3048 [inv_date_sk#125]], PushedFilters: [IsNotNull(inv_quantity_on_hand), GreaterThanOrEqual(inv_quantity_on_hand,100), LessThanOrEqual(i..., ReadSchema: struct<inv_item_sk:int,inv_quantity_on_hand:int>
            :     :                 +- Project [d_date_sk#492]
            :     :                    +- Filter (((isnotnull(d_date#494) AND (d_date#494 >= 11102)) AND (d_date#494 <= 11162)) AND isnotnull(d_date_sk#492))
            :     :                       +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            :     +- Project [d_date_sk#492]
            :        +- Filter (((isnotnull(d_date#494) AND (d_date#494 >= 11102)) AND (d_date#494 <= 11162)) AND isnotnull(d_date_sk#492))
            :           +- FileScan parquet [d_date_sk#492,d_date#494] Batched: true, DataFilters: [isnotnull(d_date#494), (d_date#494 >= 11102), (d_date#494 <= 11162), isnotnull(d_date_sk#492)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_date), GreaterThanOrEqual(d_date,2000-05-25), LessThanOrEqual(d_date,2000-07-24), Is..., ReadSchema: struct<d_date_sk:int,d_date:date>
            +- Project [ss_item_sk#131]
               +- Filter isnotnull(ss_item_sk#131)
                  +- FileScan parquet [ss_item_sk#131,ss_sold_date_sk#152] Batched: true, DataFilters: [isnotnull(ss_item_sk#131)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/store_sales], PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk)], ReadSchema: struct<ss_item_sk:int>
.
2022-09-08 15:15:28,297 INFO perf.Query: 
== Query: q82-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [i_item_id#565 ASC NULLS FIRST], true
      +- Aggregate [i_item_id#565, i_item_desc#568, i_current_price#569], [i_item_id#565, i_item_desc#568, i_current_price#569]
         +- Filter (((((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(62 as decimal(2,0)) as decimal(7,2))) AND (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((62 + 30) as decimal(10,0)) as decimal(12,2)))) AND (inv_item_sk#122 = i_item_sk#564)) AND ((d_date_sk#492 = inv_date_sk#125) AND ((d_date#494 >= cast(2000-05-25 as date)) AND (d_date#494 <= cast(2000-05-25 as date) + 60 days)))) AND ((i_manufact_id#577 IN (129,270,821,423) AND ((inv_quantity_on_hand#124 >= 100) AND (inv_quantity_on_hand#124 <= 500))) AND (ss_item_sk#131 = i_item_sk#564)))
            +- Join Inner
               :- Join Inner
               :  :- Join Inner
               :  :  :- SubqueryAlias item
               :  :  :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  :  +- SubqueryAlias inventory
               :  :     +- Relation[inv_item_sk#122,inv_warehouse_sk#123,inv_quantity_on_hand#124,inv_date_sk#125] parquet
               :  +- SubqueryAlias date_dim
               :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               +- SubqueryAlias store_sales
                  +- Relation[ss_sold_time_sk#130,ss_item_sk#131,ss_customer_sk#132,ss_cdemo_sk#133,ss_hdemo_sk#134,ss_addr_sk#135,ss_store_sk#136,ss_promo_sk#137,ss_ticket_number#138L,ss_quantity#139,ss_wholesale_cost#140,ss_list_price#141,ss_sales_price#142,ss_ext_discount_amt#143,ss_ext_sales_price#144,ss_ext_wholesale_cost#145,ss_ext_list_price#146,ss_ext_tax#147,ss_coupon_amt#148,ss_net_paid#149,ss_net_paid_inc_tax#150,ss_net_profit#151,ss_sold_date_sk#152] parquet

     : benchmark
2022-09-08 15:15:28,333 INFO perf.Query: 
== Query: q82-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [i_item_id#565 ASC NULLS FIRST], true
      +- Aggregate [i_item_id#565, i_item_desc#568, i_current_price#569], [i_item_id#565, i_item_desc#568, i_current_price#569]
         +- Filter (((((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(62 as decimal(2,0)) as decimal(7,2))) AND (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((62 + 30) as decimal(10,0)) as decimal(12,2)))) AND (inv_item_sk#122 = i_item_sk#564)) AND ((d_date_sk#492 = inv_date_sk#125) AND ((d_date#494 >= cast(2000-05-25 as date)) AND (d_date#494 <= cast(2000-05-25 as date) + 60 days)))) AND ((i_manufact_id#577 IN (129,270,821,423) AND ((inv_quantity_on_hand#124 >= 100) AND (inv_quantity_on_hand#124 <= 500))) AND (ss_item_sk#131 = i_item_sk#564)))
            +- Join Inner
               :- Join Inner
               :  :- Join Inner
               :  :  :- SubqueryAlias item
               :  :  :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  :  +- SubqueryAlias inventory
               :  :     +- Relation[inv_item_sk#122,inv_warehouse_sk#123,inv_quantity_on_hand#124,inv_date_sk#125] parquet
               :  +- SubqueryAlias date_dim
               :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               +- SubqueryAlias store_sales
                  +- Relation[ss_sold_time_sk#130,ss_item_sk#131,ss_customer_sk#132,ss_cdemo_sk#133,ss_hdemo_sk#134,ss_addr_sk#135,ss_store_sk#136,ss_promo_sk#137,ss_ticket_number#138L,ss_quantity#139,ss_wholesale_cost#140,ss_list_price#141,ss_sales_price#142,ss_ext_discount_amt#143,ss_ext_sales_price#144,ss_ext_wholesale_cost#145,ss_ext_list_price#146,ss_ext_tax#147,ss_coupon_amt#148,ss_net_paid#149,ss_net_paid_inc_tax#150,ss_net_profit#151,ss_sold_date_sk#152] parquet

      running Thread[benchmark runner,5,main]
2022-09-08 15:15:28,410 WARN adaptive.InsertAdaptiveSparkPlan: spark.sql.adaptive.enabled is enabled but is not supported for query: TakeOrderedAndProject(limit=100, orderBy=[i_item_id#565 ASC NULLS FIRST], output=[i_item_id#565,i_item_desc#568,i_current_price#569])
+- HashAggregate(keys=[i_item_id#565, i_item_desc#568, i_current_price#569], functions=[], output=[i_item_id#565, i_item_desc#568, i_current_price#569])
   +- HashAggregate(keys=[i_item_id#565, i_item_desc#568, i_current_price#569], functions=[], output=[i_item_id#565, i_item_desc#568, i_current_price#569])
      +- Project [i_item_id#565, i_item_desc#568, i_current_price#569]
         +- SortMergeJoin [i_item_sk#564], [ss_item_sk#131], Inner
            :- Project [i_item_sk#564, i_item_id#565, i_item_desc#568, i_current_price#569]
            :  +- BroadcastHashJoin [inv_date_sk#125], [d_date_sk#492], Inner, BuildRight, false
            :     :- Project [i_item_sk#564, i_item_id#565, i_item_desc#568, i_current_price#569, inv_date_sk#125]
            :     :  +- BroadcastHashJoin [i_item_sk#564], [inv_item_sk#122], Inner, BuildLeft, false
            :     :     :- Project [i_item_sk#564, i_item_id#565, i_item_desc#568, i_current_price#569]
            :     :     :  +- Filter ((((isnotnull(i_current_price#569) AND (i_current_price#569 >= 62.00)) AND (i_current_price#569 <= 92.00)) AND i_manufact_id#577 IN (129,270,821,423)) AND isnotnull(i_item_sk#564))
            :     :     :     +- FileScan parquet [i_item_sk#564,i_item_id#565,i_item_desc#568,i_current_price#569,i_manufact_id#577] Batched: true, DataFilters: [isnotnull(i_current_price#569), (i_current_price#569 >= 62.00), (i_current_price#569 <= 92.00), ..., Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/item], PartitionFilters: [], PushedFilters: [IsNotNull(i_current_price), GreaterThanOrEqual(i_current_price,62.00), LessThanOrEqual(i_current..., ReadSchema: struct<i_item_sk:int,i_item_id:string,i_item_desc:string,i_current_price:decimal(7,2),i_manufact_...
            :     :     +- Project [inv_item_sk#122, inv_date_sk#125]
            :     :        +- Filter (((isnotnull(inv_quantity_on_hand#124) AND (inv_quantity_on_hand#124 >= 100)) AND (inv_quantity_on_hand#124 <= 500)) AND isnotnull(inv_item_sk#122))
            :     :           +- FileScan parquet [inv_item_sk#122,inv_quantity_on_hand#124,inv_date_sk#125] Batched: true, DataFilters: [isnotnull(inv_quantity_on_hand#124), (inv_quantity_on_hand#124 >= 100), (inv_quantity_on_hand#12..., Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/inventory], PartitionFilters: [isnotnull(inv_date_sk#125), dynamicpruning#3059 [inv_date_sk#125]], PushedFilters: [IsNotNull(inv_quantity_on_hand), GreaterThanOrEqual(inv_quantity_on_hand,100), LessThanOrEqual(i..., ReadSchema: struct<inv_item_sk:int,inv_quantity_on_hand:int>
            :     :                 +- Project [d_date_sk#492]
            :     :                    +- Filter (((isnotnull(d_date#494) AND (d_date#494 >= 11102)) AND (d_date#494 <= 11162)) AND isnotnull(d_date_sk#492))
            :     :                       +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            :     +- Project [d_date_sk#492]
            :        +- Filter (((isnotnull(d_date#494) AND (d_date#494 >= 11102)) AND (d_date#494 <= 11162)) AND isnotnull(d_date_sk#492))
            :           +- FileScan parquet [d_date_sk#492,d_date#494] Batched: true, DataFilters: [isnotnull(d_date#494), (d_date#494 >= 11102), (d_date#494 <= 11162), isnotnull(d_date_sk#492)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_date), GreaterThanOrEqual(d_date,2000-05-25), LessThanOrEqual(d_date,2000-07-24), Is..., ReadSchema: struct<d_date_sk:int,d_date:date>
            +- Project [ss_item_sk#131]
               +- Filter isnotnull(ss_item_sk#131)
                  +- FileScan parquet [ss_item_sk#131,ss_sold_date_sk#152] Batched: true, DataFilters: [isnotnull(ss_item_sk#131)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/store_sales], PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk)], ReadSchema: struct<ss_item_sk:int>
.
Execution time: 24.67842403s
Running execution q64-v2.4 iteration: 2, StandardRun=true
2022-09-08 15:15:55,031 WARN adaptive.InsertAdaptiveSparkPlan: spark.sql.adaptive.enabled is enabled but is not supported for query: Sort [product_name#3071 ASC NULLS FIRST, store_name#3073 ASC NULLS FIRST, cnt#3305L ASC NULLS FIRST], true, 0
+- Project [product_name#3071, store_name#3073, store_zip#3074, b_street_number#3075, b_streen_name#3076, b_city#3077, b_zip#3078, c_street_number#3079, c_street_name#3080, c_city#3081, c_zip#3082, syear#3083, cnt#3086L, s1#3087, s2#3088, s3#3089, s1#3306, s2#3307, s3#3308, syear#3302, cnt#3305L]
   +- SortMergeJoin [item_sk#3072, store_name#3073, store_zip#3074], [item_sk#3291, store_name#3292, store_zip#3293], Inner, (cnt#3305L <= cnt#3086L)
      :- HashAggregate(keys=[i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#3178, ca_street_name#3179, ca_city#3182, ca_zip#3185, d_year#498, d_year#3112, d_year#3140], functions=[count(1), sum(UnscaledValue(ss_wholesale_cost#140)), sum(UnscaledValue(ss_list_price#141)), sum(UnscaledValue(ss_coupon_amt#148))], output=[product_name#3071, item_sk#3072, store_name#3073, store_zip#3074, b_street_number#3075, b_streen_name#3076, b_city#3077, b_zip#3078, c_street_number#3079, c_street_name#3080, c_city#3081, c_zip#3082, syear#3083, cnt#3086L, s1#3087, s2#3088, s3#3089])
      :  +- HashAggregate(keys=[i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#3178, ca_street_name#3179, ca_city#3182, ca_zip#3185, d_year#498, d_year#3112, d_year#3140], functions=[partial_count(1), partial_sum(UnscaledValue(ss_wholesale_cost#140)), partial_sum(UnscaledValue(ss_list_price#141)), partial_sum(UnscaledValue(ss_coupon_amt#148))], output=[i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#3178, ca_street_name#3179, ca_city#3182, ca_zip#3185, d_year#498, d_year#3112, d_year#3140, count#3340L, sum#3341L, sum#3342L, sum#3343L])
      :     +- Project [ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, d_year#3112, d_year#3140, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#3178, ca_street_name#3179, ca_city#3182, ca_zip#3185, i_item_sk#564, i_product_name#585]
      :        +- BroadcastHashJoin [ss_item_sk#131], [i_item_sk#564], Inner, BuildRight, false
      :           :- Project [ss_item_sk#131, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, d_year#3112, d_year#3140, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#3178, ca_street_name#3179, ca_city#3182, ca_zip#3185]
      :           :  +- BroadcastHashJoin [hd_income_band_sk#3172], [ib_income_band_sk#3189], Inner, BuildRight, false
      :           :     :- Project [ss_item_sk#131, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, d_year#3112, d_year#3140, hd_income_band_sk#3172, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#3178, ca_street_name#3179, ca_city#3182, ca_zip#3185]
      :           :     :  +- BroadcastHashJoin [hd_income_band_sk#549], [ib_income_band_sk#558], Inner, BuildRight, false
      :           :     :     :- Project [ss_item_sk#131, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, d_year#3112, d_year#3140, hd_income_band_sk#549, hd_income_band_sk#3172, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#3178, ca_street_name#3179, ca_city#3182, ca_zip#3185]
      :           :     :     :  +- BroadcastHashJoin [c_current_addr_sk#416], [ca_address_sk#3176], Inner, BuildRight, false
      :           :     :     :     :- Project [ss_item_sk#131, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_addr_sk#416, d_year#3112, d_year#3140, hd_income_band_sk#549, hd_income_band_sk#3172, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457]
      :           :     :     :     :  +- BroadcastHashJoin [ss_addr_sk#135], [ca_address_sk#448], Inner, BuildRight, false
      :           :     :     :     :     :- Project [ss_item_sk#131, ss_addr_sk#135, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_addr_sk#416, d_year#3112, d_year#3140, hd_income_band_sk#549, hd_income_band_sk#3172]
      :           :     :     :     :     :  +- BroadcastHashJoin [c_current_hdemo_sk#415], [hd_demo_sk#3171], Inner, BuildRight, false
      :           :     :     :     :     :     :- Project [ss_item_sk#131, ss_addr_sk#135, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_hdemo_sk#415, c_current_addr_sk#416, d_year#3112, d_year#3140, hd_income_band_sk#549]
      :           :     :     :     :     :     :  +- BroadcastHashJoin [ss_hdemo_sk#134], [hd_demo_sk#548], Inner, BuildRight, false
      :           :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_hdemo_sk#134, ss_addr_sk#135, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_hdemo_sk#415, c_current_addr_sk#416, d_year#3112, d_year#3140]
      :           :     :     :     :     :     :     :  +- BroadcastHashJoin [ss_promo_sk#137], [p_promo_sk#608], Inner, BuildRight, false
      :           :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_hdemo_sk#134, ss_addr_sk#135, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_hdemo_sk#415, c_current_addr_sk#416, d_year#3112, d_year#3140]
      :           :     :     :     :     :     :     :     :  +- BroadcastHashJoin [c_current_cdemo_sk#414], [cd_demo_sk#3162], Inner, BuildRight, NOT (cd_marital_status#476 = cd_marital_status#3164), false
      :           :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_hdemo_sk#134, ss_addr_sk#135, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_cdemo_sk#414, c_current_hdemo_sk#415, c_current_addr_sk#416, d_year#3112, d_year#3140, cd_marital_status#476]
      :           :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [ss_cdemo_sk#133], [cd_demo_sk#474], Inner, BuildRight, false
      :           :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_cdemo_sk#414, c_current_hdemo_sk#415, c_current_addr_sk#416, d_year#3112, d_year#3140]
      :           :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [c_first_shipto_date_sk#417], [d_date_sk#3134], Inner, BuildRight, false
      :           :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_cdemo_sk#414, c_current_hdemo_sk#415, c_current_addr_sk#416, c_first_shipto_date_sk#417, d_year#3112]
      :           :     :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [c_first_sales_date_sk#418], [d_date_sk#3106], Inner, BuildRight, false
      :           :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_cdemo_sk#414, c_current_hdemo_sk#415, c_current_addr_sk#416, c_first_shipto_date_sk#417, c_first_sales_date_sk#418]
      :           :     :     :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [ss_customer_sk#132], [c_customer_sk#412], Inner, BuildRight, false
      :           :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_customer_sk#132, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689]
      :           :     :     :     :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [ss_store_sk#136], [s_store_sk#664], Inner, BuildRight, false
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_customer_sk#132, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_store_sk#136, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498]
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [ss_sold_date_sk#152], [d_date_sk#492], Inner, BuildRight, false
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_customer_sk#132, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_store_sk#136, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, ss_sold_date_sk#152]
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- SortMergeJoin [ss_item_sk#131], [cs_item_sk#14], Inner
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_customer_sk#132, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_store_sk#136, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, ss_sold_date_sk#152]
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- SortMergeJoin [ss_item_sk#131, ss_ticket_number#138L], [sr_item_sk#177, sr_ticket_number#184L], Inner
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_customer_sk#132, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_store_sk#136, ss_promo_sk#137, ss_ticket_number#138L, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, ss_sold_date_sk#152]
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- Filter (((((((isnotnull(ss_item_sk#131) AND isnotnull(ss_ticket_number#138L)) AND isnotnull(ss_store_sk#136)) AND isnotnull(ss_customer_sk#132)) AND isnotnull(ss_cdemo_sk#133)) AND isnotnull(ss_promo_sk#137)) AND isnotnull(ss_hdemo_sk#134)) AND isnotnull(ss_addr_sk#135))
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- FileScan parquet [ss_item_sk#131,ss_customer_sk#132,ss_cdemo_sk#133,ss_hdemo_sk#134,ss_addr_sk#135,ss_store_sk#136,ss_promo_sk#137,ss_ticket_number#138L,ss_wholesale_cost#140,ss_list_price#141,ss_coupon_amt#148,ss_sold_date_sk#152] Batched: true, DataFilters: [isnotnull(ss_item_sk#131), isnotnull(ss_ticket_number#138L), isnotnull(ss_store_sk#136), isnotnu..., Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/store_sales], PartitionFilters: [isnotnull(ss_sold_date_sk#152), dynamicpruning#3334 [ss_sold_date_sk#152]], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_ticket_number), IsNotNull(ss_store_sk), IsNotNull(ss_custome..., ReadSchema: struct<ss_item_sk:int,ss_customer_sk:int,ss_cdemo_sk:int,ss_hdemo_sk:int,ss_addr_sk:int,ss_store_...
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- Project [d_date_sk#492, d_year#498]
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :              +- Filter ((isnotnull(d_year#498) AND (d_year#498 = 1999)) AND isnotnull(d_date_sk#492))
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                 +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [sr_item_sk#177, sr_ticket_number#184L]
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter (isnotnull(sr_item_sk#177) AND isnotnull(sr_ticket_number#184L))
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- FileScan parquet [sr_item_sk#177,sr_ticket_number#184L,sr_returned_date_sk#195] Batched: true, DataFilters: [isnotnull(sr_item_sk#177), isnotnull(sr_ticket_number#184L)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/store_returns], PartitionFilters: [], PushedFilters: [IsNotNull(sr_item_sk), IsNotNull(sr_ticket_number)], ReadSchema: struct<sr_item_sk:int,sr_ticket_number:bigint>
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [cs_item_sk#14]
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter (isnotnull(sum(cs_ext_list_price#24)#3099) AND (cast(sum(cs_ext_list_price#24)#3099 as decimal(21,2)) > CheckOverflow((2.00 * promote_precision(sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#90 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#91 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#92 as decimal(9,2)))), DecimalType(9,2), true))#3100)), DecimalType(21,2), true)))
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- HashAggregate(keys=[cs_item_sk#14], functions=[sum(UnscaledValue(cs_ext_list_price#24)), sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#90 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#91 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#92 as decimal(9,2)))), DecimalType(9,2), true))], output=[cs_item_sk#14, sum(cs_ext_list_price#24)#3099, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#90 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#91 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#92 as decimal(9,2)))), DecimalType(9,2), true))#3100])
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :              +- HashAggregate(keys=[cs_item_sk#14], functions=[partial_sum(UnscaledValue(cs_ext_list_price#24)), partial_sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#90 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#91 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#92 as decimal(9,2)))), DecimalType(9,2), true))], output=[cs_item_sk#14, sum#3347L, sum#3348, isEmpty#3349])
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                 +- Project [cs_item_sk#14, cs_ext_list_price#24, cr_refunded_cash#90, cr_reversed_charge#91, cr_store_credit#92]
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                    +- SortMergeJoin [cs_item_sk#14, cs_order_number#16L], [cr_item_sk#69, cr_order_number#83L], Inner
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                       :- Project [cs_item_sk#14, cs_order_number#16L, cs_ext_list_price#24]
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                       :  +- Filter (isnotnull(cs_item_sk#14) AND isnotnull(cs_order_number#16L))
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                       :     +- FileScan parquet [cs_item_sk#14,cs_order_number#16L,cs_ext_list_price#24,cs_sold_date_sk#33] Batched: true, DataFilters: [isnotnull(cs_item_sk#14), isnotnull(cs_order_number#16L)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/catalog_sales], PartitionFilters: [], PushedFilters: [IsNotNull(cs_item_sk), IsNotNull(cs_order_number)], ReadSchema: struct<cs_item_sk:int,cs_order_number:bigint,cs_ext_list_price:decimal(7,2)>
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                       +- Project [cr_item_sk#69, cr_order_number#83L, cr_refunded_cash#90, cr_reversed_charge#91, cr_store_credit#92]
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                          +- Filter (isnotnull(cr_item_sk#69) AND isnotnull(cr_order_number#83L))
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                             +- FileScan parquet [cr_item_sk#69,cr_order_number#83L,cr_refunded_cash#90,cr_reversed_charge#91,cr_store_credit#92,cr_returned_date_sk#94] Batched: true, DataFilters: [isnotnull(cr_item_sk#69), isnotnull(cr_order_number#83L)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/catalog_returns], PartitionFilters: [], PushedFilters: [IsNotNull(cr_item_sk), IsNotNull(cr_order_number)], ReadSchema: struct<cr_item_sk:int,cr_order_number:bigint,cr_refunded_cash:decimal(7,2),cr_reversed_charge:dec...
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [d_date_sk#492, d_year#498]
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter ((isnotnull(d_year#498) AND (d_year#498 = 1999)) AND isnotnull(d_date_sk#492))
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- FileScan parquet [d_date_sk#492,d_year#498] Batched: true, DataFilters: [isnotnull(d_year#498), (d_year#498 = 1999), isnotnull(d_date_sk#492)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), EqualTo(d_year,1999), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [s_store_sk#664, s_store_name#669, s_zip#689]
      :           :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter ((isnotnull(s_store_sk#664) AND isnotnull(s_store_name#669)) AND isnotnull(s_zip#689))
      :           :     :     :     :     :     :     :     :     :     :     :     :     :           +- FileScan parquet [s_store_sk#664,s_store_name#669,s_zip#689] Batched: true, DataFilters: [isnotnull(s_store_sk#664), isnotnull(s_store_name#669), isnotnull(s_zip#689)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/store], PartitionFilters: [], PushedFilters: [IsNotNull(s_store_sk), IsNotNull(s_store_name), IsNotNull(s_zip)], ReadSchema: struct<s_store_sk:int,s_store_name:string,s_zip:string>
      :           :     :     :     :     :     :     :     :     :     :     :     :     +- Project [c_customer_sk#412, c_current_cdemo_sk#414, c_current_hdemo_sk#415, c_current_addr_sk#416, c_first_shipto_date_sk#417, c_first_sales_date_sk#418]
      :           :     :     :     :     :     :     :     :     :     :     :     :        +- Filter (((((isnotnull(c_customer_sk#412) AND isnotnull(c_first_sales_date_sk#418)) AND isnotnull(c_first_shipto_date_sk#417)) AND isnotnull(c_current_cdemo_sk#414)) AND isnotnull(c_current_hdemo_sk#415)) AND isnotnull(c_current_addr_sk#416))
      :           :     :     :     :     :     :     :     :     :     :     :     :           +- FileScan parquet [c_customer_sk#412,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418] Batched: true, DataFilters: [isnotnull(c_customer_sk#412), isnotnull(c_first_sales_date_sk#418), isnotnull(c_first_shipto_dat..., Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/customer], PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk), IsNotNull(c_first_sales_date_sk), IsNotNull(c_first_shipto_date_sk), I..., ReadSchema: struct<c_customer_sk:int,c_current_cdemo_sk:int,c_current_hdemo_sk:int,c_current_addr_sk:int,c_fi...
      :           :     :     :     :     :     :     :     :     :     :     :     +- Project [d_date_sk#3106, d_year#3112]
      :           :     :     :     :     :     :     :     :     :     :     :        +- Filter isnotnull(d_date_sk#3106)
      :           :     :     :     :     :     :     :     :     :     :     :           +- FileScan parquet [d_date_sk#3106,d_year#3112] Batched: true, DataFilters: [isnotnull(d_date_sk#3106)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
      :           :     :     :     :     :     :     :     :     :     :     +- Project [d_date_sk#3134, d_year#3140]
      :           :     :     :     :     :     :     :     :     :     :        +- Filter isnotnull(d_date_sk#3134)
      :           :     :     :     :     :     :     :     :     :     :           +- FileScan parquet [d_date_sk#3134,d_year#3140] Batched: true, DataFilters: [isnotnull(d_date_sk#3134)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
      :           :     :     :     :     :     :     :     :     :     +- Project [cd_demo_sk#474, cd_marital_status#476]
      :           :     :     :     :     :     :     :     :     :        +- Filter (isnotnull(cd_demo_sk#474) AND isnotnull(cd_marital_status#476))
      :           :     :     :     :     :     :     :     :     :           +- FileScan parquet [cd_demo_sk#474,cd_marital_status#476] Batched: true, DataFilters: [isnotnull(cd_demo_sk#474), isnotnull(cd_marital_status#476)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/customer_demographics], PartitionFilters: [], PushedFilters: [IsNotNull(cd_demo_sk), IsNotNull(cd_marital_status)], ReadSchema: struct<cd_demo_sk:int,cd_marital_status:string>
      :           :     :     :     :     :     :     :     :     +- Project [cd_demo_sk#3162, cd_marital_status#3164]
      :           :     :     :     :     :     :     :     :        +- Filter (isnotnull(cd_demo_sk#3162) AND isnotnull(cd_marital_status#3164))
      :           :     :     :     :     :     :     :     :           +- FileScan parquet [cd_demo_sk#3162,cd_marital_status#3164] Batched: true, DataFilters: [isnotnull(cd_demo_sk#3162), isnotnull(cd_marital_status#3164)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/customer_demographics], PartitionFilters: [], PushedFilters: [IsNotNull(cd_demo_sk), IsNotNull(cd_marital_status)], ReadSchema: struct<cd_demo_sk:int,cd_marital_status:string>
      :           :     :     :     :     :     :     :     +- Project [p_promo_sk#608]
      :           :     :     :     :     :     :     :        +- Filter isnotnull(p_promo_sk#608)
      :           :     :     :     :     :     :     :           +- FileScan parquet [p_promo_sk#608] Batched: true, DataFilters: [isnotnull(p_promo_sk#608)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/promotion], PartitionFilters: [], PushedFilters: [IsNotNull(p_promo_sk)], ReadSchema: struct<p_promo_sk:int>
      :           :     :     :     :     :     :     +- Project [hd_demo_sk#548, hd_income_band_sk#549]
      :           :     :     :     :     :     :        +- Filter (isnotnull(hd_demo_sk#548) AND isnotnull(hd_income_band_sk#549))
      :           :     :     :     :     :     :           +- FileScan parquet [hd_demo_sk#548,hd_income_band_sk#549] Batched: true, DataFilters: [isnotnull(hd_demo_sk#548), isnotnull(hd_income_band_sk#549)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/household_demographics], PartitionFilters: [], PushedFilters: [IsNotNull(hd_demo_sk), IsNotNull(hd_income_band_sk)], ReadSchema: struct<hd_demo_sk:int,hd_income_band_sk:int>
      :           :     :     :     :     :     +- Project [hd_demo_sk#3171, hd_income_band_sk#3172]
      :           :     :     :     :     :        +- Filter (isnotnull(hd_demo_sk#3171) AND isnotnull(hd_income_band_sk#3172))
      :           :     :     :     :     :           +- FileScan parquet [hd_demo_sk#3171,hd_income_band_sk#3172] Batched: true, DataFilters: [isnotnull(hd_demo_sk#3171), isnotnull(hd_income_band_sk#3172)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/household_demographics], PartitionFilters: [], PushedFilters: [IsNotNull(hd_demo_sk), IsNotNull(hd_income_band_sk)], ReadSchema: struct<hd_demo_sk:int,hd_income_band_sk:int>
      :           :     :     :     :     +- Project [ca_address_sk#448, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457]
      :           :     :     :     :        +- Filter isnotnull(ca_address_sk#448)
      :           :     :     :     :           +- FileScan parquet [ca_address_sk#448,ca_street_number#450,ca_street_name#451,ca_city#454,ca_zip#457] Batched: true, DataFilters: [isnotnull(ca_address_sk#448)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/customer_address], PartitionFilters: [], PushedFilters: [IsNotNull(ca_address_sk)], ReadSchema: struct<ca_address_sk:int,ca_street_number:string,ca_street_name:string,ca_city:string,ca_zip:string>
      :           :     :     :     +- Project [ca_address_sk#3176, ca_street_number#3178, ca_street_name#3179, ca_city#3182, ca_zip#3185]
      :           :     :     :        +- Filter isnotnull(ca_address_sk#3176)
      :           :     :     :           +- FileScan parquet [ca_address_sk#3176,ca_street_number#3178,ca_street_name#3179,ca_city#3182,ca_zip#3185] Batched: true, DataFilters: [isnotnull(ca_address_sk#3176)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/customer_address], PartitionFilters: [], PushedFilters: [IsNotNull(ca_address_sk)], ReadSchema: struct<ca_address_sk:int,ca_street_number:string,ca_street_name:string,ca_city:string,ca_zip:string>
      :           :     :     +- Project [ib_income_band_sk#558]
      :           :     :        +- Filter isnotnull(ib_income_band_sk#558)
      :           :     :           +- FileScan parquet [ib_income_band_sk#558] Batched: true, DataFilters: [isnotnull(ib_income_band_sk#558)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/income_band], PartitionFilters: [], PushedFilters: [IsNotNull(ib_income_band_sk)], ReadSchema: struct<ib_income_band_sk:int>
      :           :     +- Project [ib_income_band_sk#3189]
      :           :        +- Filter isnotnull(ib_income_band_sk#3189)
      :           :           +- FileScan parquet [ib_income_band_sk#3189] Batched: true, DataFilters: [isnotnull(ib_income_band_sk#3189)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/income_band], PartitionFilters: [], PushedFilters: [IsNotNull(ib_income_band_sk)], ReadSchema: struct<ib_income_band_sk:int>
      :           +- Project [i_item_sk#564, i_product_name#585]
      :              +- Filter ((((((isnotnull(i_current_price#569) AND i_color#581 IN (purple,burlywood,indian,spring,floral,medium)) AND (i_current_price#569 >= 64.00)) AND (i_current_price#569 <= 74.00)) AND (i_current_price#569 >= 65.00)) AND (i_current_price#569 <= 79.00)) AND isnotnull(i_item_sk#564))
      :                 +- FileScan parquet [i_item_sk#564,i_current_price#569,i_color#581,i_product_name#585] Batched: true, DataFilters: [isnotnull(i_current_price#569), i_color#581 IN (purple,burlywood,indian,spring,floral,medium), (..., Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/item], PartitionFilters: [], PushedFilters: [IsNotNull(i_current_price), In(i_color, [purple,burlywood,indian,spring,floral,medium]), Greater..., ReadSchema: struct<i_item_sk:int,i_current_price:decimal(7,2),i_color:string,i_product_name:string>
      +- HashAggregate(keys=[i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#3264, ca_street_name#3265, ca_city#3268, ca_zip#3271, d_year#498, d_year#3198, d_year#3226], functions=[count(1), sum(UnscaledValue(ss_wholesale_cost#140)), sum(UnscaledValue(ss_list_price#141)), sum(UnscaledValue(ss_coupon_amt#148))], output=[item_sk#3291, store_name#3292, store_zip#3293, syear#3302, cnt#3305L, s1#3306, s2#3307, s3#3308])
         +- HashAggregate(keys=[i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#3264, ca_street_name#3265, ca_city#3268, ca_zip#3271, d_year#498, d_year#3198, d_year#3226], functions=[partial_count(1), partial_sum(UnscaledValue(ss_wholesale_cost#140)), partial_sum(UnscaledValue(ss_list_price#141)), partial_sum(UnscaledValue(ss_coupon_amt#148))], output=[i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#3264, ca_street_name#3265, ca_city#3268, ca_zip#3271, d_year#498, d_year#3198, d_year#3226, count#3354L, sum#3355L, sum#3356L, sum#3357L])
            +- Project [ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, d_year#3198, d_year#3226, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#3264, ca_street_name#3265, ca_city#3268, ca_zip#3271, i_item_sk#564, i_product_name#585]
               +- BroadcastHashJoin [ss_item_sk#131], [i_item_sk#564], Inner, BuildRight, false
                  :- Project [ss_item_sk#131, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, d_year#3198, d_year#3226, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#3264, ca_street_name#3265, ca_city#3268, ca_zip#3271]
                  :  +- BroadcastHashJoin [hd_income_band_sk#3258], [ib_income_band_sk#3275], Inner, BuildRight, false
                  :     :- Project [ss_item_sk#131, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, d_year#3198, d_year#3226, hd_income_band_sk#3258, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#3264, ca_street_name#3265, ca_city#3268, ca_zip#3271]
                  :     :  +- BroadcastHashJoin [hd_income_band_sk#549], [ib_income_band_sk#558], Inner, BuildRight, false
                  :     :     :- Project [ss_item_sk#131, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, d_year#3198, d_year#3226, hd_income_band_sk#549, hd_income_band_sk#3258, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#3264, ca_street_name#3265, ca_city#3268, ca_zip#3271]
                  :     :     :  +- BroadcastHashJoin [c_current_addr_sk#416], [ca_address_sk#3262], Inner, BuildRight, false
                  :     :     :     :- Project [ss_item_sk#131, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_addr_sk#416, d_year#3198, d_year#3226, hd_income_band_sk#549, hd_income_band_sk#3258, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457]
                  :     :     :     :  +- BroadcastHashJoin [ss_addr_sk#135], [ca_address_sk#448], Inner, BuildRight, false
                  :     :     :     :     :- Project [ss_item_sk#131, ss_addr_sk#135, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_addr_sk#416, d_year#3198, d_year#3226, hd_income_band_sk#549, hd_income_band_sk#3258]
                  :     :     :     :     :  +- BroadcastHashJoin [c_current_hdemo_sk#415], [hd_demo_sk#3257], Inner, BuildRight, false
                  :     :     :     :     :     :- Project [ss_item_sk#131, ss_addr_sk#135, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_hdemo_sk#415, c_current_addr_sk#416, d_year#3198, d_year#3226, hd_income_band_sk#549]
                  :     :     :     :     :     :  +- BroadcastHashJoin [ss_hdemo_sk#134], [hd_demo_sk#548], Inner, BuildRight, false
                  :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_hdemo_sk#134, ss_addr_sk#135, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_hdemo_sk#415, c_current_addr_sk#416, d_year#3198, d_year#3226]
                  :     :     :     :     :     :     :  +- BroadcastHashJoin [ss_promo_sk#137], [p_promo_sk#608], Inner, BuildRight, false
                  :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_hdemo_sk#134, ss_addr_sk#135, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_hdemo_sk#415, c_current_addr_sk#416, d_year#3198, d_year#3226]
                  :     :     :     :     :     :     :     :  +- BroadcastHashJoin [c_current_cdemo_sk#414], [cd_demo_sk#3248], Inner, BuildRight, NOT (cd_marital_status#476 = cd_marital_status#3250), false
                  :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_hdemo_sk#134, ss_addr_sk#135, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_cdemo_sk#414, c_current_hdemo_sk#415, c_current_addr_sk#416, d_year#3198, d_year#3226, cd_marital_status#476]
                  :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [ss_cdemo_sk#133], [cd_demo_sk#474], Inner, BuildRight, false
                  :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_cdemo_sk#414, c_current_hdemo_sk#415, c_current_addr_sk#416, d_year#3198, d_year#3226]
                  :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [c_first_shipto_date_sk#417], [d_date_sk#3220], Inner, BuildRight, false
                  :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_cdemo_sk#414, c_current_hdemo_sk#415, c_current_addr_sk#416, c_first_shipto_date_sk#417, d_year#3198]
                  :     :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [c_first_sales_date_sk#418], [d_date_sk#3192], Inner, BuildRight, false
                  :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_cdemo_sk#414, c_current_hdemo_sk#415, c_current_addr_sk#416, c_first_shipto_date_sk#417, c_first_sales_date_sk#418]
                  :     :     :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [ss_customer_sk#132], [c_customer_sk#412], Inner, BuildRight, false
                  :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_customer_sk#132, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689]
                  :     :     :     :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [ss_store_sk#136], [s_store_sk#664], Inner, BuildRight, false
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_customer_sk#132, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_store_sk#136, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498]
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [ss_sold_date_sk#152], [d_date_sk#492], Inner, BuildRight, false
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_customer_sk#132, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_store_sk#136, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, ss_sold_date_sk#152]
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- SortMergeJoin [ss_item_sk#131], [cs_item_sk#14], Inner
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_customer_sk#132, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_store_sk#136, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, ss_sold_date_sk#152]
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- SortMergeJoin [ss_item_sk#131, ss_ticket_number#138L], [sr_item_sk#177, sr_ticket_number#184L], Inner
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_customer_sk#132, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_store_sk#136, ss_promo_sk#137, ss_ticket_number#138L, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, ss_sold_date_sk#152]
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- Filter (((((((isnotnull(ss_item_sk#131) AND isnotnull(ss_ticket_number#138L)) AND isnotnull(ss_store_sk#136)) AND isnotnull(ss_customer_sk#132)) AND isnotnull(ss_cdemo_sk#133)) AND isnotnull(ss_promo_sk#137)) AND isnotnull(ss_hdemo_sk#134)) AND isnotnull(ss_addr_sk#135))
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- FileScan parquet [ss_item_sk#131,ss_customer_sk#132,ss_cdemo_sk#133,ss_hdemo_sk#134,ss_addr_sk#135,ss_store_sk#136,ss_promo_sk#137,ss_ticket_number#138L,ss_wholesale_cost#140,ss_list_price#141,ss_coupon_amt#148,ss_sold_date_sk#152] Batched: true, DataFilters: [isnotnull(ss_item_sk#131), isnotnull(ss_ticket_number#138L), isnotnull(ss_store_sk#136), isnotnu..., Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/store_sales], PartitionFilters: [isnotnull(ss_sold_date_sk#152), dynamicpruning#3335 [ss_sold_date_sk#152]], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_ticket_number), IsNotNull(ss_store_sk), IsNotNull(ss_custome..., ReadSchema: struct<ss_item_sk:int,ss_customer_sk:int,ss_cdemo_sk:int,ss_hdemo_sk:int,ss_addr_sk:int,ss_store_...
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- Project [d_date_sk#492, d_year#498]
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :              +- Filter ((isnotnull(d_year#498) AND (d_year#498 = 2000)) AND isnotnull(d_date_sk#492))
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                 +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [sr_item_sk#177, sr_ticket_number#184L]
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter (isnotnull(sr_item_sk#177) AND isnotnull(sr_ticket_number#184L))
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- FileScan parquet [sr_item_sk#177,sr_ticket_number#184L,sr_returned_date_sk#195] Batched: true, DataFilters: [isnotnull(sr_item_sk#177), isnotnull(sr_ticket_number#184L)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/store_returns], PartitionFilters: [], PushedFilters: [IsNotNull(sr_item_sk), IsNotNull(sr_ticket_number)], ReadSchema: struct<sr_item_sk:int,sr_ticket_number:bigint>
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [cs_item_sk#14]
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter (isnotnull(sum(cs_ext_list_price#24)#3104) AND (cast(sum(cs_ext_list_price#24)#3104 as decimal(21,2)) > CheckOverflow((2.00 * promote_precision(sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#90 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#91 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#92 as decimal(9,2)))), DecimalType(9,2), true))#3105)), DecimalType(21,2), true)))
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- HashAggregate(keys=[cs_item_sk#14], functions=[sum(UnscaledValue(cs_ext_list_price#24)), sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#90 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#91 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#92 as decimal(9,2)))), DecimalType(9,2), true))], output=[cs_item_sk#14, sum(cs_ext_list_price#24)#3104, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#90 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#91 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#92 as decimal(9,2)))), DecimalType(9,2), true))#3105])
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :              +- HashAggregate(keys=[cs_item_sk#14], functions=[partial_sum(UnscaledValue(cs_ext_list_price#24)), partial_sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#90 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#91 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#92 as decimal(9,2)))), DecimalType(9,2), true))], output=[cs_item_sk#14, sum#3361L, sum#3362, isEmpty#3363])
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                 +- Project [cs_item_sk#14, cs_ext_list_price#24, cr_refunded_cash#90, cr_reversed_charge#91, cr_store_credit#92]
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                    +- SortMergeJoin [cs_item_sk#14, cs_order_number#16L], [cr_item_sk#69, cr_order_number#83L], Inner
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                       :- Project [cs_item_sk#14, cs_order_number#16L, cs_ext_list_price#24]
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                       :  +- Filter (isnotnull(cs_item_sk#14) AND isnotnull(cs_order_number#16L))
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                       :     +- FileScan parquet [cs_item_sk#14,cs_order_number#16L,cs_ext_list_price#24,cs_sold_date_sk#33] Batched: true, DataFilters: [isnotnull(cs_item_sk#14), isnotnull(cs_order_number#16L)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/catalog_sales], PartitionFilters: [], PushedFilters: [IsNotNull(cs_item_sk), IsNotNull(cs_order_number)], ReadSchema: struct<cs_item_sk:int,cs_order_number:bigint,cs_ext_list_price:decimal(7,2)>
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                       +- Project [cr_item_sk#69, cr_order_number#83L, cr_refunded_cash#90, cr_reversed_charge#91, cr_store_credit#92]
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                          +- Filter (isnotnull(cr_item_sk#69) AND isnotnull(cr_order_number#83L))
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                             +- FileScan parquet [cr_item_sk#69,cr_order_number#83L,cr_refunded_cash#90,cr_reversed_charge#91,cr_store_credit#92,cr_returned_date_sk#94] Batched: true, DataFilters: [isnotnull(cr_item_sk#69), isnotnull(cr_order_number#83L)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/catalog_returns], PartitionFilters: [], PushedFilters: [IsNotNull(cr_item_sk), IsNotNull(cr_order_number)], ReadSchema: struct<cr_item_sk:int,cr_order_number:bigint,cr_refunded_cash:decimal(7,2),cr_reversed_charge:dec...
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [d_date_sk#492, d_year#498]
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter ((isnotnull(d_year#498) AND (d_year#498 = 2000)) AND isnotnull(d_date_sk#492))
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- FileScan parquet [d_date_sk#492,d_year#498] Batched: true, DataFilters: [isnotnull(d_year#498), (d_year#498 = 2000), isnotnull(d_date_sk#492)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), EqualTo(d_year,2000), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
                  :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [s_store_sk#664, s_store_name#669, s_zip#689]
                  :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter ((isnotnull(s_store_sk#664) AND isnotnull(s_store_name#669)) AND isnotnull(s_zip#689))
                  :     :     :     :     :     :     :     :     :     :     :     :     :           +- FileScan parquet [s_store_sk#664,s_store_name#669,s_zip#689] Batched: true, DataFilters: [isnotnull(s_store_sk#664), isnotnull(s_store_name#669), isnotnull(s_zip#689)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/store], PartitionFilters: [], PushedFilters: [IsNotNull(s_store_sk), IsNotNull(s_store_name), IsNotNull(s_zip)], ReadSchema: struct<s_store_sk:int,s_store_name:string,s_zip:string>
                  :     :     :     :     :     :     :     :     :     :     :     :     +- Project [c_customer_sk#412, c_current_cdemo_sk#414, c_current_hdemo_sk#415, c_current_addr_sk#416, c_first_shipto_date_sk#417, c_first_sales_date_sk#418]
                  :     :     :     :     :     :     :     :     :     :     :     :        +- Filter (((((isnotnull(c_customer_sk#412) AND isnotnull(c_first_sales_date_sk#418)) AND isnotnull(c_first_shipto_date_sk#417)) AND isnotnull(c_current_cdemo_sk#414)) AND isnotnull(c_current_hdemo_sk#415)) AND isnotnull(c_current_addr_sk#416))
                  :     :     :     :     :     :     :     :     :     :     :     :           +- FileScan parquet [c_customer_sk#412,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418] Batched: true, DataFilters: [isnotnull(c_customer_sk#412), isnotnull(c_first_sales_date_sk#418), isnotnull(c_first_shipto_dat..., Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/customer], PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk), IsNotNull(c_first_sales_date_sk), IsNotNull(c_first_shipto_date_sk), I..., ReadSchema: struct<c_customer_sk:int,c_current_cdemo_sk:int,c_current_hdemo_sk:int,c_current_addr_sk:int,c_fi...
                  :     :     :     :     :     :     :     :     :     :     :     +- Project [d_date_sk#3192, d_year#3198]
                  :     :     :     :     :     :     :     :     :     :     :        +- Filter isnotnull(d_date_sk#3192)
                  :     :     :     :     :     :     :     :     :     :     :           +- FileScan parquet [d_date_sk#3192,d_year#3198] Batched: true, DataFilters: [isnotnull(d_date_sk#3192)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
                  :     :     :     :     :     :     :     :     :     :     +- Project [d_date_sk#3220, d_year#3226]
                  :     :     :     :     :     :     :     :     :     :        +- Filter isnotnull(d_date_sk#3220)
                  :     :     :     :     :     :     :     :     :     :           +- FileScan parquet [d_date_sk#3220,d_year#3226] Batched: true, DataFilters: [isnotnull(d_date_sk#3220)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
                  :     :     :     :     :     :     :     :     :     +- Project [cd_demo_sk#474, cd_marital_status#476]
                  :     :     :     :     :     :     :     :     :        +- Filter (isnotnull(cd_demo_sk#474) AND isnotnull(cd_marital_status#476))
                  :     :     :     :     :     :     :     :     :           +- FileScan parquet [cd_demo_sk#474,cd_marital_status#476] Batched: true, DataFilters: [isnotnull(cd_demo_sk#474), isnotnull(cd_marital_status#476)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/customer_demographics], PartitionFilters: [], PushedFilters: [IsNotNull(cd_demo_sk), IsNotNull(cd_marital_status)], ReadSchema: struct<cd_demo_sk:int,cd_marital_status:string>
                  :     :     :     :     :     :     :     :     +- Project [cd_demo_sk#3248, cd_marital_status#3250]
                  :     :     :     :     :     :     :     :        +- Filter (isnotnull(cd_demo_sk#3248) AND isnotnull(cd_marital_status#3250))
                  :     :     :     :     :     :     :     :           +- FileScan parquet [cd_demo_sk#3248,cd_marital_status#3250] Batched: true, DataFilters: [isnotnull(cd_demo_sk#3248), isnotnull(cd_marital_status#3250)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/customer_demographics], PartitionFilters: [], PushedFilters: [IsNotNull(cd_demo_sk), IsNotNull(cd_marital_status)], ReadSchema: struct<cd_demo_sk:int,cd_marital_status:string>
                  :     :     :     :     :     :     :     +- Project [p_promo_sk#608]
                  :     :     :     :     :     :     :        +- Filter isnotnull(p_promo_sk#608)
                  :     :     :     :     :     :     :           +- FileScan parquet [p_promo_sk#608] Batched: true, DataFilters: [isnotnull(p_promo_sk#608)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/promotion], PartitionFilters: [], PushedFilters: [IsNotNull(p_promo_sk)], ReadSchema: struct<p_promo_sk:int>
                  :     :     :     :     :     :     +- Project [hd_demo_sk#548, hd_income_band_sk#549]
                  :     :     :     :     :     :        +- Filter (isnotnull(hd_demo_sk#548) AND isnotnull(hd_income_band_sk#549))
                  :     :     :     :     :     :           +- FileScan parquet [hd_demo_sk#548,hd_income_band_sk#549] Batched: true, DataFilters: [isnotnull(hd_demo_sk#548), isnotnull(hd_income_band_sk#549)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/household_demographics], PartitionFilters: [], PushedFilters: [IsNotNull(hd_demo_sk), IsNotNull(hd_income_band_sk)], ReadSchema: struct<hd_demo_sk:int,hd_income_band_sk:int>
                  :     :     :     :     :     +- Project [hd_demo_sk#3257, hd_income_band_sk#3258]
                  :     :     :     :     :        +- Filter (isnotnull(hd_demo_sk#3257) AND isnotnull(hd_income_band_sk#3258))
                  :     :     :     :     :           +- FileScan parquet [hd_demo_sk#3257,hd_income_band_sk#3258] Batched: true, DataFilters: [isnotnull(hd_demo_sk#3257), isnotnull(hd_income_band_sk#3258)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/household_demographics], PartitionFilters: [], PushedFilters: [IsNotNull(hd_demo_sk), IsNotNull(hd_income_band_sk)], ReadSchema: struct<hd_demo_sk:int,hd_income_band_sk:int>
                  :     :     :     :     +- Project [ca_address_sk#448, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457]
                  :     :     :     :        +- Filter isnotnull(ca_address_sk#448)
                  :     :     :     :           +- FileScan parquet [ca_address_sk#448,ca_street_number#450,ca_street_name#451,ca_city#454,ca_zip#457] Batched: true, DataFilters: [isnotnull(ca_address_sk#448)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/customer_address], PartitionFilters: [], PushedFilters: [IsNotNull(ca_address_sk)], ReadSchema: struct<ca_address_sk:int,ca_street_number:string,ca_street_name:string,ca_city:string,ca_zip:string>
                  :     :     :     +- Project [ca_address_sk#3262, ca_street_number#3264, ca_street_name#3265, ca_city#3268, ca_zip#3271]
                  :     :     :        +- Filter isnotnull(ca_address_sk#3262)
                  :     :     :           +- FileScan parquet [ca_address_sk#3262,ca_street_number#3264,ca_street_name#3265,ca_city#3268,ca_zip#3271] Batched: true, DataFilters: [isnotnull(ca_address_sk#3262)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/customer_address], PartitionFilters: [], PushedFilters: [IsNotNull(ca_address_sk)], ReadSchema: struct<ca_address_sk:int,ca_street_number:string,ca_street_name:string,ca_city:string,ca_zip:string>
                  :     :     +- Project [ib_income_band_sk#558]
                  :     :        +- Filter isnotnull(ib_income_band_sk#558)
                  :     :           +- FileScan parquet [ib_income_band_sk#558] Batched: true, DataFilters: [isnotnull(ib_income_band_sk#558)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/income_band], PartitionFilters: [], PushedFilters: [IsNotNull(ib_income_band_sk)], ReadSchema: struct<ib_income_band_sk:int>
                  :     +- Project [ib_income_band_sk#3275]
                  :        +- Filter isnotnull(ib_income_band_sk#3275)
                  :           +- FileScan parquet [ib_income_band_sk#3275] Batched: true, DataFilters: [isnotnull(ib_income_band_sk#3275)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/income_band], PartitionFilters: [], PushedFilters: [IsNotNull(ib_income_band_sk)], ReadSchema: struct<ib_income_band_sk:int>
                  +- Project [i_item_sk#564, i_product_name#585]
                     +- Filter ((((((isnotnull(i_current_price#569) AND i_color#581 IN (purple,burlywood,indian,spring,floral,medium)) AND (i_current_price#569 >= 64.00)) AND (i_current_price#569 <= 74.00)) AND (i_current_price#569 >= 65.00)) AND (i_current_price#569 <= 79.00)) AND isnotnull(i_item_sk#564))
                        +- FileScan parquet [i_item_sk#564,i_current_price#569,i_color#581,i_product_name#585] Batched: true, DataFilters: [isnotnull(i_current_price#569), i_color#581 IN (purple,burlywood,indian,spring,floral,medium), (..., Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/item], PartitionFilters: [], PushedFilters: [IsNotNull(i_current_price), In(i_color, [purple,burlywood,indian,spring,floral,medium]), Greater..., ReadSchema: struct<i_item_sk:int,i_current_price:decimal(7,2),i_color:string,i_product_name:string>
.
2022-09-08 15:15:55,612 INFO perf.Query: 
== Query: q64-v2.4 ==
Sort [product_name#3374 ASC NULLS FIRST, store_name#3376 ASC NULLS FIRST, cnt#3608L ASC NULLS FIRST], true
+- Project [product_name#3374, store_name#3376, store_zip#3377, b_street_number#3378, b_streen_name#3379, b_city#3380, b_zip#3381, c_street_number#3382, c_street_name#3383, c_city#3384, c_zip#3385, syear#3386, cnt#3389L, s1#3390, s2#3391, s3#3392, s1#3609, s2#3610, s3#3611, syear#3605, cnt#3608L]
   +- Filter ((((item_sk#3375 = item_sk#3594) AND (syear#3386 = 1999)) AND (syear#3605 = (1999 + 1))) AND (((cnt#3608L <= cnt#3389L) AND (store_name#3376 = store_name#3595)) AND (store_zip#3377 = store_zip#3596)))
      +- Join Inner
         :- SubqueryAlias cs1
         :  +- SubqueryAlias cross_sales
         :     +- Aggregate [i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#3481, ca_street_name#3482, ca_city#3485, ca_zip#3488, d_year#498, d_year#3415, d_year#3443], [i_product_name#585 AS product_name#3374, i_item_sk#564 AS item_sk#3375, s_store_name#669 AS store_name#3376, s_zip#689 AS store_zip#3377, ca_street_number#450 AS b_street_number#3378, ca_street_name#451 AS b_streen_name#3379, ca_city#454 AS b_city#3380, ca_zip#457 AS b_zip#3381, ca_street_number#3481 AS c_street_number#3382, ca_street_name#3482 AS c_street_name#3383, ca_city#3485 AS c_city#3384, ca_zip#3488 AS c_zip#3385, d_year#498 AS syear#3386, d_year#3415 AS fsyear#3387, d_year#3443 AS s2year#3388, count(1) AS cnt#3389L, sum(ss_wholesale_cost#140) AS s1#3390, sum(ss_list_price#141) AS s2#3391, sum(ss_coupon_amt#148) AS s3#3392]
         :        +- Filter ((((((ss_store_sk#136 = s_store_sk#664) AND (ss_sold_date_sk#152 = d_date_sk#492)) AND (ss_customer_sk#132 = c_customer_sk#412)) AND (((ss_cdemo_sk#133 = cd_demo_sk#474) AND (ss_hdemo_sk#134 = hd_demo_sk#548)) AND (ss_addr_sk#135 = ca_address_sk#448))) AND ((((ss_item_sk#131 = i_item_sk#564) AND (ss_item_sk#131 = sr_item_sk#177)) AND (ss_ticket_number#138L = sr_ticket_number#184L)) AND ((ss_item_sk#131 = cs_item_sk#14) AND (c_current_cdemo_sk#414 = cd_demo_sk#3465)))) AND (((((c_current_hdemo_sk#415 = hd_demo_sk#3474) AND (c_current_addr_sk#416 = ca_address_sk#3479)) AND (c_first_sales_date_sk#418 = d_date_sk#3409)) AND (((c_first_shipto_date_sk#417 = d_date_sk#3437) AND (ss_promo_sk#137 = p_promo_sk#608)) AND (hd_income_band_sk#549 = ib_income_band_sk#558))) AND ((((hd_income_band_sk#3475 = ib_income_band_sk#3492) AND NOT (cd_marital_status#476 = cd_marital_status#3467)) AND i_color#581 IN (purple,burlywood,indian,spring,floral,medium)) AND (((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(64 as decimal(2,0)) as decimal(7,2))) AND (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 10) as decimal(10,0)) as decimal(12,2)))) AND ((cast(i_current_price#569 as decimal(12,2)) >= cast(cast((64 + 1) as decimal(10,0)) as decimal(12,2))) AND (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 15) as decimal(10,0)) as decimal(12,2))))))))
         :           +- Join Inner
         :              :- Join Inner
         :              :  :- Join Inner
         :              :  :  :- Join Inner
         :              :  :  :  :- Join Inner
         :              :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- SubqueryAlias store_sales
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- Relation[ss_sold_time_sk#130,ss_item_sk#131,ss_customer_sk#132,ss_cdemo_sk#133,ss_hdemo_sk#134,ss_addr_sk#135,ss_store_sk#136,ss_promo_sk#137,ss_ticket_number#138L,ss_quantity#139,ss_wholesale_cost#140,ss_list_price#141,ss_sales_price#142,ss_ext_discount_amt#143,ss_ext_sales_price#144,ss_ext_wholesale_cost#145,ss_ext_list_price#146,ss_ext_tax#147,ss_coupon_amt#148,ss_net_paid#149,ss_net_paid_inc_tax#150,ss_net_profit#151,ss_sold_date_sk#152] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias store_returns
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Relation[sr_return_time_sk#176,sr_item_sk#177,sr_customer_sk#178,sr_cdemo_sk#179,sr_hdemo_sk#180,sr_addr_sk#181,sr_store_sk#182,sr_reason_sk#183,sr_ticket_number#184L,sr_return_quantity#185,sr_return_amt#186,sr_return_tax#187,sr_return_amt_inc_tax#188,sr_fee#189,sr_return_ship_cost#190,sr_refunded_cash#191,sr_reversed_charge#192,sr_store_credit#193,sr_net_loss#194,sr_returned_date_sk#195] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias cs_ui
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Project [cs_item_sk#14, sale#3372, refund#3373]
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Filter (cast(sum(cs_ext_list_price#24)#3402 as decimal(21,2)) > cast(CheckOverflow((promote_precision(cast(cast(2 as decimal(1,0)) as decimal(19,2))) * promote_precision(cast(sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#90 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#91 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#92 as decimal(9,2)))), DecimalType(9,2), true))#3403 as decimal(19,2)))), DecimalType(21,2), true) as decimal(21,2)))
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :           +- Aggregate [cs_item_sk#14], [cs_item_sk#14, sum(cs_ext_list_price#24) AS sale#3372, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#90 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#91 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#92 as decimal(9,2)))), DecimalType(9,2), true)) AS refund#3373, sum(cs_ext_list_price#24) AS sum(cs_ext_list_price#24)#3402, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#90 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#91 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#92 as decimal(9,2)))), DecimalType(9,2), true)) AS sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#90 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#91 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#92 as decimal(9,2)))), DecimalType(9,2), true))#3403]
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :              +- Filter ((cs_item_sk#14 = cr_item_sk#69) AND (cs_order_number#16L = cr_order_number#83L))
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                 +- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :- SubqueryAlias catalog_sales
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :  +- Relation[cs_sold_time_sk#0,cs_ship_date_sk#1,cs_bill_customer_sk#2,cs_bill_cdemo_sk#3,cs_bill_hdemo_sk#4,cs_bill_addr_sk#5,cs_ship_customer_sk#6,cs_ship_cdemo_sk#7,cs_ship_hdemo_sk#8,cs_ship_addr_sk#9,cs_call_center_sk#10,cs_catalog_page_sk#11,cs_ship_mode_sk#12,cs_warehouse_sk#13,cs_item_sk#14,cs_promo_sk#15,cs_order_number#16L,cs_quantity#17,cs_wholesale_cost#18,cs_list_price#19,cs_sales_price#20,cs_ext_discount_amt#21,cs_ext_sales_price#22,cs_ext_wholesale_cost#23,... 10 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    +- SubqueryAlias catalog_returns
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                       +- Relation[cr_returned_time_sk#68,cr_item_sk#69,cr_refunded_customer_sk#70,cr_refunded_cdemo_sk#71,cr_refunded_hdemo_sk#72,cr_refunded_addr_sk#73,cr_returning_customer_sk#74,cr_returning_cdemo_sk#75,cr_returning_hdemo_sk#76,cr_returning_addr_sk#77,cr_call_center_sk#78,cr_catalog_page_sk#79,cr_ship_mode_sk#80,cr_warehouse_sk#81,cr_reason_sk#82,cr_order_number#83L,cr_return_quantity#84,cr_return_amount#85,cr_return_tax#86,cr_return_amt_inc_tax#87,cr_fee#88,cr_return_ship_cost#89,cr_refunded_cash#90,cr_reversed_charge#91,... 3 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias d1
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias date_dim
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias d2
         :              :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias date_dim
         :              :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#3409,d_date_id#3410,d_date#3411,d_month_seq#3412,d_week_seq#3413,d_quarter_seq#3414,d_year#3415,d_dow#3416,d_moy#3417,d_dom#3418,d_qoy#3419,d_fy_year#3420,d_fy_quarter_seq#3421,d_fy_week_seq#3422,d_day_name#3423,d_quarter_name#3424,d_holiday#3425,d_weekend#3426,d_following_holiday#3427,d_first_dom#3428,d_last_dom#3429,d_same_day_ly#3430,d_same_day_lq#3431,d_current_day#3432,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias d3
         :              :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias date_dim
         :              :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#3437,d_date_id#3438,d_date#3439,d_month_seq#3440,d_week_seq#3441,d_quarter_seq#3442,d_year#3443,d_dow#3444,d_moy#3445,d_dom#3446,d_qoy#3447,d_fy_year#3448,d_fy_quarter_seq#3449,d_fy_week_seq#3450,d_day_name#3451,d_quarter_name#3452,d_holiday#3453,d_weekend#3454,d_following_holiday#3455,d_first_dom#3456,d_last_dom#3457,d_same_day_ly#3458,d_same_day_lq#3459,d_current_day#3460,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias store
         :              :  :  :  :  :  :  :  :  :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias customer
         :              :  :  :  :  :  :  :  :  :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
         :              :  :  :  :  :  :  :  :  :  +- SubqueryAlias cd1
         :              :  :  :  :  :  :  :  :  :     +- SubqueryAlias customer_demographics
         :              :  :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
         :              :  :  :  :  :  :  :  :  +- SubqueryAlias cd2
         :              :  :  :  :  :  :  :  :     +- SubqueryAlias customer_demographics
         :              :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#3465,cd_gender#3466,cd_marital_status#3467,cd_education_status#3468,cd_purchase_estimate#3469,cd_credit_rating#3470,cd_dep_count#3471,cd_dep_employed_count#3472,cd_dep_college_count#3473] parquet
         :              :  :  :  :  :  :  :  +- SubqueryAlias promotion
         :              :  :  :  :  :  :  :     +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet
         :              :  :  :  :  :  :  +- SubqueryAlias hd1
         :              :  :  :  :  :  :     +- SubqueryAlias household_demographics
         :              :  :  :  :  :  :        +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
         :              :  :  :  :  :  +- SubqueryAlias hd2
         :              :  :  :  :  :     +- SubqueryAlias household_demographics
         :              :  :  :  :  :        +- Relation[hd_demo_sk#3474,hd_income_band_sk#3475,hd_buy_potential#3476,hd_dep_count#3477,hd_vehicle_count#3478] parquet
         :              :  :  :  :  +- SubqueryAlias ad1
         :              :  :  :  :     +- SubqueryAlias customer_address
         :              :  :  :  :        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
         :              :  :  :  +- SubqueryAlias ad2
         :              :  :  :     +- SubqueryAlias customer_address
         :              :  :  :        +- Relation[ca_address_sk#3479,ca_address_id#3480,ca_street_number#3481,ca_street_name#3482,ca_street_type#3483,ca_suite_number#3484,ca_city#3485,ca_county#3486,ca_state#3487,ca_zip#3488,ca_country#3489,ca_gmt_offset#3490,ca_location_type#3491] parquet
         :              :  :  +- SubqueryAlias ib1
         :              :  :     +- SubqueryAlias income_band
         :              :  :        +- Relation[ib_income_band_sk#558,ib_lower_bound#559,ib_upper_bound#560] parquet
         :              :  +- SubqueryAlias ib2
         :              :     +- SubqueryAlias income_band
         :              :        +- Relation[ib_income_band_sk#3492,ib_lower_bound#3493,ib_upper_bound#3494] parquet
         :              +- SubqueryAlias item
         :                 +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
         +- SubqueryAlias cs2
            +- SubqueryAlias cross_sales
               +- Aggregate [i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#3567, ca_street_name#3568, ca_city#3571, ca_zip#3574, d_year#498, d_year#3501, d_year#3529], [i_product_name#585 AS product_name#3593, i_item_sk#564 AS item_sk#3594, s_store_name#669 AS store_name#3595, s_zip#689 AS store_zip#3596, ca_street_number#450 AS b_street_number#3597, ca_street_name#451 AS b_streen_name#3598, ca_city#454 AS b_city#3599, ca_zip#457 AS b_zip#3600, ca_street_number#3567 AS c_street_number#3601, ca_street_name#3568 AS c_street_name#3602, ca_city#3571 AS c_city#3603, ca_zip#3574 AS c_zip#3604, d_year#498 AS syear#3605, d_year#3501 AS fsyear#3606, d_year#3529 AS s2year#3607, count(1) AS cnt#3608L, sum(ss_wholesale_cost#140) AS s1#3609, sum(ss_list_price#141) AS s2#3610, sum(ss_coupon_amt#148) AS s3#3611]
                  +- Filter ((((((ss_store_sk#136 = s_store_sk#664) AND (ss_sold_date_sk#152 = d_date_sk#492)) AND (ss_customer_sk#132 = c_customer_sk#412)) AND (((ss_cdemo_sk#133 = cd_demo_sk#474) AND (ss_hdemo_sk#134 = hd_demo_sk#548)) AND (ss_addr_sk#135 = ca_address_sk#448))) AND ((((ss_item_sk#131 = i_item_sk#564) AND (ss_item_sk#131 = sr_item_sk#177)) AND (ss_ticket_number#138L = sr_ticket_number#184L)) AND ((ss_item_sk#131 = cs_item_sk#14) AND (c_current_cdemo_sk#414 = cd_demo_sk#3551)))) AND (((((c_current_hdemo_sk#415 = hd_demo_sk#3560) AND (c_current_addr_sk#416 = ca_address_sk#3565)) AND (c_first_sales_date_sk#418 = d_date_sk#3495)) AND (((c_first_shipto_date_sk#417 = d_date_sk#3523) AND (ss_promo_sk#137 = p_promo_sk#608)) AND (hd_income_band_sk#549 = ib_income_band_sk#558))) AND ((((hd_income_band_sk#3561 = ib_income_band_sk#3578) AND NOT (cd_marital_status#476 = cd_marital_status#3553)) AND i_color#581 IN (purple,burlywood,indian,spring,floral,medium)) AND (((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(64 as decimal(2,0)) as decimal(7,2))) AND (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 10) as decimal(10,0)) as decimal(12,2)))) AND ((cast(i_current_price#569 as decimal(12,2)) >= cast(cast((64 + 1) as decimal(10,0)) as decimal(12,2))) AND (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 15) as decimal(10,0)) as decimal(12,2))))))))
                     +- Join Inner
                        :- Join Inner
                        :  :- Join Inner
                        :  :  :- Join Inner
                        :  :  :  :- Join Inner
                        :  :  :  :  :- Join Inner
                        :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- SubqueryAlias store_sales
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- Relation[ss_sold_time_sk#130,ss_item_sk#131,ss_customer_sk#132,ss_cdemo_sk#133,ss_hdemo_sk#134,ss_addr_sk#135,ss_store_sk#136,ss_promo_sk#137,ss_ticket_number#138L,ss_quantity#139,ss_wholesale_cost#140,ss_list_price#141,ss_sales_price#142,ss_ext_discount_amt#143,ss_ext_sales_price#144,ss_ext_wholesale_cost#145,ss_ext_list_price#146,ss_ext_tax#147,ss_coupon_amt#148,ss_net_paid#149,ss_net_paid_inc_tax#150,ss_net_profit#151,ss_sold_date_sk#152] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias store_returns
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Relation[sr_return_time_sk#176,sr_item_sk#177,sr_customer_sk#178,sr_cdemo_sk#179,sr_hdemo_sk#180,sr_addr_sk#181,sr_store_sk#182,sr_reason_sk#183,sr_ticket_number#184L,sr_return_quantity#185,sr_return_amt#186,sr_return_tax#187,sr_return_amt_inc_tax#188,sr_fee#189,sr_return_ship_cost#190,sr_refunded_cash#191,sr_reversed_charge#192,sr_store_credit#193,sr_net_loss#194,sr_returned_date_sk#195] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias cs_ui
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Project [cs_item_sk#14, sale#3372, refund#3373]
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Filter (cast(sum(cs_ext_list_price#24)#3407 as decimal(21,2)) > cast(CheckOverflow((promote_precision(cast(cast(2 as decimal(1,0)) as decimal(19,2))) * promote_precision(cast(sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#90 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#91 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#92 as decimal(9,2)))), DecimalType(9,2), true))#3408 as decimal(19,2)))), DecimalType(21,2), true) as decimal(21,2)))
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :           +- Aggregate [cs_item_sk#14], [cs_item_sk#14, sum(cs_ext_list_price#24) AS sale#3372, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#90 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#91 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#92 as decimal(9,2)))), DecimalType(9,2), true)) AS refund#3373, sum(cs_ext_list_price#24) AS sum(cs_ext_list_price#24)#3407, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#90 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#91 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#92 as decimal(9,2)))), DecimalType(9,2), true)) AS sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#90 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#91 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#92 as decimal(9,2)))), DecimalType(9,2), true))#3408]
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :              +- Filter ((cs_item_sk#14 = cr_item_sk#69) AND (cs_order_number#16L = cr_order_number#83L))
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                 +- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :- SubqueryAlias catalog_sales
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :  +- Relation[cs_sold_time_sk#0,cs_ship_date_sk#1,cs_bill_customer_sk#2,cs_bill_cdemo_sk#3,cs_bill_hdemo_sk#4,cs_bill_addr_sk#5,cs_ship_customer_sk#6,cs_ship_cdemo_sk#7,cs_ship_hdemo_sk#8,cs_ship_addr_sk#9,cs_call_center_sk#10,cs_catalog_page_sk#11,cs_ship_mode_sk#12,cs_warehouse_sk#13,cs_item_sk#14,cs_promo_sk#15,cs_order_number#16L,cs_quantity#17,cs_wholesale_cost#18,cs_list_price#19,cs_sales_price#20,cs_ext_discount_amt#21,cs_ext_sales_price#22,cs_ext_wholesale_cost#23,... 10 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    +- SubqueryAlias catalog_returns
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                       +- Relation[cr_returned_time_sk#68,cr_item_sk#69,cr_refunded_customer_sk#70,cr_refunded_cdemo_sk#71,cr_refunded_hdemo_sk#72,cr_refunded_addr_sk#73,cr_returning_customer_sk#74,cr_returning_cdemo_sk#75,cr_returning_hdemo_sk#76,cr_returning_addr_sk#77,cr_call_center_sk#78,cr_catalog_page_sk#79,cr_ship_mode_sk#80,cr_warehouse_sk#81,cr_reason_sk#82,cr_order_number#83L,cr_return_quantity#84,cr_return_amount#85,cr_return_tax#86,cr_return_amt_inc_tax#87,cr_fee#88,cr_return_ship_cost#89,cr_refunded_cash#90,cr_reversed_charge#91,... 3 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias d1
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias date_dim
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias d2
                        :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias date_dim
                        :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#3495,d_date_id#3496,d_date#3497,d_month_seq#3498,d_week_seq#3499,d_quarter_seq#3500,d_year#3501,d_dow#3502,d_moy#3503,d_dom#3504,d_qoy#3505,d_fy_year#3506,d_fy_quarter_seq#3507,d_fy_week_seq#3508,d_day_name#3509,d_quarter_name#3510,d_holiday#3511,d_weekend#3512,d_following_holiday#3513,d_first_dom#3514,d_last_dom#3515,d_same_day_ly#3516,d_same_day_lq#3517,d_current_day#3518,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias d3
                        :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias date_dim
                        :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#3523,d_date_id#3524,d_date#3525,d_month_seq#3526,d_week_seq#3527,d_quarter_seq#3528,d_year#3529,d_dow#3530,d_moy#3531,d_dom#3532,d_qoy#3533,d_fy_year#3534,d_fy_quarter_seq#3535,d_fy_week_seq#3536,d_day_name#3537,d_quarter_name#3538,d_holiday#3539,d_weekend#3540,d_following_holiday#3541,d_first_dom#3542,d_last_dom#3543,d_same_day_ly#3544,d_same_day_lq#3545,d_current_day#3546,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias store
                        :  :  :  :  :  :  :  :  :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias customer
                        :  :  :  :  :  :  :  :  :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                        :  :  :  :  :  :  :  :  :  +- SubqueryAlias cd1
                        :  :  :  :  :  :  :  :  :     +- SubqueryAlias customer_demographics
                        :  :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
                        :  :  :  :  :  :  :  :  +- SubqueryAlias cd2
                        :  :  :  :  :  :  :  :     +- SubqueryAlias customer_demographics
                        :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#3551,cd_gender#3552,cd_marital_status#3553,cd_education_status#3554,cd_purchase_estimate#3555,cd_credit_rating#3556,cd_dep_count#3557,cd_dep_employed_count#3558,cd_dep_college_count#3559] parquet
                        :  :  :  :  :  :  :  +- SubqueryAlias promotion
                        :  :  :  :  :  :  :     +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet
                        :  :  :  :  :  :  +- SubqueryAlias hd1
                        :  :  :  :  :  :     +- SubqueryAlias household_demographics
                        :  :  :  :  :  :        +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
                        :  :  :  :  :  +- SubqueryAlias hd2
                        :  :  :  :  :     +- SubqueryAlias household_demographics
                        :  :  :  :  :        +- Relation[hd_demo_sk#3560,hd_income_band_sk#3561,hd_buy_potential#3562,hd_dep_count#3563,hd_vehicle_count#3564] parquet
                        :  :  :  :  +- SubqueryAlias ad1
                        :  :  :  :     +- SubqueryAlias customer_address
                        :  :  :  :        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                        :  :  :  +- SubqueryAlias ad2
                        :  :  :     +- SubqueryAlias customer_address
                        :  :  :        +- Relation[ca_address_sk#3565,ca_address_id#3566,ca_street_number#3567,ca_street_name#3568,ca_street_type#3569,ca_suite_number#3570,ca_city#3571,ca_county#3572,ca_state#3573,ca_zip#3574,ca_country#3575,ca_gmt_offset#3576,ca_location_type#3577] parquet
                        :  :  +- SubqueryAlias ib1
                        :  :     +- SubqueryAlias income_band
                        :  :        +- Relation[ib_income_band_sk#558,ib_lower_bound#559,ib_upper_bound#560] parquet
                        :  +- SubqueryAlias ib2
                        :     +- SubqueryAlias income_band
                        :        +- Relation[ib_income_band_sk#3578,ib_lower_bound#3579,ib_upper_bound#3580] parquet
                        +- SubqueryAlias item
                           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

     : benchmark
2022-09-08 15:15:56,153 INFO perf.Query: 
== Query: q64-v2.4 ==
Sort [product_name#3639 ASC NULLS FIRST, store_name#3641 ASC NULLS FIRST, cnt#3873L ASC NULLS FIRST], true
+- Project [product_name#3639, store_name#3641, store_zip#3642, b_street_number#3643, b_streen_name#3644, b_city#3645, b_zip#3646, c_street_number#3647, c_street_name#3648, c_city#3649, c_zip#3650, syear#3651, cnt#3654L, s1#3655, s2#3656, s3#3657, s1#3874, s2#3875, s3#3876, syear#3870, cnt#3873L]
   +- Filter ((((item_sk#3640 = item_sk#3859) AND (syear#3651 = 1999)) AND (syear#3870 = (1999 + 1))) AND (((cnt#3873L <= cnt#3654L) AND (store_name#3641 = store_name#3860)) AND (store_zip#3642 = store_zip#3861)))
      +- Join Inner
         :- SubqueryAlias cs1
         :  +- SubqueryAlias cross_sales
         :     +- Aggregate [i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#3746, ca_street_name#3747, ca_city#3750, ca_zip#3753, d_year#498, d_year#3680, d_year#3708], [i_product_name#585 AS product_name#3639, i_item_sk#564 AS item_sk#3640, s_store_name#669 AS store_name#3641, s_zip#689 AS store_zip#3642, ca_street_number#450 AS b_street_number#3643, ca_street_name#451 AS b_streen_name#3644, ca_city#454 AS b_city#3645, ca_zip#457 AS b_zip#3646, ca_street_number#3746 AS c_street_number#3647, ca_street_name#3747 AS c_street_name#3648, ca_city#3750 AS c_city#3649, ca_zip#3753 AS c_zip#3650, d_year#498 AS syear#3651, d_year#3680 AS fsyear#3652, d_year#3708 AS s2year#3653, count(1) AS cnt#3654L, sum(ss_wholesale_cost#140) AS s1#3655, sum(ss_list_price#141) AS s2#3656, sum(ss_coupon_amt#148) AS s3#3657]
         :        +- Filter ((((((ss_store_sk#136 = s_store_sk#664) AND (ss_sold_date_sk#152 = d_date_sk#492)) AND (ss_customer_sk#132 = c_customer_sk#412)) AND (((ss_cdemo_sk#133 = cd_demo_sk#474) AND (ss_hdemo_sk#134 = hd_demo_sk#548)) AND (ss_addr_sk#135 = ca_address_sk#448))) AND ((((ss_item_sk#131 = i_item_sk#564) AND (ss_item_sk#131 = sr_item_sk#177)) AND (ss_ticket_number#138L = sr_ticket_number#184L)) AND ((ss_item_sk#131 = cs_item_sk#14) AND (c_current_cdemo_sk#414 = cd_demo_sk#3730)))) AND (((((c_current_hdemo_sk#415 = hd_demo_sk#3739) AND (c_current_addr_sk#416 = ca_address_sk#3744)) AND (c_first_sales_date_sk#418 = d_date_sk#3674)) AND (((c_first_shipto_date_sk#417 = d_date_sk#3702) AND (ss_promo_sk#137 = p_promo_sk#608)) AND (hd_income_band_sk#549 = ib_income_band_sk#558))) AND ((((hd_income_band_sk#3740 = ib_income_band_sk#3757) AND NOT (cd_marital_status#476 = cd_marital_status#3732)) AND i_color#581 IN (purple,burlywood,indian,spring,floral,medium)) AND (((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(64 as decimal(2,0)) as decimal(7,2))) AND (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 10) as decimal(10,0)) as decimal(12,2)))) AND ((cast(i_current_price#569 as decimal(12,2)) >= cast(cast((64 + 1) as decimal(10,0)) as decimal(12,2))) AND (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 15) as decimal(10,0)) as decimal(12,2))))))))
         :           +- Join Inner
         :              :- Join Inner
         :              :  :- Join Inner
         :              :  :  :- Join Inner
         :              :  :  :  :- Join Inner
         :              :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- SubqueryAlias store_sales
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- Relation[ss_sold_time_sk#130,ss_item_sk#131,ss_customer_sk#132,ss_cdemo_sk#133,ss_hdemo_sk#134,ss_addr_sk#135,ss_store_sk#136,ss_promo_sk#137,ss_ticket_number#138L,ss_quantity#139,ss_wholesale_cost#140,ss_list_price#141,ss_sales_price#142,ss_ext_discount_amt#143,ss_ext_sales_price#144,ss_ext_wholesale_cost#145,ss_ext_list_price#146,ss_ext_tax#147,ss_coupon_amt#148,ss_net_paid#149,ss_net_paid_inc_tax#150,ss_net_profit#151,ss_sold_date_sk#152] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias store_returns
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Relation[sr_return_time_sk#176,sr_item_sk#177,sr_customer_sk#178,sr_cdemo_sk#179,sr_hdemo_sk#180,sr_addr_sk#181,sr_store_sk#182,sr_reason_sk#183,sr_ticket_number#184L,sr_return_quantity#185,sr_return_amt#186,sr_return_tax#187,sr_return_amt_inc_tax#188,sr_fee#189,sr_return_ship_cost#190,sr_refunded_cash#191,sr_reversed_charge#192,sr_store_credit#193,sr_net_loss#194,sr_returned_date_sk#195] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias cs_ui
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Project [cs_item_sk#14, sale#3637, refund#3638]
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Filter (cast(sum(cs_ext_list_price#24)#3667 as decimal(21,2)) > cast(CheckOverflow((promote_precision(cast(cast(2 as decimal(1,0)) as decimal(19,2))) * promote_precision(cast(sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#90 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#91 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#92 as decimal(9,2)))), DecimalType(9,2), true))#3668 as decimal(19,2)))), DecimalType(21,2), true) as decimal(21,2)))
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :           +- Aggregate [cs_item_sk#14], [cs_item_sk#14, sum(cs_ext_list_price#24) AS sale#3637, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#90 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#91 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#92 as decimal(9,2)))), DecimalType(9,2), true)) AS refund#3638, sum(cs_ext_list_price#24) AS sum(cs_ext_list_price#24)#3667, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#90 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#91 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#92 as decimal(9,2)))), DecimalType(9,2), true)) AS sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#90 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#91 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#92 as decimal(9,2)))), DecimalType(9,2), true))#3668]
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :              +- Filter ((cs_item_sk#14 = cr_item_sk#69) AND (cs_order_number#16L = cr_order_number#83L))
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                 +- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :- SubqueryAlias catalog_sales
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :  +- Relation[cs_sold_time_sk#0,cs_ship_date_sk#1,cs_bill_customer_sk#2,cs_bill_cdemo_sk#3,cs_bill_hdemo_sk#4,cs_bill_addr_sk#5,cs_ship_customer_sk#6,cs_ship_cdemo_sk#7,cs_ship_hdemo_sk#8,cs_ship_addr_sk#9,cs_call_center_sk#10,cs_catalog_page_sk#11,cs_ship_mode_sk#12,cs_warehouse_sk#13,cs_item_sk#14,cs_promo_sk#15,cs_order_number#16L,cs_quantity#17,cs_wholesale_cost#18,cs_list_price#19,cs_sales_price#20,cs_ext_discount_amt#21,cs_ext_sales_price#22,cs_ext_wholesale_cost#23,... 10 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    +- SubqueryAlias catalog_returns
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                       +- Relation[cr_returned_time_sk#68,cr_item_sk#69,cr_refunded_customer_sk#70,cr_refunded_cdemo_sk#71,cr_refunded_hdemo_sk#72,cr_refunded_addr_sk#73,cr_returning_customer_sk#74,cr_returning_cdemo_sk#75,cr_returning_hdemo_sk#76,cr_returning_addr_sk#77,cr_call_center_sk#78,cr_catalog_page_sk#79,cr_ship_mode_sk#80,cr_warehouse_sk#81,cr_reason_sk#82,cr_order_number#83L,cr_return_quantity#84,cr_return_amount#85,cr_return_tax#86,cr_return_amt_inc_tax#87,cr_fee#88,cr_return_ship_cost#89,cr_refunded_cash#90,cr_reversed_charge#91,... 3 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias d1
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias date_dim
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias d2
         :              :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias date_dim
         :              :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#3674,d_date_id#3675,d_date#3676,d_month_seq#3677,d_week_seq#3678,d_quarter_seq#3679,d_year#3680,d_dow#3681,d_moy#3682,d_dom#3683,d_qoy#3684,d_fy_year#3685,d_fy_quarter_seq#3686,d_fy_week_seq#3687,d_day_name#3688,d_quarter_name#3689,d_holiday#3690,d_weekend#3691,d_following_holiday#3692,d_first_dom#3693,d_last_dom#3694,d_same_day_ly#3695,d_same_day_lq#3696,d_current_day#3697,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias d3
         :              :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias date_dim
         :              :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#3702,d_date_id#3703,d_date#3704,d_month_seq#3705,d_week_seq#3706,d_quarter_seq#3707,d_year#3708,d_dow#3709,d_moy#3710,d_dom#3711,d_qoy#3712,d_fy_year#3713,d_fy_quarter_seq#3714,d_fy_week_seq#3715,d_day_name#3716,d_quarter_name#3717,d_holiday#3718,d_weekend#3719,d_following_holiday#3720,d_first_dom#3721,d_last_dom#3722,d_same_day_ly#3723,d_same_day_lq#3724,d_current_day#3725,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias store
         :              :  :  :  :  :  :  :  :  :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias customer
         :              :  :  :  :  :  :  :  :  :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
         :              :  :  :  :  :  :  :  :  :  +- SubqueryAlias cd1
         :              :  :  :  :  :  :  :  :  :     +- SubqueryAlias customer_demographics
         :              :  :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
         :              :  :  :  :  :  :  :  :  +- SubqueryAlias cd2
         :              :  :  :  :  :  :  :  :     +- SubqueryAlias customer_demographics
         :              :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#3730,cd_gender#3731,cd_marital_status#3732,cd_education_status#3733,cd_purchase_estimate#3734,cd_credit_rating#3735,cd_dep_count#3736,cd_dep_employed_count#3737,cd_dep_college_count#3738] parquet
         :              :  :  :  :  :  :  :  +- SubqueryAlias promotion
         :              :  :  :  :  :  :  :     +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet
         :              :  :  :  :  :  :  +- SubqueryAlias hd1
         :              :  :  :  :  :  :     +- SubqueryAlias household_demographics
         :              :  :  :  :  :  :        +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
         :              :  :  :  :  :  +- SubqueryAlias hd2
         :              :  :  :  :  :     +- SubqueryAlias household_demographics
         :              :  :  :  :  :        +- Relation[hd_demo_sk#3739,hd_income_band_sk#3740,hd_buy_potential#3741,hd_dep_count#3742,hd_vehicle_count#3743] parquet
         :              :  :  :  :  +- SubqueryAlias ad1
         :              :  :  :  :     +- SubqueryAlias customer_address
         :              :  :  :  :        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
         :              :  :  :  +- SubqueryAlias ad2
         :              :  :  :     +- SubqueryAlias customer_address
         :              :  :  :        +- Relation[ca_address_sk#3744,ca_address_id#3745,ca_street_number#3746,ca_street_name#3747,ca_street_type#3748,ca_suite_number#3749,ca_city#3750,ca_county#3751,ca_state#3752,ca_zip#3753,ca_country#3754,ca_gmt_offset#3755,ca_location_type#3756] parquet
         :              :  :  +- SubqueryAlias ib1
         :              :  :     +- SubqueryAlias income_band
         :              :  :        +- Relation[ib_income_band_sk#558,ib_lower_bound#559,ib_upper_bound#560] parquet
         :              :  +- SubqueryAlias ib2
         :              :     +- SubqueryAlias income_band
         :              :        +- Relation[ib_income_band_sk#3757,ib_lower_bound#3758,ib_upper_bound#3759] parquet
         :              +- SubqueryAlias item
         :                 +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
         +- SubqueryAlias cs2
            +- SubqueryAlias cross_sales
               +- Aggregate [i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#3832, ca_street_name#3833, ca_city#3836, ca_zip#3839, d_year#498, d_year#3766, d_year#3794], [i_product_name#585 AS product_name#3858, i_item_sk#564 AS item_sk#3859, s_store_name#669 AS store_name#3860, s_zip#689 AS store_zip#3861, ca_street_number#450 AS b_street_number#3862, ca_street_name#451 AS b_streen_name#3863, ca_city#454 AS b_city#3864, ca_zip#457 AS b_zip#3865, ca_street_number#3832 AS c_street_number#3866, ca_street_name#3833 AS c_street_name#3867, ca_city#3836 AS c_city#3868, ca_zip#3839 AS c_zip#3869, d_year#498 AS syear#3870, d_year#3766 AS fsyear#3871, d_year#3794 AS s2year#3872, count(1) AS cnt#3873L, sum(ss_wholesale_cost#140) AS s1#3874, sum(ss_list_price#141) AS s2#3875, sum(ss_coupon_amt#148) AS s3#3876]
                  +- Filter ((((((ss_store_sk#136 = s_store_sk#664) AND (ss_sold_date_sk#152 = d_date_sk#492)) AND (ss_customer_sk#132 = c_customer_sk#412)) AND (((ss_cdemo_sk#133 = cd_demo_sk#474) AND (ss_hdemo_sk#134 = hd_demo_sk#548)) AND (ss_addr_sk#135 = ca_address_sk#448))) AND ((((ss_item_sk#131 = i_item_sk#564) AND (ss_item_sk#131 = sr_item_sk#177)) AND (ss_ticket_number#138L = sr_ticket_number#184L)) AND ((ss_item_sk#131 = cs_item_sk#14) AND (c_current_cdemo_sk#414 = cd_demo_sk#3816)))) AND (((((c_current_hdemo_sk#415 = hd_demo_sk#3825) AND (c_current_addr_sk#416 = ca_address_sk#3830)) AND (c_first_sales_date_sk#418 = d_date_sk#3760)) AND (((c_first_shipto_date_sk#417 = d_date_sk#3788) AND (ss_promo_sk#137 = p_promo_sk#608)) AND (hd_income_band_sk#549 = ib_income_band_sk#558))) AND ((((hd_income_band_sk#3826 = ib_income_band_sk#3843) AND NOT (cd_marital_status#476 = cd_marital_status#3818)) AND i_color#581 IN (purple,burlywood,indian,spring,floral,medium)) AND (((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(64 as decimal(2,0)) as decimal(7,2))) AND (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 10) as decimal(10,0)) as decimal(12,2)))) AND ((cast(i_current_price#569 as decimal(12,2)) >= cast(cast((64 + 1) as decimal(10,0)) as decimal(12,2))) AND (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 15) as decimal(10,0)) as decimal(12,2))))))))
                     +- Join Inner
                        :- Join Inner
                        :  :- Join Inner
                        :  :  :- Join Inner
                        :  :  :  :- Join Inner
                        :  :  :  :  :- Join Inner
                        :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- SubqueryAlias store_sales
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- Relation[ss_sold_time_sk#130,ss_item_sk#131,ss_customer_sk#132,ss_cdemo_sk#133,ss_hdemo_sk#134,ss_addr_sk#135,ss_store_sk#136,ss_promo_sk#137,ss_ticket_number#138L,ss_quantity#139,ss_wholesale_cost#140,ss_list_price#141,ss_sales_price#142,ss_ext_discount_amt#143,ss_ext_sales_price#144,ss_ext_wholesale_cost#145,ss_ext_list_price#146,ss_ext_tax#147,ss_coupon_amt#148,ss_net_paid#149,ss_net_paid_inc_tax#150,ss_net_profit#151,ss_sold_date_sk#152] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias store_returns
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Relation[sr_return_time_sk#176,sr_item_sk#177,sr_customer_sk#178,sr_cdemo_sk#179,sr_hdemo_sk#180,sr_addr_sk#181,sr_store_sk#182,sr_reason_sk#183,sr_ticket_number#184L,sr_return_quantity#185,sr_return_amt#186,sr_return_tax#187,sr_return_amt_inc_tax#188,sr_fee#189,sr_return_ship_cost#190,sr_refunded_cash#191,sr_reversed_charge#192,sr_store_credit#193,sr_net_loss#194,sr_returned_date_sk#195] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias cs_ui
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Project [cs_item_sk#14, sale#3637, refund#3638]
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Filter (cast(sum(cs_ext_list_price#24)#3672 as decimal(21,2)) > cast(CheckOverflow((promote_precision(cast(cast(2 as decimal(1,0)) as decimal(19,2))) * promote_precision(cast(sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#90 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#91 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#92 as decimal(9,2)))), DecimalType(9,2), true))#3673 as decimal(19,2)))), DecimalType(21,2), true) as decimal(21,2)))
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :           +- Aggregate [cs_item_sk#14], [cs_item_sk#14, sum(cs_ext_list_price#24) AS sale#3637, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#90 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#91 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#92 as decimal(9,2)))), DecimalType(9,2), true)) AS refund#3638, sum(cs_ext_list_price#24) AS sum(cs_ext_list_price#24)#3672, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#90 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#91 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#92 as decimal(9,2)))), DecimalType(9,2), true)) AS sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#90 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#91 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#92 as decimal(9,2)))), DecimalType(9,2), true))#3673]
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :              +- Filter ((cs_item_sk#14 = cr_item_sk#69) AND (cs_order_number#16L = cr_order_number#83L))
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                 +- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :- SubqueryAlias catalog_sales
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :  +- Relation[cs_sold_time_sk#0,cs_ship_date_sk#1,cs_bill_customer_sk#2,cs_bill_cdemo_sk#3,cs_bill_hdemo_sk#4,cs_bill_addr_sk#5,cs_ship_customer_sk#6,cs_ship_cdemo_sk#7,cs_ship_hdemo_sk#8,cs_ship_addr_sk#9,cs_call_center_sk#10,cs_catalog_page_sk#11,cs_ship_mode_sk#12,cs_warehouse_sk#13,cs_item_sk#14,cs_promo_sk#15,cs_order_number#16L,cs_quantity#17,cs_wholesale_cost#18,cs_list_price#19,cs_sales_price#20,cs_ext_discount_amt#21,cs_ext_sales_price#22,cs_ext_wholesale_cost#23,... 10 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    +- SubqueryAlias catalog_returns
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                       +- Relation[cr_returned_time_sk#68,cr_item_sk#69,cr_refunded_customer_sk#70,cr_refunded_cdemo_sk#71,cr_refunded_hdemo_sk#72,cr_refunded_addr_sk#73,cr_returning_customer_sk#74,cr_returning_cdemo_sk#75,cr_returning_hdemo_sk#76,cr_returning_addr_sk#77,cr_call_center_sk#78,cr_catalog_page_sk#79,cr_ship_mode_sk#80,cr_warehouse_sk#81,cr_reason_sk#82,cr_order_number#83L,cr_return_quantity#84,cr_return_amount#85,cr_return_tax#86,cr_return_amt_inc_tax#87,cr_fee#88,cr_return_ship_cost#89,cr_refunded_cash#90,cr_reversed_charge#91,... 3 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias d1
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias date_dim
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias d2
                        :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias date_dim
                        :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#3760,d_date_id#3761,d_date#3762,d_month_seq#3763,d_week_seq#3764,d_quarter_seq#3765,d_year#3766,d_dow#3767,d_moy#3768,d_dom#3769,d_qoy#3770,d_fy_year#3771,d_fy_quarter_seq#3772,d_fy_week_seq#3773,d_day_name#3774,d_quarter_name#3775,d_holiday#3776,d_weekend#3777,d_following_holiday#3778,d_first_dom#3779,d_last_dom#3780,d_same_day_ly#3781,d_same_day_lq#3782,d_current_day#3783,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias d3
                        :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias date_dim
                        :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#3788,d_date_id#3789,d_date#3790,d_month_seq#3791,d_week_seq#3792,d_quarter_seq#3793,d_year#3794,d_dow#3795,d_moy#3796,d_dom#3797,d_qoy#3798,d_fy_year#3799,d_fy_quarter_seq#3800,d_fy_week_seq#3801,d_day_name#3802,d_quarter_name#3803,d_holiday#3804,d_weekend#3805,d_following_holiday#3806,d_first_dom#3807,d_last_dom#3808,d_same_day_ly#3809,d_same_day_lq#3810,d_current_day#3811,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias store
                        :  :  :  :  :  :  :  :  :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias customer
                        :  :  :  :  :  :  :  :  :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                        :  :  :  :  :  :  :  :  :  +- SubqueryAlias cd1
                        :  :  :  :  :  :  :  :  :     +- SubqueryAlias customer_demographics
                        :  :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
                        :  :  :  :  :  :  :  :  +- SubqueryAlias cd2
                        :  :  :  :  :  :  :  :     +- SubqueryAlias customer_demographics
                        :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#3816,cd_gender#3817,cd_marital_status#3818,cd_education_status#3819,cd_purchase_estimate#3820,cd_credit_rating#3821,cd_dep_count#3822,cd_dep_employed_count#3823,cd_dep_college_count#3824] parquet
                        :  :  :  :  :  :  :  +- SubqueryAlias promotion
                        :  :  :  :  :  :  :     +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet
                        :  :  :  :  :  :  +- SubqueryAlias hd1
                        :  :  :  :  :  :     +- SubqueryAlias household_demographics
                        :  :  :  :  :  :        +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
                        :  :  :  :  :  +- SubqueryAlias hd2
                        :  :  :  :  :     +- SubqueryAlias household_demographics
                        :  :  :  :  :        +- Relation[hd_demo_sk#3825,hd_income_band_sk#3826,hd_buy_potential#3827,hd_dep_count#3828,hd_vehicle_count#3829] parquet
                        :  :  :  :  +- SubqueryAlias ad1
                        :  :  :  :     +- SubqueryAlias customer_address
                        :  :  :  :        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                        :  :  :  +- SubqueryAlias ad2
                        :  :  :     +- SubqueryAlias customer_address
                        :  :  :        +- Relation[ca_address_sk#3830,ca_address_id#3831,ca_street_number#3832,ca_street_name#3833,ca_street_type#3834,ca_suite_number#3835,ca_city#3836,ca_county#3837,ca_state#3838,ca_zip#3839,ca_country#3840,ca_gmt_offset#3841,ca_location_type#3842] parquet
                        :  :  +- SubqueryAlias ib1
                        :  :     +- SubqueryAlias income_band
                        :  :        +- Relation[ib_income_band_sk#558,ib_lower_bound#559,ib_upper_bound#560] parquet
                        :  +- SubqueryAlias ib2
                        :     +- SubqueryAlias income_band
                        :        +- Relation[ib_income_band_sk#3843,ib_lower_bound#3844,ib_upper_bound#3845] parquet
                        +- SubqueryAlias item
                           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

      running Thread[benchmark runner,5,main]
2022-09-08 15:15:57,619 WARN adaptive.InsertAdaptiveSparkPlan: spark.sql.adaptive.enabled is enabled but is not supported for query: Sort [product_name#3904 ASC NULLS FIRST, store_name#3906 ASC NULLS FIRST, cnt#4138L ASC NULLS FIRST], true, 0
+- Project [product_name#3904, store_name#3906, store_zip#3907, b_street_number#3908, b_streen_name#3909, b_city#3910, b_zip#3911, c_street_number#3912, c_street_name#3913, c_city#3914, c_zip#3915, syear#3916, cnt#3919L, s1#3920, s2#3921, s3#3922, s1#4139, s2#4140, s3#4141, syear#4135, cnt#4138L]
   +- SortMergeJoin [item_sk#3905, store_name#3906, store_zip#3907], [item_sk#4124, store_name#4125, store_zip#4126], Inner, (cnt#4138L <= cnt#3919L)
      :- HashAggregate(keys=[i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#4011, ca_street_name#4012, ca_city#4015, ca_zip#4018, d_year#498, d_year#3945, d_year#3973], functions=[count(1), sum(UnscaledValue(ss_wholesale_cost#140)), sum(UnscaledValue(ss_list_price#141)), sum(UnscaledValue(ss_coupon_amt#148))], output=[product_name#3904, item_sk#3905, store_name#3906, store_zip#3907, b_street_number#3908, b_streen_name#3909, b_city#3910, b_zip#3911, c_street_number#3912, c_street_name#3913, c_city#3914, c_zip#3915, syear#3916, cnt#3919L, s1#3920, s2#3921, s3#3922])
      :  +- HashAggregate(keys=[i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#4011, ca_street_name#4012, ca_city#4015, ca_zip#4018, d_year#498, d_year#3945, d_year#3973], functions=[partial_count(1), partial_sum(UnscaledValue(ss_wholesale_cost#140)), partial_sum(UnscaledValue(ss_list_price#141)), partial_sum(UnscaledValue(ss_coupon_amt#148))], output=[i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#4011, ca_street_name#4012, ca_city#4015, ca_zip#4018, d_year#498, d_year#3945, d_year#3973, count#4173L, sum#4174L, sum#4175L, sum#4176L])
      :     +- Project [ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, d_year#3945, d_year#3973, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#4011, ca_street_name#4012, ca_city#4015, ca_zip#4018, i_item_sk#564, i_product_name#585]
      :        +- BroadcastHashJoin [ss_item_sk#131], [i_item_sk#564], Inner, BuildRight, false
      :           :- Project [ss_item_sk#131, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, d_year#3945, d_year#3973, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#4011, ca_street_name#4012, ca_city#4015, ca_zip#4018]
      :           :  +- BroadcastHashJoin [hd_income_band_sk#4005], [ib_income_band_sk#4022], Inner, BuildRight, false
      :           :     :- Project [ss_item_sk#131, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, d_year#3945, d_year#3973, hd_income_band_sk#4005, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#4011, ca_street_name#4012, ca_city#4015, ca_zip#4018]
      :           :     :  +- BroadcastHashJoin [hd_income_band_sk#549], [ib_income_band_sk#558], Inner, BuildRight, false
      :           :     :     :- Project [ss_item_sk#131, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, d_year#3945, d_year#3973, hd_income_band_sk#549, hd_income_band_sk#4005, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#4011, ca_street_name#4012, ca_city#4015, ca_zip#4018]
      :           :     :     :  +- BroadcastHashJoin [c_current_addr_sk#416], [ca_address_sk#4009], Inner, BuildRight, false
      :           :     :     :     :- Project [ss_item_sk#131, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_addr_sk#416, d_year#3945, d_year#3973, hd_income_band_sk#549, hd_income_band_sk#4005, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457]
      :           :     :     :     :  +- BroadcastHashJoin [ss_addr_sk#135], [ca_address_sk#448], Inner, BuildRight, false
      :           :     :     :     :     :- Project [ss_item_sk#131, ss_addr_sk#135, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_addr_sk#416, d_year#3945, d_year#3973, hd_income_band_sk#549, hd_income_band_sk#4005]
      :           :     :     :     :     :  +- BroadcastHashJoin [c_current_hdemo_sk#415], [hd_demo_sk#4004], Inner, BuildRight, false
      :           :     :     :     :     :     :- Project [ss_item_sk#131, ss_addr_sk#135, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_hdemo_sk#415, c_current_addr_sk#416, d_year#3945, d_year#3973, hd_income_band_sk#549]
      :           :     :     :     :     :     :  +- BroadcastHashJoin [ss_hdemo_sk#134], [hd_demo_sk#548], Inner, BuildRight, false
      :           :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_hdemo_sk#134, ss_addr_sk#135, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_hdemo_sk#415, c_current_addr_sk#416, d_year#3945, d_year#3973]
      :           :     :     :     :     :     :     :  +- BroadcastHashJoin [ss_promo_sk#137], [p_promo_sk#608], Inner, BuildRight, false
      :           :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_hdemo_sk#134, ss_addr_sk#135, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_hdemo_sk#415, c_current_addr_sk#416, d_year#3945, d_year#3973]
      :           :     :     :     :     :     :     :     :  +- BroadcastHashJoin [c_current_cdemo_sk#414], [cd_demo_sk#3995], Inner, BuildRight, NOT (cd_marital_status#476 = cd_marital_status#3997), false
      :           :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_hdemo_sk#134, ss_addr_sk#135, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_cdemo_sk#414, c_current_hdemo_sk#415, c_current_addr_sk#416, d_year#3945, d_year#3973, cd_marital_status#476]
      :           :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [ss_cdemo_sk#133], [cd_demo_sk#474], Inner, BuildRight, false
      :           :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_cdemo_sk#414, c_current_hdemo_sk#415, c_current_addr_sk#416, d_year#3945, d_year#3973]
      :           :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [c_first_shipto_date_sk#417], [d_date_sk#3967], Inner, BuildRight, false
      :           :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_cdemo_sk#414, c_current_hdemo_sk#415, c_current_addr_sk#416, c_first_shipto_date_sk#417, d_year#3945]
      :           :     :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [c_first_sales_date_sk#418], [d_date_sk#3939], Inner, BuildRight, false
      :           :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_cdemo_sk#414, c_current_hdemo_sk#415, c_current_addr_sk#416, c_first_shipto_date_sk#417, c_first_sales_date_sk#418]
      :           :     :     :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [ss_customer_sk#132], [c_customer_sk#412], Inner, BuildRight, false
      :           :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_customer_sk#132, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689]
      :           :     :     :     :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [ss_store_sk#136], [s_store_sk#664], Inner, BuildRight, false
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_customer_sk#132, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_store_sk#136, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498]
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [ss_sold_date_sk#152], [d_date_sk#492], Inner, BuildRight, false
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_customer_sk#132, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_store_sk#136, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, ss_sold_date_sk#152]
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- SortMergeJoin [ss_item_sk#131], [cs_item_sk#14], Inner
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_customer_sk#132, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_store_sk#136, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, ss_sold_date_sk#152]
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- SortMergeJoin [ss_item_sk#131, ss_ticket_number#138L], [sr_item_sk#177, sr_ticket_number#184L], Inner
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_customer_sk#132, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_store_sk#136, ss_promo_sk#137, ss_ticket_number#138L, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, ss_sold_date_sk#152]
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- Filter (((((((isnotnull(ss_item_sk#131) AND isnotnull(ss_ticket_number#138L)) AND isnotnull(ss_store_sk#136)) AND isnotnull(ss_customer_sk#132)) AND isnotnull(ss_cdemo_sk#133)) AND isnotnull(ss_promo_sk#137)) AND isnotnull(ss_hdemo_sk#134)) AND isnotnull(ss_addr_sk#135))
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- FileScan parquet [ss_item_sk#131,ss_customer_sk#132,ss_cdemo_sk#133,ss_hdemo_sk#134,ss_addr_sk#135,ss_store_sk#136,ss_promo_sk#137,ss_ticket_number#138L,ss_wholesale_cost#140,ss_list_price#141,ss_coupon_amt#148,ss_sold_date_sk#152] Batched: true, DataFilters: [isnotnull(ss_item_sk#131), isnotnull(ss_ticket_number#138L), isnotnull(ss_store_sk#136), isnotnu..., Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/store_sales], PartitionFilters: [isnotnull(ss_sold_date_sk#152), dynamicpruning#4167 [ss_sold_date_sk#152]], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_ticket_number), IsNotNull(ss_store_sk), IsNotNull(ss_custome..., ReadSchema: struct<ss_item_sk:int,ss_customer_sk:int,ss_cdemo_sk:int,ss_hdemo_sk:int,ss_addr_sk:int,ss_store_...
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- Project [d_date_sk#492, d_year#498]
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :              +- Filter ((isnotnull(d_year#498) AND (d_year#498 = 1999)) AND isnotnull(d_date_sk#492))
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                 +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [sr_item_sk#177, sr_ticket_number#184L]
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter (isnotnull(sr_item_sk#177) AND isnotnull(sr_ticket_number#184L))
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- FileScan parquet [sr_item_sk#177,sr_ticket_number#184L,sr_returned_date_sk#195] Batched: true, DataFilters: [isnotnull(sr_item_sk#177), isnotnull(sr_ticket_number#184L)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/store_returns], PartitionFilters: [], PushedFilters: [IsNotNull(sr_item_sk), IsNotNull(sr_ticket_number)], ReadSchema: struct<sr_item_sk:int,sr_ticket_number:bigint>
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [cs_item_sk#14]
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter (isnotnull(sum(cs_ext_list_price#24)#3932) AND (cast(sum(cs_ext_list_price#24)#3932 as decimal(21,2)) > CheckOverflow((2.00 * promote_precision(sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#90 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#91 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#92 as decimal(9,2)))), DecimalType(9,2), true))#3933)), DecimalType(21,2), true)))
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- HashAggregate(keys=[cs_item_sk#14], functions=[sum(UnscaledValue(cs_ext_list_price#24)), sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#90 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#91 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#92 as decimal(9,2)))), DecimalType(9,2), true))], output=[cs_item_sk#14, sum(cs_ext_list_price#24)#3932, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#90 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#91 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#92 as decimal(9,2)))), DecimalType(9,2), true))#3933])
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :              +- HashAggregate(keys=[cs_item_sk#14], functions=[partial_sum(UnscaledValue(cs_ext_list_price#24)), partial_sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#90 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#91 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#92 as decimal(9,2)))), DecimalType(9,2), true))], output=[cs_item_sk#14, sum#4180L, sum#4181, isEmpty#4182])
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                 +- Project [cs_item_sk#14, cs_ext_list_price#24, cr_refunded_cash#90, cr_reversed_charge#91, cr_store_credit#92]
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                    +- SortMergeJoin [cs_item_sk#14, cs_order_number#16L], [cr_item_sk#69, cr_order_number#83L], Inner
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                       :- Project [cs_item_sk#14, cs_order_number#16L, cs_ext_list_price#24]
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                       :  +- Filter (isnotnull(cs_item_sk#14) AND isnotnull(cs_order_number#16L))
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                       :     +- FileScan parquet [cs_item_sk#14,cs_order_number#16L,cs_ext_list_price#24,cs_sold_date_sk#33] Batched: true, DataFilters: [isnotnull(cs_item_sk#14), isnotnull(cs_order_number#16L)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/catalog_sales], PartitionFilters: [], PushedFilters: [IsNotNull(cs_item_sk), IsNotNull(cs_order_number)], ReadSchema: struct<cs_item_sk:int,cs_order_number:bigint,cs_ext_list_price:decimal(7,2)>
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                       +- Project [cr_item_sk#69, cr_order_number#83L, cr_refunded_cash#90, cr_reversed_charge#91, cr_store_credit#92]
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                          +- Filter (isnotnull(cr_item_sk#69) AND isnotnull(cr_order_number#83L))
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                             +- FileScan parquet [cr_item_sk#69,cr_order_number#83L,cr_refunded_cash#90,cr_reversed_charge#91,cr_store_credit#92,cr_returned_date_sk#94] Batched: true, DataFilters: [isnotnull(cr_item_sk#69), isnotnull(cr_order_number#83L)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/catalog_returns], PartitionFilters: [], PushedFilters: [IsNotNull(cr_item_sk), IsNotNull(cr_order_number)], ReadSchema: struct<cr_item_sk:int,cr_order_number:bigint,cr_refunded_cash:decimal(7,2),cr_reversed_charge:dec...
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [d_date_sk#492, d_year#498]
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter ((isnotnull(d_year#498) AND (d_year#498 = 1999)) AND isnotnull(d_date_sk#492))
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- FileScan parquet [d_date_sk#492,d_year#498] Batched: true, DataFilters: [isnotnull(d_year#498), (d_year#498 = 1999), isnotnull(d_date_sk#492)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), EqualTo(d_year,1999), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [s_store_sk#664, s_store_name#669, s_zip#689]
      :           :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter ((isnotnull(s_store_sk#664) AND isnotnull(s_store_name#669)) AND isnotnull(s_zip#689))
      :           :     :     :     :     :     :     :     :     :     :     :     :     :           +- FileScan parquet [s_store_sk#664,s_store_name#669,s_zip#689] Batched: true, DataFilters: [isnotnull(s_store_sk#664), isnotnull(s_store_name#669), isnotnull(s_zip#689)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/store], PartitionFilters: [], PushedFilters: [IsNotNull(s_store_sk), IsNotNull(s_store_name), IsNotNull(s_zip)], ReadSchema: struct<s_store_sk:int,s_store_name:string,s_zip:string>
      :           :     :     :     :     :     :     :     :     :     :     :     :     +- Project [c_customer_sk#412, c_current_cdemo_sk#414, c_current_hdemo_sk#415, c_current_addr_sk#416, c_first_shipto_date_sk#417, c_first_sales_date_sk#418]
      :           :     :     :     :     :     :     :     :     :     :     :     :        +- Filter (((((isnotnull(c_customer_sk#412) AND isnotnull(c_first_sales_date_sk#418)) AND isnotnull(c_first_shipto_date_sk#417)) AND isnotnull(c_current_cdemo_sk#414)) AND isnotnull(c_current_hdemo_sk#415)) AND isnotnull(c_current_addr_sk#416))
      :           :     :     :     :     :     :     :     :     :     :     :     :           +- FileScan parquet [c_customer_sk#412,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418] Batched: true, DataFilters: [isnotnull(c_customer_sk#412), isnotnull(c_first_sales_date_sk#418), isnotnull(c_first_shipto_dat..., Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/customer], PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk), IsNotNull(c_first_sales_date_sk), IsNotNull(c_first_shipto_date_sk), I..., ReadSchema: struct<c_customer_sk:int,c_current_cdemo_sk:int,c_current_hdemo_sk:int,c_current_addr_sk:int,c_fi...
      :           :     :     :     :     :     :     :     :     :     :     :     +- Project [d_date_sk#3939, d_year#3945]
      :           :     :     :     :     :     :     :     :     :     :     :        +- Filter isnotnull(d_date_sk#3939)
      :           :     :     :     :     :     :     :     :     :     :     :           +- FileScan parquet [d_date_sk#3939,d_year#3945] Batched: true, DataFilters: [isnotnull(d_date_sk#3939)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
      :           :     :     :     :     :     :     :     :     :     :     +- Project [d_date_sk#3967, d_year#3973]
      :           :     :     :     :     :     :     :     :     :     :        +- Filter isnotnull(d_date_sk#3967)
      :           :     :     :     :     :     :     :     :     :     :           +- FileScan parquet [d_date_sk#3967,d_year#3973] Batched: true, DataFilters: [isnotnull(d_date_sk#3967)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
      :           :     :     :     :     :     :     :     :     :     +- Project [cd_demo_sk#474, cd_marital_status#476]
      :           :     :     :     :     :     :     :     :     :        +- Filter (isnotnull(cd_demo_sk#474) AND isnotnull(cd_marital_status#476))
      :           :     :     :     :     :     :     :     :     :           +- FileScan parquet [cd_demo_sk#474,cd_marital_status#476] Batched: true, DataFilters: [isnotnull(cd_demo_sk#474), isnotnull(cd_marital_status#476)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/customer_demographics], PartitionFilters: [], PushedFilters: [IsNotNull(cd_demo_sk), IsNotNull(cd_marital_status)], ReadSchema: struct<cd_demo_sk:int,cd_marital_status:string>
      :           :     :     :     :     :     :     :     :     +- Project [cd_demo_sk#3995, cd_marital_status#3997]
      :           :     :     :     :     :     :     :     :        +- Filter (isnotnull(cd_demo_sk#3995) AND isnotnull(cd_marital_status#3997))
      :           :     :     :     :     :     :     :     :           +- FileScan parquet [cd_demo_sk#3995,cd_marital_status#3997] Batched: true, DataFilters: [isnotnull(cd_demo_sk#3995), isnotnull(cd_marital_status#3997)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/customer_demographics], PartitionFilters: [], PushedFilters: [IsNotNull(cd_demo_sk), IsNotNull(cd_marital_status)], ReadSchema: struct<cd_demo_sk:int,cd_marital_status:string>
      :           :     :     :     :     :     :     :     +- Project [p_promo_sk#608]
      :           :     :     :     :     :     :     :        +- Filter isnotnull(p_promo_sk#608)
      :           :     :     :     :     :     :     :           +- FileScan parquet [p_promo_sk#608] Batched: true, DataFilters: [isnotnull(p_promo_sk#608)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/promotion], PartitionFilters: [], PushedFilters: [IsNotNull(p_promo_sk)], ReadSchema: struct<p_promo_sk:int>
      :           :     :     :     :     :     :     +- Project [hd_demo_sk#548, hd_income_band_sk#549]
      :           :     :     :     :     :     :        +- Filter (isnotnull(hd_demo_sk#548) AND isnotnull(hd_income_band_sk#549))
      :           :     :     :     :     :     :           +- FileScan parquet [hd_demo_sk#548,hd_income_band_sk#549] Batched: true, DataFilters: [isnotnull(hd_demo_sk#548), isnotnull(hd_income_band_sk#549)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/household_demographics], PartitionFilters: [], PushedFilters: [IsNotNull(hd_demo_sk), IsNotNull(hd_income_band_sk)], ReadSchema: struct<hd_demo_sk:int,hd_income_band_sk:int>
      :           :     :     :     :     :     +- Project [hd_demo_sk#4004, hd_income_band_sk#4005]
      :           :     :     :     :     :        +- Filter (isnotnull(hd_demo_sk#4004) AND isnotnull(hd_income_band_sk#4005))
      :           :     :     :     :     :           +- FileScan parquet [hd_demo_sk#4004,hd_income_band_sk#4005] Batched: true, DataFilters: [isnotnull(hd_demo_sk#4004), isnotnull(hd_income_band_sk#4005)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/household_demographics], PartitionFilters: [], PushedFilters: [IsNotNull(hd_demo_sk), IsNotNull(hd_income_band_sk)], ReadSchema: struct<hd_demo_sk:int,hd_income_band_sk:int>
      :           :     :     :     :     +- Project [ca_address_sk#448, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457]
      :           :     :     :     :        +- Filter isnotnull(ca_address_sk#448)
      :           :     :     :     :           +- FileScan parquet [ca_address_sk#448,ca_street_number#450,ca_street_name#451,ca_city#454,ca_zip#457] Batched: true, DataFilters: [isnotnull(ca_address_sk#448)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/customer_address], PartitionFilters: [], PushedFilters: [IsNotNull(ca_address_sk)], ReadSchema: struct<ca_address_sk:int,ca_street_number:string,ca_street_name:string,ca_city:string,ca_zip:string>
      :           :     :     :     +- Project [ca_address_sk#4009, ca_street_number#4011, ca_street_name#4012, ca_city#4015, ca_zip#4018]
      :           :     :     :        +- Filter isnotnull(ca_address_sk#4009)
      :           :     :     :           +- FileScan parquet [ca_address_sk#4009,ca_street_number#4011,ca_street_name#4012,ca_city#4015,ca_zip#4018] Batched: true, DataFilters: [isnotnull(ca_address_sk#4009)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/customer_address], PartitionFilters: [], PushedFilters: [IsNotNull(ca_address_sk)], ReadSchema: struct<ca_address_sk:int,ca_street_number:string,ca_street_name:string,ca_city:string,ca_zip:string>
      :           :     :     +- Project [ib_income_band_sk#558]
      :           :     :        +- Filter isnotnull(ib_income_band_sk#558)
      :           :     :           +- FileScan parquet [ib_income_band_sk#558] Batched: true, DataFilters: [isnotnull(ib_income_band_sk#558)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/income_band], PartitionFilters: [], PushedFilters: [IsNotNull(ib_income_band_sk)], ReadSchema: struct<ib_income_band_sk:int>
      :           :     +- Project [ib_income_band_sk#4022]
      :           :        +- Filter isnotnull(ib_income_band_sk#4022)
      :           :           +- FileScan parquet [ib_income_band_sk#4022] Batched: true, DataFilters: [isnotnull(ib_income_band_sk#4022)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/income_band], PartitionFilters: [], PushedFilters: [IsNotNull(ib_income_band_sk)], ReadSchema: struct<ib_income_band_sk:int>
      :           +- Project [i_item_sk#564, i_product_name#585]
      :              +- Filter ((((((isnotnull(i_current_price#569) AND i_color#581 IN (purple,burlywood,indian,spring,floral,medium)) AND (i_current_price#569 >= 64.00)) AND (i_current_price#569 <= 74.00)) AND (i_current_price#569 >= 65.00)) AND (i_current_price#569 <= 79.00)) AND isnotnull(i_item_sk#564))
      :                 +- FileScan parquet [i_item_sk#564,i_current_price#569,i_color#581,i_product_name#585] Batched: true, DataFilters: [isnotnull(i_current_price#569), i_color#581 IN (purple,burlywood,indian,spring,floral,medium), (..., Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/item], PartitionFilters: [], PushedFilters: [IsNotNull(i_current_price), In(i_color, [purple,burlywood,indian,spring,floral,medium]), Greater..., ReadSchema: struct<i_item_sk:int,i_current_price:decimal(7,2),i_color:string,i_product_name:string>
      +- HashAggregate(keys=[i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#4097, ca_street_name#4098, ca_city#4101, ca_zip#4104, d_year#498, d_year#4031, d_year#4059], functions=[count(1), sum(UnscaledValue(ss_wholesale_cost#140)), sum(UnscaledValue(ss_list_price#141)), sum(UnscaledValue(ss_coupon_amt#148))], output=[item_sk#4124, store_name#4125, store_zip#4126, syear#4135, cnt#4138L, s1#4139, s2#4140, s3#4141])
         +- HashAggregate(keys=[i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#4097, ca_street_name#4098, ca_city#4101, ca_zip#4104, d_year#498, d_year#4031, d_year#4059], functions=[partial_count(1), partial_sum(UnscaledValue(ss_wholesale_cost#140)), partial_sum(UnscaledValue(ss_list_price#141)), partial_sum(UnscaledValue(ss_coupon_amt#148))], output=[i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#4097, ca_street_name#4098, ca_city#4101, ca_zip#4104, d_year#498, d_year#4031, d_year#4059, count#4187L, sum#4188L, sum#4189L, sum#4190L])
            +- Project [ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, d_year#4031, d_year#4059, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#4097, ca_street_name#4098, ca_city#4101, ca_zip#4104, i_item_sk#564, i_product_name#585]
               +- BroadcastHashJoin [ss_item_sk#131], [i_item_sk#564], Inner, BuildRight, false
                  :- Project [ss_item_sk#131, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, d_year#4031, d_year#4059, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#4097, ca_street_name#4098, ca_city#4101, ca_zip#4104]
                  :  +- BroadcastHashJoin [hd_income_band_sk#4091], [ib_income_band_sk#4108], Inner, BuildRight, false
                  :     :- Project [ss_item_sk#131, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, d_year#4031, d_year#4059, hd_income_band_sk#4091, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#4097, ca_street_name#4098, ca_city#4101, ca_zip#4104]
                  :     :  +- BroadcastHashJoin [hd_income_band_sk#549], [ib_income_band_sk#558], Inner, BuildRight, false
                  :     :     :- Project [ss_item_sk#131, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, d_year#4031, d_year#4059, hd_income_band_sk#549, hd_income_band_sk#4091, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#4097, ca_street_name#4098, ca_city#4101, ca_zip#4104]
                  :     :     :  +- BroadcastHashJoin [c_current_addr_sk#416], [ca_address_sk#4095], Inner, BuildRight, false
                  :     :     :     :- Project [ss_item_sk#131, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_addr_sk#416, d_year#4031, d_year#4059, hd_income_band_sk#549, hd_income_band_sk#4091, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457]
                  :     :     :     :  +- BroadcastHashJoin [ss_addr_sk#135], [ca_address_sk#448], Inner, BuildRight, false
                  :     :     :     :     :- Project [ss_item_sk#131, ss_addr_sk#135, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_addr_sk#416, d_year#4031, d_year#4059, hd_income_band_sk#549, hd_income_band_sk#4091]
                  :     :     :     :     :  +- BroadcastHashJoin [c_current_hdemo_sk#415], [hd_demo_sk#4090], Inner, BuildRight, false
                  :     :     :     :     :     :- Project [ss_item_sk#131, ss_addr_sk#135, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_hdemo_sk#415, c_current_addr_sk#416, d_year#4031, d_year#4059, hd_income_band_sk#549]
                  :     :     :     :     :     :  +- BroadcastHashJoin [ss_hdemo_sk#134], [hd_demo_sk#548], Inner, BuildRight, false
                  :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_hdemo_sk#134, ss_addr_sk#135, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_hdemo_sk#415, c_current_addr_sk#416, d_year#4031, d_year#4059]
                  :     :     :     :     :     :     :  +- BroadcastHashJoin [ss_promo_sk#137], [p_promo_sk#608], Inner, BuildRight, false
                  :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_hdemo_sk#134, ss_addr_sk#135, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_hdemo_sk#415, c_current_addr_sk#416, d_year#4031, d_year#4059]
                  :     :     :     :     :     :     :     :  +- BroadcastHashJoin [c_current_cdemo_sk#414], [cd_demo_sk#4081], Inner, BuildRight, NOT (cd_marital_status#476 = cd_marital_status#4083), false
                  :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_hdemo_sk#134, ss_addr_sk#135, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_cdemo_sk#414, c_current_hdemo_sk#415, c_current_addr_sk#416, d_year#4031, d_year#4059, cd_marital_status#476]
                  :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [ss_cdemo_sk#133], [cd_demo_sk#474], Inner, BuildRight, false
                  :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_cdemo_sk#414, c_current_hdemo_sk#415, c_current_addr_sk#416, d_year#4031, d_year#4059]
                  :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [c_first_shipto_date_sk#417], [d_date_sk#4053], Inner, BuildRight, false
                  :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_cdemo_sk#414, c_current_hdemo_sk#415, c_current_addr_sk#416, c_first_shipto_date_sk#417, d_year#4031]
                  :     :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [c_first_sales_date_sk#418], [d_date_sk#4025], Inner, BuildRight, false
                  :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_cdemo_sk#414, c_current_hdemo_sk#415, c_current_addr_sk#416, c_first_shipto_date_sk#417, c_first_sales_date_sk#418]
                  :     :     :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [ss_customer_sk#132], [c_customer_sk#412], Inner, BuildRight, false
                  :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_customer_sk#132, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689]
                  :     :     :     :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [ss_store_sk#136], [s_store_sk#664], Inner, BuildRight, false
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_customer_sk#132, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_store_sk#136, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498]
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [ss_sold_date_sk#152], [d_date_sk#492], Inner, BuildRight, false
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_customer_sk#132, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_store_sk#136, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, ss_sold_date_sk#152]
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- SortMergeJoin [ss_item_sk#131], [cs_item_sk#14], Inner
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_customer_sk#132, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_store_sk#136, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, ss_sold_date_sk#152]
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- SortMergeJoin [ss_item_sk#131, ss_ticket_number#138L], [sr_item_sk#177, sr_ticket_number#184L], Inner
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_customer_sk#132, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_store_sk#136, ss_promo_sk#137, ss_ticket_number#138L, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, ss_sold_date_sk#152]
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- Filter (((((((isnotnull(ss_item_sk#131) AND isnotnull(ss_ticket_number#138L)) AND isnotnull(ss_store_sk#136)) AND isnotnull(ss_customer_sk#132)) AND isnotnull(ss_cdemo_sk#133)) AND isnotnull(ss_promo_sk#137)) AND isnotnull(ss_hdemo_sk#134)) AND isnotnull(ss_addr_sk#135))
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- FileScan parquet [ss_item_sk#131,ss_customer_sk#132,ss_cdemo_sk#133,ss_hdemo_sk#134,ss_addr_sk#135,ss_store_sk#136,ss_promo_sk#137,ss_ticket_number#138L,ss_wholesale_cost#140,ss_list_price#141,ss_coupon_amt#148,ss_sold_date_sk#152] Batched: true, DataFilters: [isnotnull(ss_item_sk#131), isnotnull(ss_ticket_number#138L), isnotnull(ss_store_sk#136), isnotnu..., Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/store_sales], PartitionFilters: [isnotnull(ss_sold_date_sk#152), dynamicpruning#4168 [ss_sold_date_sk#152]], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_ticket_number), IsNotNull(ss_store_sk), IsNotNull(ss_custome..., ReadSchema: struct<ss_item_sk:int,ss_customer_sk:int,ss_cdemo_sk:int,ss_hdemo_sk:int,ss_addr_sk:int,ss_store_...
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- Project [d_date_sk#492, d_year#498]
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :              +- Filter ((isnotnull(d_year#498) AND (d_year#498 = 2000)) AND isnotnull(d_date_sk#492))
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                 +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [sr_item_sk#177, sr_ticket_number#184L]
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter (isnotnull(sr_item_sk#177) AND isnotnull(sr_ticket_number#184L))
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- FileScan parquet [sr_item_sk#177,sr_ticket_number#184L,sr_returned_date_sk#195] Batched: true, DataFilters: [isnotnull(sr_item_sk#177), isnotnull(sr_ticket_number#184L)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/store_returns], PartitionFilters: [], PushedFilters: [IsNotNull(sr_item_sk), IsNotNull(sr_ticket_number)], ReadSchema: struct<sr_item_sk:int,sr_ticket_number:bigint>
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [cs_item_sk#14]
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter (isnotnull(sum(cs_ext_list_price#24)#3937) AND (cast(sum(cs_ext_list_price#24)#3937 as decimal(21,2)) > CheckOverflow((2.00 * promote_precision(sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#90 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#91 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#92 as decimal(9,2)))), DecimalType(9,2), true))#3938)), DecimalType(21,2), true)))
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- HashAggregate(keys=[cs_item_sk#14], functions=[sum(UnscaledValue(cs_ext_list_price#24)), sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#90 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#91 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#92 as decimal(9,2)))), DecimalType(9,2), true))], output=[cs_item_sk#14, sum(cs_ext_list_price#24)#3937, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#90 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#91 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#92 as decimal(9,2)))), DecimalType(9,2), true))#3938])
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :              +- HashAggregate(keys=[cs_item_sk#14], functions=[partial_sum(UnscaledValue(cs_ext_list_price#24)), partial_sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#90 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#91 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#92 as decimal(9,2)))), DecimalType(9,2), true))], output=[cs_item_sk#14, sum#4194L, sum#4195, isEmpty#4196])
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                 +- Project [cs_item_sk#14, cs_ext_list_price#24, cr_refunded_cash#90, cr_reversed_charge#91, cr_store_credit#92]
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                    +- SortMergeJoin [cs_item_sk#14, cs_order_number#16L], [cr_item_sk#69, cr_order_number#83L], Inner
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                       :- Project [cs_item_sk#14, cs_order_number#16L, cs_ext_list_price#24]
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                       :  +- Filter (isnotnull(cs_item_sk#14) AND isnotnull(cs_order_number#16L))
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                       :     +- FileScan parquet [cs_item_sk#14,cs_order_number#16L,cs_ext_list_price#24,cs_sold_date_sk#33] Batched: true, DataFilters: [isnotnull(cs_item_sk#14), isnotnull(cs_order_number#16L)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/catalog_sales], PartitionFilters: [], PushedFilters: [IsNotNull(cs_item_sk), IsNotNull(cs_order_number)], ReadSchema: struct<cs_item_sk:int,cs_order_number:bigint,cs_ext_list_price:decimal(7,2)>
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                       +- Project [cr_item_sk#69, cr_order_number#83L, cr_refunded_cash#90, cr_reversed_charge#91, cr_store_credit#92]
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                          +- Filter (isnotnull(cr_item_sk#69) AND isnotnull(cr_order_number#83L))
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                             +- FileScan parquet [cr_item_sk#69,cr_order_number#83L,cr_refunded_cash#90,cr_reversed_charge#91,cr_store_credit#92,cr_returned_date_sk#94] Batched: true, DataFilters: [isnotnull(cr_item_sk#69), isnotnull(cr_order_number#83L)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/catalog_returns], PartitionFilters: [], PushedFilters: [IsNotNull(cr_item_sk), IsNotNull(cr_order_number)], ReadSchema: struct<cr_item_sk:int,cr_order_number:bigint,cr_refunded_cash:decimal(7,2),cr_reversed_charge:dec...
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [d_date_sk#492, d_year#498]
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter ((isnotnull(d_year#498) AND (d_year#498 = 2000)) AND isnotnull(d_date_sk#492))
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- FileScan parquet [d_date_sk#492,d_year#498] Batched: true, DataFilters: [isnotnull(d_year#498), (d_year#498 = 2000), isnotnull(d_date_sk#492)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), EqualTo(d_year,2000), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
                  :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [s_store_sk#664, s_store_name#669, s_zip#689]
                  :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter ((isnotnull(s_store_sk#664) AND isnotnull(s_store_name#669)) AND isnotnull(s_zip#689))
                  :     :     :     :     :     :     :     :     :     :     :     :     :           +- FileScan parquet [s_store_sk#664,s_store_name#669,s_zip#689] Batched: true, DataFilters: [isnotnull(s_store_sk#664), isnotnull(s_store_name#669), isnotnull(s_zip#689)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/store], PartitionFilters: [], PushedFilters: [IsNotNull(s_store_sk), IsNotNull(s_store_name), IsNotNull(s_zip)], ReadSchema: struct<s_store_sk:int,s_store_name:string,s_zip:string>
                  :     :     :     :     :     :     :     :     :     :     :     :     +- Project [c_customer_sk#412, c_current_cdemo_sk#414, c_current_hdemo_sk#415, c_current_addr_sk#416, c_first_shipto_date_sk#417, c_first_sales_date_sk#418]
                  :     :     :     :     :     :     :     :     :     :     :     :        +- Filter (((((isnotnull(c_customer_sk#412) AND isnotnull(c_first_sales_date_sk#418)) AND isnotnull(c_first_shipto_date_sk#417)) AND isnotnull(c_current_cdemo_sk#414)) AND isnotnull(c_current_hdemo_sk#415)) AND isnotnull(c_current_addr_sk#416))
                  :     :     :     :     :     :     :     :     :     :     :     :           +- FileScan parquet [c_customer_sk#412,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418] Batched: true, DataFilters: [isnotnull(c_customer_sk#412), isnotnull(c_first_sales_date_sk#418), isnotnull(c_first_shipto_dat..., Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/customer], PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk), IsNotNull(c_first_sales_date_sk), IsNotNull(c_first_shipto_date_sk), I..., ReadSchema: struct<c_customer_sk:int,c_current_cdemo_sk:int,c_current_hdemo_sk:int,c_current_addr_sk:int,c_fi...
                  :     :     :     :     :     :     :     :     :     :     :     +- Project [d_date_sk#4025, d_year#4031]
                  :     :     :     :     :     :     :     :     :     :     :        +- Filter isnotnull(d_date_sk#4025)
                  :     :     :     :     :     :     :     :     :     :     :           +- FileScan parquet [d_date_sk#4025,d_year#4031] Batched: true, DataFilters: [isnotnull(d_date_sk#4025)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
                  :     :     :     :     :     :     :     :     :     :     +- Project [d_date_sk#4053, d_year#4059]
                  :     :     :     :     :     :     :     :     :     :        +- Filter isnotnull(d_date_sk#4053)
                  :     :     :     :     :     :     :     :     :     :           +- FileScan parquet [d_date_sk#4053,d_year#4059] Batched: true, DataFilters: [isnotnull(d_date_sk#4053)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
                  :     :     :     :     :     :     :     :     :     +- Project [cd_demo_sk#474, cd_marital_status#476]
                  :     :     :     :     :     :     :     :     :        +- Filter (isnotnull(cd_demo_sk#474) AND isnotnull(cd_marital_status#476))
                  :     :     :     :     :     :     :     :     :           +- FileScan parquet [cd_demo_sk#474,cd_marital_status#476] Batched: true, DataFilters: [isnotnull(cd_demo_sk#474), isnotnull(cd_marital_status#476)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/customer_demographics], PartitionFilters: [], PushedFilters: [IsNotNull(cd_demo_sk), IsNotNull(cd_marital_status)], ReadSchema: struct<cd_demo_sk:int,cd_marital_status:string>
                  :     :     :     :     :     :     :     :     +- Project [cd_demo_sk#4081, cd_marital_status#4083]
                  :     :     :     :     :     :     :     :        +- Filter (isnotnull(cd_demo_sk#4081) AND isnotnull(cd_marital_status#4083))
                  :     :     :     :     :     :     :     :           +- FileScan parquet [cd_demo_sk#4081,cd_marital_status#4083] Batched: true, DataFilters: [isnotnull(cd_demo_sk#4081), isnotnull(cd_marital_status#4083)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/customer_demographics], PartitionFilters: [], PushedFilters: [IsNotNull(cd_demo_sk), IsNotNull(cd_marital_status)], ReadSchema: struct<cd_demo_sk:int,cd_marital_status:string>
                  :     :     :     :     :     :     :     +- Project [p_promo_sk#608]
                  :     :     :     :     :     :     :        +- Filter isnotnull(p_promo_sk#608)
                  :     :     :     :     :     :     :           +- FileScan parquet [p_promo_sk#608] Batched: true, DataFilters: [isnotnull(p_promo_sk#608)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/promotion], PartitionFilters: [], PushedFilters: [IsNotNull(p_promo_sk)], ReadSchema: struct<p_promo_sk:int>
                  :     :     :     :     :     :     +- Project [hd_demo_sk#548, hd_income_band_sk#549]
                  :     :     :     :     :     :        +- Filter (isnotnull(hd_demo_sk#548) AND isnotnull(hd_income_band_sk#549))
                  :     :     :     :     :     :           +- FileScan parquet [hd_demo_sk#548,hd_income_band_sk#549] Batched: true, DataFilters: [isnotnull(hd_demo_sk#548), isnotnull(hd_income_band_sk#549)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/household_demographics], PartitionFilters: [], PushedFilters: [IsNotNull(hd_demo_sk), IsNotNull(hd_income_band_sk)], ReadSchema: struct<hd_demo_sk:int,hd_income_band_sk:int>
                  :     :     :     :     :     +- Project [hd_demo_sk#4090, hd_income_band_sk#4091]
                  :     :     :     :     :        +- Filter (isnotnull(hd_demo_sk#4090) AND isnotnull(hd_income_band_sk#4091))
                  :     :     :     :     :           +- FileScan parquet [hd_demo_sk#4090,hd_income_band_sk#4091] Batched: true, DataFilters: [isnotnull(hd_demo_sk#4090), isnotnull(hd_income_band_sk#4091)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/household_demographics], PartitionFilters: [], PushedFilters: [IsNotNull(hd_demo_sk), IsNotNull(hd_income_band_sk)], ReadSchema: struct<hd_demo_sk:int,hd_income_band_sk:int>
                  :     :     :     :     +- Project [ca_address_sk#448, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457]
                  :     :     :     :        +- Filter isnotnull(ca_address_sk#448)
                  :     :     :     :           +- FileScan parquet [ca_address_sk#448,ca_street_number#450,ca_street_name#451,ca_city#454,ca_zip#457] Batched: true, DataFilters: [isnotnull(ca_address_sk#448)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/customer_address], PartitionFilters: [], PushedFilters: [IsNotNull(ca_address_sk)], ReadSchema: struct<ca_address_sk:int,ca_street_number:string,ca_street_name:string,ca_city:string,ca_zip:string>
                  :     :     :     +- Project [ca_address_sk#4095, ca_street_number#4097, ca_street_name#4098, ca_city#4101, ca_zip#4104]
                  :     :     :        +- Filter isnotnull(ca_address_sk#4095)
                  :     :     :           +- FileScan parquet [ca_address_sk#4095,ca_street_number#4097,ca_street_name#4098,ca_city#4101,ca_zip#4104] Batched: true, DataFilters: [isnotnull(ca_address_sk#4095)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/customer_address], PartitionFilters: [], PushedFilters: [IsNotNull(ca_address_sk)], ReadSchema: struct<ca_address_sk:int,ca_street_number:string,ca_street_name:string,ca_city:string,ca_zip:string>
                  :     :     +- Project [ib_income_band_sk#558]
                  :     :        +- Filter isnotnull(ib_income_band_sk#558)
                  :     :           +- FileScan parquet [ib_income_band_sk#558] Batched: true, DataFilters: [isnotnull(ib_income_band_sk#558)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/income_band], PartitionFilters: [], PushedFilters: [IsNotNull(ib_income_band_sk)], ReadSchema: struct<ib_income_band_sk:int>
                  :     +- Project [ib_income_band_sk#4108]
                  :        +- Filter isnotnull(ib_income_band_sk#4108)
                  :           +- FileScan parquet [ib_income_band_sk#4108] Batched: true, DataFilters: [isnotnull(ib_income_band_sk#4108)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/income_band], PartitionFilters: [], PushedFilters: [IsNotNull(ib_income_band_sk)], ReadSchema: struct<ib_income_band_sk:int>
                  +- Project [i_item_sk#564, i_product_name#585]
                     +- Filter ((((((isnotnull(i_current_price#569) AND i_color#581 IN (purple,burlywood,indian,spring,floral,medium)) AND (i_current_price#569 >= 64.00)) AND (i_current_price#569 <= 74.00)) AND (i_current_price#569 >= 65.00)) AND (i_current_price#569 <= 79.00)) AND isnotnull(i_item_sk#564))
                        +- FileScan parquet [i_item_sk#564,i_current_price#569,i_color#581,i_product_name#585] Batched: true, DataFilters: [isnotnull(i_current_price#569), i_color#581 IN (purple,burlywood,indian,spring,floral,medium), (..., Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/item], PartitionFilters: [], PushedFilters: [IsNotNull(i_current_price), In(i_color, [purple,burlywood,indian,spring,floral,medium]), Greater..., ReadSchema: struct<i_item_sk:int,i_current_price:decimal(7,2),i_color:string,i_product_name:string>
.
Execution time: 115.96094463300001s
Running execution q70-v2.4 iteration: 2, StandardRun=true
2022-09-08 15:17:54,574 WARN adaptive.InsertAdaptiveSparkPlan: spark.sql.adaptive.enabled is enabled but is not supported for query: TakeOrderedAndProject(limit=100, orderBy=[lochierarchy#4233 DESC NULLS LAST,CASE WHEN (lochierarchy#4233 = 0) THEN s_state#4252 END ASC NULLS FIRST,rank_within_parent#4234 ASC NULLS FIRST], output=[total_sum#4232,s_state#4252,s_county#4253,lochierarchy#4233,rank_within_parent#4234])
+- Project [total_sum#4232, s_state#4252, s_county#4253, lochierarchy#4233, rank_within_parent#4234]
   +- Window [rank(_w3#4268) windowspecdefinition(_w1#4266, _w2#4267, _w3#4268 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rank_within_parent#4234], [_w1#4266, _w2#4267], [_w3#4268 DESC NULLS LAST]
      +- HashAggregate(keys=[s_state#4252, s_county#4253, spark_grouping_id#4251L], functions=[sum(UnscaledValue(ss_net_profit#151))], output=[total_sum#4232, s_state#4252, s_county#4253, lochierarchy#4233, _w1#4266, _w2#4267, _w3#4268])
         +- HashAggregate(keys=[s_state#4252, s_county#4253, spark_grouping_id#4251L], functions=[partial_sum(UnscaledValue(ss_net_profit#151))], output=[s_state#4252, s_county#4253, spark_grouping_id#4251L, sum#4293L])
            +- Expand [List(ss_net_profit#151, s_state#688, s_county#687, 0), List(ss_net_profit#151, s_state#688, null, 1), List(ss_net_profit#151, null, null, 3)], [ss_net_profit#151, s_state#4252, s_county#4253, spark_grouping_id#4251L]
               +- Project [ss_net_profit#151, s_state#688, s_county#687]
                  +- BroadcastHashJoin [ss_store_sk#136], [s_store_sk#664], Inner, BuildRight, false
                     :- Project [ss_store_sk#136, ss_net_profit#151]
                     :  +- BroadcastHashJoin [ss_sold_date_sk#152], [d_date_sk#492], Inner, BuildRight, false
                     :     :- Project [ss_store_sk#136, ss_net_profit#151, ss_sold_date_sk#152]
                     :     :  +- Filter isnotnull(ss_store_sk#136)
                     :     :     +- FileScan parquet [ss_store_sk#136,ss_net_profit#151,ss_sold_date_sk#152] Batched: true, DataFilters: [isnotnull(ss_store_sk#136)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/store_sales], PartitionFilters: [isnotnull(ss_sold_date_sk#152), dynamicpruning#4290 [ss_sold_date_sk#152]], PushedFilters: [IsNotNull(ss_store_sk)], ReadSchema: struct<ss_store_sk:int,ss_net_profit:decimal(7,2)>
                     :     :           +- Project [d_date_sk#492]
                     :     :              +- Filter (((isnotnull(d_month_seq#495) AND (d_month_seq#495 >= 1200)) AND (d_month_seq#495 <= 1211)) AND isnotnull(d_date_sk#492))
                     :     :                 +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :     +- Project [d_date_sk#492]
                     :        +- Filter (((isnotnull(d_month_seq#495) AND (d_month_seq#495 >= 1200)) AND (d_month_seq#495 <= 1211)) AND isnotnull(d_date_sk#492))
                     :           +- FileScan parquet [d_date_sk#492,d_month_seq#495] Batched: true, DataFilters: [isnotnull(d_month_seq#495), (d_month_seq#495 >= 1200), (d_month_seq#495 <= 1211), isnotnull(d_da..., Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_month_seq), GreaterThanOrEqual(d_month_seq,1200), LessThanOrEqual(d_month_seq,1211),..., ReadSchema: struct<d_date_sk:int,d_month_seq:int>
                     +- SortMergeJoin [s_state#688], [s_state#4229], LeftSemi
                        :- Project [s_store_sk#664, s_county#687, s_state#688]
                        :  +- Filter isnotnull(s_store_sk#664)
                        :     +- FileScan parquet [s_store_sk#664,s_county#687,s_state#688] Batched: true, DataFilters: [isnotnull(s_store_sk#664)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/store], PartitionFilters: [], PushedFilters: [IsNotNull(s_store_sk)], ReadSchema: struct<s_store_sk:int,s_county:string,s_state:string>
                        +- Project [s_state#4229]
                           +- Filter (isnotnull(ranking#4230) AND (ranking#4230 <= 5))
                              +- Window [rank(_w1#4240) windowspecdefinition(s_state#688, _w1#4240 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS ranking#4230], [s_state#688], [_w1#4240 DESC NULLS LAST]
                                 +- HashAggregate(keys=[s_state#688], functions=[sum(UnscaledValue(ss_net_profit#151))], output=[s_state#4229, s_state#688, _w1#4240])
                                    +- HashAggregate(keys=[s_state#688], functions=[partial_sum(UnscaledValue(ss_net_profit#151))], output=[s_state#688, sum#4295L])
                                       +- Project [ss_net_profit#151, s_state#688]
                                          +- BroadcastHashJoin [ss_sold_date_sk#152], [d_date_sk#492], Inner, BuildRight, false
                                             :- Project [ss_net_profit#151, ss_sold_date_sk#152, s_state#688]
                                             :  +- BroadcastHashJoin [ss_store_sk#136], [s_store_sk#664], Inner, BuildRight, false
                                             :     :- Project [ss_store_sk#136, ss_net_profit#151, ss_sold_date_sk#152]
                                             :     :  +- Filter isnotnull(ss_store_sk#136)
                                             :     :     +- FileScan parquet [ss_store_sk#136,ss_net_profit#151,ss_sold_date_sk#152] Batched: true, DataFilters: [isnotnull(ss_store_sk#136)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/store_sales], PartitionFilters: [isnotnull(ss_sold_date_sk#152), dynamicpruning#4283 [ss_sold_date_sk#152]], PushedFilters: [IsNotNull(ss_store_sk)], ReadSchema: struct<ss_store_sk:int,ss_net_profit:decimal(7,2)>
                                             :     :           +- Project [d_date_sk#492]
                                             :     :              +- Filter (((isnotnull(d_month_seq#495) AND (d_month_seq#495 >= 1200)) AND (d_month_seq#495 <= 1211)) AND isnotnull(d_date_sk#492))
                                             :     :                 +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                                             :     +- Project [s_store_sk#664, s_state#688]
                                             :        +- Filter isnotnull(s_store_sk#664)
                                             :           +- FileScan parquet [s_store_sk#664,s_state#688] Batched: true, DataFilters: [isnotnull(s_store_sk#664)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/store], PartitionFilters: [], PushedFilters: [IsNotNull(s_store_sk)], ReadSchema: struct<s_store_sk:int,s_state:string>
                                             +- Project [d_date_sk#492]
                                                +- Filter (((isnotnull(d_month_seq#495) AND (d_month_seq#495 >= 1200)) AND (d_month_seq#495 <= 1211)) AND isnotnull(d_date_sk#492))
                                                   +- FileScan parquet [d_date_sk#492,d_month_seq#495] Batched: true, DataFilters: [isnotnull(d_month_seq#495), (d_month_seq#495 >= 1200), (d_month_seq#495 <= 1211), isnotnull(d_da..., Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_month_seq), GreaterThanOrEqual(d_month_seq,1200), LessThanOrEqual(d_month_seq,1211),..., ReadSchema: struct<d_date_sk:int,d_month_seq:int>
.
2022-09-08 15:17:54,728 INFO perf.Query: 
== Query: q70-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [lochierarchy#4319 DESC NULLS LAST, CASE WHEN (cast(lochierarchy#4319 as int) = 0) THEN s_state#4338 END ASC NULLS FIRST, rank_within_parent#4320 ASC NULLS FIRST], true
      +- Project [total_sum#4318, s_state#4338, s_county#4339, lochierarchy#4319, rank_within_parent#4320]
         +- Project [total_sum#4318, s_state#4338, s_county#4339, lochierarchy#4319, _w0#4348, _w1#4352, _w2#4353, _w3#4354, rank_within_parent#4320, rank_within_parent#4320]
            +- Window [rank(_w3#4354) windowspecdefinition(_w1#4352, _w2#4353, _w3#4354 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rank_within_parent#4320], [_w1#4352, _w2#4353], [_w3#4354 DESC NULLS LAST]
               +- Aggregate [s_state#4338, s_county#4339, spark_grouping_id#4337L], [sum(ss_net_profit#151) AS total_sum#4318, s_state#4338, s_county#4339, (cast((shiftright(spark_grouping_id#4337L, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#4337L, 0) & 1) as tinyint)) AS lochierarchy#4319, sum(ss_net_profit#151) AS _w0#4348, (cast((shiftright(spark_grouping_id#4337L, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#4337L, 0) & 1) as tinyint)) AS _w1#4352, CASE WHEN (cast(cast((shiftright(spark_grouping_id#4337L, 0) & 1) as tinyint) as int) = 0) THEN s_state#4338 END AS _w2#4353, sum(ss_net_profit#151) AS _w3#4354]
                  +- Expand [List(ss_sold_time_sk#130, ss_item_sk#131, ss_customer_sk#132, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_store_sk#136, ss_promo_sk#137, ss_ticket_number#138L, ss_quantity#139, ss_wholesale_cost#140, ss_list_price#141, ss_sales_price#142, ss_ext_discount_amt#143, ss_ext_sales_price#144, ss_ext_wholesale_cost#145, ss_ext_list_price#146, ss_ext_tax#147, ss_coupon_amt#148, ss_net_paid#149, ss_net_paid_inc_tax#150, ss_net_profit#151, ss_sold_date_sk#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, s_state#4335, s_county#4336, 0), List(ss_sold_time_sk#130, ss_item_sk#131, ss_customer_sk#132, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_store_sk#136, ss_promo_sk#137, ss_ticket_number#138L, ss_quantity#139, ss_wholesale_cost#140, ss_list_price#141, ss_sales_price#142, ss_ext_discount_amt#143, ss_ext_sales_price#144, ss_ext_wholesale_cost#145, ss_ext_list_price#146, ss_ext_tax#147, ss_coupon_amt#148, ss_net_paid#149, ss_net_paid_inc_tax#150, ss_net_profit#151, ss_sold_date_sk#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, s_state#4335, null, 1), List(ss_sold_time_sk#130, ss_item_sk#131, ss_customer_sk#132, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_store_sk#136, ss_promo_sk#137, ss_ticket_number#138L, ss_quantity#139, ss_wholesale_cost#140, ss_list_price#141, ss_sales_price#142, ss_ext_discount_amt#143, ss_ext_sales_price#144, ss_ext_wholesale_cost#145, ss_ext_list_price#146, ss_ext_tax#147, ss_coupon_amt#148, ss_net_paid#149, ss_net_paid_inc_tax#150, ss_net_profit#151, ss_sold_date_sk#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, null, null, 3)], [ss_sold_time_sk#130, ss_item_sk#131, ss_customer_sk#132, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_store_sk#136, ss_promo_sk#137, ss_ticket_number#138L, ss_quantity#139, ss_wholesale_cost#140, ss_list_price#141, ss_sales_price#142, ss_ext_discount_amt#143, ss_ext_sales_price#144, ss_ext_wholesale_cost#145, ss_ext_list_price#146, ss_ext_tax#147, ss_coupon_amt#148, ss_net_paid#149, ss_net_paid_inc_tax#150, ss_net_profit#151, ss_sold_date_sk#152, d_date_sk#492, ... 59 more fields]
                     +- Project [ss_sold_time_sk#130, ss_item_sk#131, ss_customer_sk#132, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_store_sk#136, ss_promo_sk#137, ss_ticket_number#138L, ss_quantity#139, ss_wholesale_cost#140, ss_list_price#141, ss_sales_price#142, ss_ext_discount_amt#143, ss_ext_sales_price#144, ss_ext_wholesale_cost#145, ss_ext_list_price#146, ss_ext_tax#147, ss_coupon_amt#148, ss_net_paid#149, ss_net_paid_inc_tax#150, ss_net_profit#151, ss_sold_date_sk#152, d_date_sk#492, ... 58 more fields]
                        +- Filter ((((d_month_seq#495 >= 1200) AND (d_month_seq#495 <= (1200 + 11))) AND (d_date_sk#492 = ss_sold_date_sk#152)) AND ((s_store_sk#664 = ss_store_sk#136) AND s_state#688 IN (list#4317 [])))
                           :  +- Project [s_state#4315]
                           :     +- Filter (ranking#4316 <= 5)
                           :        +- SubqueryAlias tmp1
                           :           +- Project [s_state#4315, ranking#4316]
                           :              +- Project [s_state#4315, s_state#688, _w1#4326, ranking#4316, ranking#4316]
                           :                 +- Window [rank(_w1#4326) windowspecdefinition(s_state#688, _w1#4326 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS ranking#4316], [s_state#688], [_w1#4326 DESC NULLS LAST]
                           :                    +- Aggregate [s_state#688], [s_state#688 AS s_state#4315, s_state#688, sum(ss_net_profit#151) AS _w1#4326]
                           :                       +- Filter ((((d_month_seq#495 >= 1200) AND (d_month_seq#495 <= (1200 + 11))) AND (d_date_sk#492 = ss_sold_date_sk#152)) AND (s_store_sk#664 = ss_store_sk#136))
                           :                          +- Join Inner
                           :                             :- Join Inner
                           :                             :  :- SubqueryAlias store_sales
                           :                             :  :  +- Relation[ss_sold_time_sk#130,ss_item_sk#131,ss_customer_sk#132,ss_cdemo_sk#133,ss_hdemo_sk#134,ss_addr_sk#135,ss_store_sk#136,ss_promo_sk#137,ss_ticket_number#138L,ss_quantity#139,ss_wholesale_cost#140,ss_list_price#141,ss_sales_price#142,ss_ext_discount_amt#143,ss_ext_sales_price#144,ss_ext_wholesale_cost#145,ss_ext_list_price#146,ss_ext_tax#147,ss_coupon_amt#148,ss_net_paid#149,ss_net_paid_inc_tax#150,ss_net_profit#151,ss_sold_date_sk#152] parquet
                           :                             :  +- SubqueryAlias store
                           :                             :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                           :                             +- SubqueryAlias date_dim
                           :                                +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                           +- Join Inner
                              :- Join Inner
                              :  :- SubqueryAlias store_sales
                              :  :  +- Relation[ss_sold_time_sk#130,ss_item_sk#131,ss_customer_sk#132,ss_cdemo_sk#133,ss_hdemo_sk#134,ss_addr_sk#135,ss_store_sk#136,ss_promo_sk#137,ss_ticket_number#138L,ss_quantity#139,ss_wholesale_cost#140,ss_list_price#141,ss_sales_price#142,ss_ext_discount_amt#143,ss_ext_sales_price#144,ss_ext_wholesale_cost#145,ss_ext_list_price#146,ss_ext_tax#147,ss_coupon_amt#148,ss_net_paid#149,ss_net_paid_inc_tax#150,ss_net_profit#151,ss_sold_date_sk#152] parquet
                              :  +- SubqueryAlias d1
                              :     +- SubqueryAlias date_dim
                              :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                              +- SubqueryAlias store
                                 +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet

     : benchmark
2022-09-08 15:17:54,867 INFO perf.Query: 
== Query: q70-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [lochierarchy#4373 DESC NULLS LAST, CASE WHEN (cast(lochierarchy#4373 as int) = 0) THEN s_state#4392 END ASC NULLS FIRST, rank_within_parent#4374 ASC NULLS FIRST], true
      +- Project [total_sum#4372, s_state#4392, s_county#4393, lochierarchy#4373, rank_within_parent#4374]
         +- Project [total_sum#4372, s_state#4392, s_county#4393, lochierarchy#4373, _w0#4402, _w1#4406, _w2#4407, _w3#4408, rank_within_parent#4374, rank_within_parent#4374]
            +- Window [rank(_w3#4408) windowspecdefinition(_w1#4406, _w2#4407, _w3#4408 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rank_within_parent#4374], [_w1#4406, _w2#4407], [_w3#4408 DESC NULLS LAST]
               +- Aggregate [s_state#4392, s_county#4393, spark_grouping_id#4391L], [sum(ss_net_profit#151) AS total_sum#4372, s_state#4392, s_county#4393, (cast((shiftright(spark_grouping_id#4391L, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#4391L, 0) & 1) as tinyint)) AS lochierarchy#4373, sum(ss_net_profit#151) AS _w0#4402, (cast((shiftright(spark_grouping_id#4391L, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#4391L, 0) & 1) as tinyint)) AS _w1#4406, CASE WHEN (cast(cast((shiftright(spark_grouping_id#4391L, 0) & 1) as tinyint) as int) = 0) THEN s_state#4392 END AS _w2#4407, sum(ss_net_profit#151) AS _w3#4408]
                  +- Expand [List(ss_sold_time_sk#130, ss_item_sk#131, ss_customer_sk#132, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_store_sk#136, ss_promo_sk#137, ss_ticket_number#138L, ss_quantity#139, ss_wholesale_cost#140, ss_list_price#141, ss_sales_price#142, ss_ext_discount_amt#143, ss_ext_sales_price#144, ss_ext_wholesale_cost#145, ss_ext_list_price#146, ss_ext_tax#147, ss_coupon_amt#148, ss_net_paid#149, ss_net_paid_inc_tax#150, ss_net_profit#151, ss_sold_date_sk#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, s_state#4389, s_county#4390, 0), List(ss_sold_time_sk#130, ss_item_sk#131, ss_customer_sk#132, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_store_sk#136, ss_promo_sk#137, ss_ticket_number#138L, ss_quantity#139, ss_wholesale_cost#140, ss_list_price#141, ss_sales_price#142, ss_ext_discount_amt#143, ss_ext_sales_price#144, ss_ext_wholesale_cost#145, ss_ext_list_price#146, ss_ext_tax#147, ss_coupon_amt#148, ss_net_paid#149, ss_net_paid_inc_tax#150, ss_net_profit#151, ss_sold_date_sk#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, s_state#4389, null, 1), List(ss_sold_time_sk#130, ss_item_sk#131, ss_customer_sk#132, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_store_sk#136, ss_promo_sk#137, ss_ticket_number#138L, ss_quantity#139, ss_wholesale_cost#140, ss_list_price#141, ss_sales_price#142, ss_ext_discount_amt#143, ss_ext_sales_price#144, ss_ext_wholesale_cost#145, ss_ext_list_price#146, ss_ext_tax#147, ss_coupon_amt#148, ss_net_paid#149, ss_net_paid_inc_tax#150, ss_net_profit#151, ss_sold_date_sk#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, null, null, 3)], [ss_sold_time_sk#130, ss_item_sk#131, ss_customer_sk#132, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_store_sk#136, ss_promo_sk#137, ss_ticket_number#138L, ss_quantity#139, ss_wholesale_cost#140, ss_list_price#141, ss_sales_price#142, ss_ext_discount_amt#143, ss_ext_sales_price#144, ss_ext_wholesale_cost#145, ss_ext_list_price#146, ss_ext_tax#147, ss_coupon_amt#148, ss_net_paid#149, ss_net_paid_inc_tax#150, ss_net_profit#151, ss_sold_date_sk#152, d_date_sk#492, ... 59 more fields]
                     +- Project [ss_sold_time_sk#130, ss_item_sk#131, ss_customer_sk#132, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_store_sk#136, ss_promo_sk#137, ss_ticket_number#138L, ss_quantity#139, ss_wholesale_cost#140, ss_list_price#141, ss_sales_price#142, ss_ext_discount_amt#143, ss_ext_sales_price#144, ss_ext_wholesale_cost#145, ss_ext_list_price#146, ss_ext_tax#147, ss_coupon_amt#148, ss_net_paid#149, ss_net_paid_inc_tax#150, ss_net_profit#151, ss_sold_date_sk#152, d_date_sk#492, ... 58 more fields]
                        +- Filter ((((d_month_seq#495 >= 1200) AND (d_month_seq#495 <= (1200 + 11))) AND (d_date_sk#492 = ss_sold_date_sk#152)) AND ((s_store_sk#664 = ss_store_sk#136) AND s_state#688 IN (list#4371 [])))
                           :  +- Project [s_state#4369]
                           :     +- Filter (ranking#4370 <= 5)
                           :        +- SubqueryAlias tmp1
                           :           +- Project [s_state#4369, ranking#4370]
                           :              +- Project [s_state#4369, s_state#688, _w1#4380, ranking#4370, ranking#4370]
                           :                 +- Window [rank(_w1#4380) windowspecdefinition(s_state#688, _w1#4380 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS ranking#4370], [s_state#688], [_w1#4380 DESC NULLS LAST]
                           :                    +- Aggregate [s_state#688], [s_state#688 AS s_state#4369, s_state#688, sum(ss_net_profit#151) AS _w1#4380]
                           :                       +- Filter ((((d_month_seq#495 >= 1200) AND (d_month_seq#495 <= (1200 + 11))) AND (d_date_sk#492 = ss_sold_date_sk#152)) AND (s_store_sk#664 = ss_store_sk#136))
                           :                          +- Join Inner
                           :                             :- Join Inner
                           :                             :  :- SubqueryAlias store_sales
                           :                             :  :  +- Relation[ss_sold_time_sk#130,ss_item_sk#131,ss_customer_sk#132,ss_cdemo_sk#133,ss_hdemo_sk#134,ss_addr_sk#135,ss_store_sk#136,ss_promo_sk#137,ss_ticket_number#138L,ss_quantity#139,ss_wholesale_cost#140,ss_list_price#141,ss_sales_price#142,ss_ext_discount_amt#143,ss_ext_sales_price#144,ss_ext_wholesale_cost#145,ss_ext_list_price#146,ss_ext_tax#147,ss_coupon_amt#148,ss_net_paid#149,ss_net_paid_inc_tax#150,ss_net_profit#151,ss_sold_date_sk#152] parquet
                           :                             :  +- SubqueryAlias store
                           :                             :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                           :                             +- SubqueryAlias date_dim
                           :                                +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                           +- Join Inner
                              :- Join Inner
                              :  :- SubqueryAlias store_sales
                              :  :  +- Relation[ss_sold_time_sk#130,ss_item_sk#131,ss_customer_sk#132,ss_cdemo_sk#133,ss_hdemo_sk#134,ss_addr_sk#135,ss_store_sk#136,ss_promo_sk#137,ss_ticket_number#138L,ss_quantity#139,ss_wholesale_cost#140,ss_list_price#141,ss_sales_price#142,ss_ext_discount_amt#143,ss_ext_sales_price#144,ss_ext_wholesale_cost#145,ss_ext_list_price#146,ss_ext_tax#147,ss_coupon_amt#148,ss_net_paid#149,ss_net_paid_inc_tax#150,ss_net_profit#151,ss_sold_date_sk#152] parquet
                              :  +- SubqueryAlias d1
                              :     +- SubqueryAlias date_dim
                              :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                              +- SubqueryAlias store
                                 +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet

      running Thread[benchmark runner,5,main]
2022-09-08 15:17:55,100 WARN adaptive.InsertAdaptiveSparkPlan: spark.sql.adaptive.enabled is enabled but is not supported for query: TakeOrderedAndProject(limit=100, orderBy=[lochierarchy#4427 DESC NULLS LAST,CASE WHEN (lochierarchy#4427 = 0) THEN s_state#4446 END ASC NULLS FIRST,rank_within_parent#4428 ASC NULLS FIRST], output=[total_sum#4426,s_state#4446,s_county#4447,lochierarchy#4427,rank_within_parent#4428])
+- Project [total_sum#4426, s_state#4446, s_county#4447, lochierarchy#4427, rank_within_parent#4428]
   +- Window [rank(_w3#4462) windowspecdefinition(_w1#4460, _w2#4461, _w3#4462 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rank_within_parent#4428], [_w1#4460, _w2#4461], [_w3#4462 DESC NULLS LAST]
      +- HashAggregate(keys=[s_state#4446, s_county#4447, spark_grouping_id#4445L], functions=[sum(UnscaledValue(ss_net_profit#151))], output=[total_sum#4426, s_state#4446, s_county#4447, lochierarchy#4427, _w1#4460, _w2#4461, _w3#4462])
         +- HashAggregate(keys=[s_state#4446, s_county#4447, spark_grouping_id#4445L], functions=[partial_sum(UnscaledValue(ss_net_profit#151))], output=[s_state#4446, s_county#4447, spark_grouping_id#4445L, sum#4487L])
            +- Expand [List(ss_net_profit#151, s_state#688, s_county#687, 0), List(ss_net_profit#151, s_state#688, null, 1), List(ss_net_profit#151, null, null, 3)], [ss_net_profit#151, s_state#4446, s_county#4447, spark_grouping_id#4445L]
               +- Project [ss_net_profit#151, s_state#688, s_county#687]
                  +- BroadcastHashJoin [ss_store_sk#136], [s_store_sk#664], Inner, BuildRight, false
                     :- Project [ss_store_sk#136, ss_net_profit#151]
                     :  +- BroadcastHashJoin [ss_sold_date_sk#152], [d_date_sk#492], Inner, BuildRight, false
                     :     :- Project [ss_store_sk#136, ss_net_profit#151, ss_sold_date_sk#152]
                     :     :  +- Filter isnotnull(ss_store_sk#136)
                     :     :     +- FileScan parquet [ss_store_sk#136,ss_net_profit#151,ss_sold_date_sk#152] Batched: true, DataFilters: [isnotnull(ss_store_sk#136)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/store_sales], PartitionFilters: [isnotnull(ss_sold_date_sk#152), dynamicpruning#4484 [ss_sold_date_sk#152]], PushedFilters: [IsNotNull(ss_store_sk)], ReadSchema: struct<ss_store_sk:int,ss_net_profit:decimal(7,2)>
                     :     :           +- Project [d_date_sk#492]
                     :     :              +- Filter (((isnotnull(d_month_seq#495) AND (d_month_seq#495 >= 1200)) AND (d_month_seq#495 <= 1211)) AND isnotnull(d_date_sk#492))
                     :     :                 +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :     +- Project [d_date_sk#492]
                     :        +- Filter (((isnotnull(d_month_seq#495) AND (d_month_seq#495 >= 1200)) AND (d_month_seq#495 <= 1211)) AND isnotnull(d_date_sk#492))
                     :           +- FileScan parquet [d_date_sk#492,d_month_seq#495] Batched: true, DataFilters: [isnotnull(d_month_seq#495), (d_month_seq#495 >= 1200), (d_month_seq#495 <= 1211), isnotnull(d_da..., Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_month_seq), GreaterThanOrEqual(d_month_seq,1200), LessThanOrEqual(d_month_seq,1211),..., ReadSchema: struct<d_date_sk:int,d_month_seq:int>
                     +- SortMergeJoin [s_state#688], [s_state#4423], LeftSemi
                        :- Project [s_store_sk#664, s_county#687, s_state#688]
                        :  +- Filter isnotnull(s_store_sk#664)
                        :     +- FileScan parquet [s_store_sk#664,s_county#687,s_state#688] Batched: true, DataFilters: [isnotnull(s_store_sk#664)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/store], PartitionFilters: [], PushedFilters: [IsNotNull(s_store_sk)], ReadSchema: struct<s_store_sk:int,s_county:string,s_state:string>
                        +- Project [s_state#4423]
                           +- Filter (isnotnull(ranking#4424) AND (ranking#4424 <= 5))
                              +- Window [rank(_w1#4434) windowspecdefinition(s_state#688, _w1#4434 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS ranking#4424], [s_state#688], [_w1#4434 DESC NULLS LAST]
                                 +- HashAggregate(keys=[s_state#688], functions=[sum(UnscaledValue(ss_net_profit#151))], output=[s_state#4423, s_state#688, _w1#4434])
                                    +- HashAggregate(keys=[s_state#688], functions=[partial_sum(UnscaledValue(ss_net_profit#151))], output=[s_state#688, sum#4489L])
                                       +- Project [ss_net_profit#151, s_state#688]
                                          +- BroadcastHashJoin [ss_sold_date_sk#152], [d_date_sk#492], Inner, BuildRight, false
                                             :- Project [ss_net_profit#151, ss_sold_date_sk#152, s_state#688]
                                             :  +- BroadcastHashJoin [ss_store_sk#136], [s_store_sk#664], Inner, BuildRight, false
                                             :     :- Project [ss_store_sk#136, ss_net_profit#151, ss_sold_date_sk#152]
                                             :     :  +- Filter isnotnull(ss_store_sk#136)
                                             :     :     +- FileScan parquet [ss_store_sk#136,ss_net_profit#151,ss_sold_date_sk#152] Batched: true, DataFilters: [isnotnull(ss_store_sk#136)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/store_sales], PartitionFilters: [isnotnull(ss_sold_date_sk#152), dynamicpruning#4477 [ss_sold_date_sk#152]], PushedFilters: [IsNotNull(ss_store_sk)], ReadSchema: struct<ss_store_sk:int,ss_net_profit:decimal(7,2)>
                                             :     :           +- Project [d_date_sk#492]
                                             :     :              +- Filter (((isnotnull(d_month_seq#495) AND (d_month_seq#495 >= 1200)) AND (d_month_seq#495 <= 1211)) AND isnotnull(d_date_sk#492))
                                             :     :                 +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                                             :     +- Project [s_store_sk#664, s_state#688]
                                             :        +- Filter isnotnull(s_store_sk#664)
                                             :           +- FileScan parquet [s_store_sk#664,s_state#688] Batched: true, DataFilters: [isnotnull(s_store_sk#664)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/store], PartitionFilters: [], PushedFilters: [IsNotNull(s_store_sk)], ReadSchema: struct<s_store_sk:int,s_state:string>
                                             +- Project [d_date_sk#492]
                                                +- Filter (((isnotnull(d_month_seq#495) AND (d_month_seq#495 >= 1200)) AND (d_month_seq#495 <= 1211)) AND isnotnull(d_date_sk#492))
                                                   +- FileScan parquet [d_date_sk#492,d_month_seq#495] Batched: true, DataFilters: [isnotnull(d_month_seq#495), (d_month_seq#495 >= 1200), (d_month_seq#495 <= 1211), isnotnull(d_da..., Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_month_seq), GreaterThanOrEqual(d_month_seq,1200), LessThanOrEqual(d_month_seq,1211),..., ReadSchema: struct<d_date_sk:int,d_month_seq:int>
.
Execution time: 13.594237106000001s
Running execution q82-v2.4 iteration: 2, StandardRun=true
2022-09-08 15:18:09,217 WARN adaptive.InsertAdaptiveSparkPlan: spark.sql.adaptive.enabled is enabled but is not supported for query: TakeOrderedAndProject(limit=100, orderBy=[i_item_id#565 ASC NULLS FIRST], output=[i_item_id#565,i_item_desc#568,i_current_price#569])
+- HashAggregate(keys=[i_item_id#565, i_item_desc#568, i_current_price#569], functions=[], output=[i_item_id#565, i_item_desc#568, i_current_price#569])
   +- HashAggregate(keys=[i_item_id#565, i_item_desc#568, i_current_price#569], functions=[], output=[i_item_id#565, i_item_desc#568, i_current_price#569])
      +- Project [i_item_id#565, i_item_desc#568, i_current_price#569]
         +- SortMergeJoin [i_item_sk#564], [ss_item_sk#131], Inner
            :- Project [i_item_sk#564, i_item_id#565, i_item_desc#568, i_current_price#569]
            :  +- BroadcastHashJoin [inv_date_sk#125], [d_date_sk#492], Inner, BuildRight, false
            :     :- Project [i_item_sk#564, i_item_id#565, i_item_desc#568, i_current_price#569, inv_date_sk#125]
            :     :  +- BroadcastHashJoin [i_item_sk#564], [inv_item_sk#122], Inner, BuildLeft, false
            :     :     :- Project [i_item_sk#564, i_item_id#565, i_item_desc#568, i_current_price#569]
            :     :     :  +- Filter ((((isnotnull(i_current_price#569) AND (i_current_price#569 >= 62.00)) AND (i_current_price#569 <= 92.00)) AND i_manufact_id#577 IN (129,270,821,423)) AND isnotnull(i_item_sk#564))
            :     :     :     +- FileScan parquet [i_item_sk#564,i_item_id#565,i_item_desc#568,i_current_price#569,i_manufact_id#577] Batched: true, DataFilters: [isnotnull(i_current_price#569), (i_current_price#569 >= 62.00), (i_current_price#569 <= 92.00), ..., Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/item], PartitionFilters: [], PushedFilters: [IsNotNull(i_current_price), GreaterThanOrEqual(i_current_price,62.00), LessThanOrEqual(i_current..., ReadSchema: struct<i_item_sk:int,i_item_id:string,i_item_desc:string,i_current_price:decimal(7,2),i_manufact_...
            :     :     +- Project [inv_item_sk#122, inv_date_sk#125]
            :     :        +- Filter (((isnotnull(inv_quantity_on_hand#124) AND (inv_quantity_on_hand#124 >= 100)) AND (inv_quantity_on_hand#124 <= 500)) AND isnotnull(inv_item_sk#122))
            :     :           +- FileScan parquet [inv_item_sk#122,inv_quantity_on_hand#124,inv_date_sk#125] Batched: true, DataFilters: [isnotnull(inv_quantity_on_hand#124), (inv_quantity_on_hand#124 >= 100), (inv_quantity_on_hand#12..., Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/inventory], PartitionFilters: [isnotnull(inv_date_sk#125), dynamicpruning#4520 [inv_date_sk#125]], PushedFilters: [IsNotNull(inv_quantity_on_hand), GreaterThanOrEqual(inv_quantity_on_hand,100), LessThanOrEqual(i..., ReadSchema: struct<inv_item_sk:int,inv_quantity_on_hand:int>
            :     :                 +- Project [d_date_sk#492]
            :     :                    +- Filter (((isnotnull(d_date#494) AND (d_date#494 >= 11102)) AND (d_date#494 <= 11162)) AND isnotnull(d_date_sk#492))
            :     :                       +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            :     +- Project [d_date_sk#492]
            :        +- Filter (((isnotnull(d_date#494) AND (d_date#494 >= 11102)) AND (d_date#494 <= 11162)) AND isnotnull(d_date_sk#492))
            :           +- FileScan parquet [d_date_sk#492,d_date#494] Batched: true, DataFilters: [isnotnull(d_date#494), (d_date#494 >= 11102), (d_date#494 <= 11162), isnotnull(d_date_sk#492)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_date), GreaterThanOrEqual(d_date,2000-05-25), LessThanOrEqual(d_date,2000-07-24), Is..., ReadSchema: struct<d_date_sk:int,d_date:date>
            +- Project [ss_item_sk#131]
               +- Filter isnotnull(ss_item_sk#131)
                  +- FileScan parquet [ss_item_sk#131,ss_sold_date_sk#152] Batched: true, DataFilters: [isnotnull(ss_item_sk#131)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/store_sales], PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk)], ReadSchema: struct<ss_item_sk:int>
.
2022-09-08 15:18:09,275 INFO perf.Query: 
== Query: q82-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [i_item_id#565 ASC NULLS FIRST], true
      +- Aggregate [i_item_id#565, i_item_desc#568, i_current_price#569], [i_item_id#565, i_item_desc#568, i_current_price#569]
         +- Filter (((((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(62 as decimal(2,0)) as decimal(7,2))) AND (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((62 + 30) as decimal(10,0)) as decimal(12,2)))) AND (inv_item_sk#122 = i_item_sk#564)) AND ((d_date_sk#492 = inv_date_sk#125) AND ((d_date#494 >= cast(2000-05-25 as date)) AND (d_date#494 <= cast(2000-05-25 as date) + 60 days)))) AND ((i_manufact_id#577 IN (129,270,821,423) AND ((inv_quantity_on_hand#124 >= 100) AND (inv_quantity_on_hand#124 <= 500))) AND (ss_item_sk#131 = i_item_sk#564)))
            +- Join Inner
               :- Join Inner
               :  :- Join Inner
               :  :  :- SubqueryAlias item
               :  :  :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  :  +- SubqueryAlias inventory
               :  :     +- Relation[inv_item_sk#122,inv_warehouse_sk#123,inv_quantity_on_hand#124,inv_date_sk#125] parquet
               :  +- SubqueryAlias date_dim
               :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               +- SubqueryAlias store_sales
                  +- Relation[ss_sold_time_sk#130,ss_item_sk#131,ss_customer_sk#132,ss_cdemo_sk#133,ss_hdemo_sk#134,ss_addr_sk#135,ss_store_sk#136,ss_promo_sk#137,ss_ticket_number#138L,ss_quantity#139,ss_wholesale_cost#140,ss_list_price#141,ss_sales_price#142,ss_ext_discount_amt#143,ss_ext_sales_price#144,ss_ext_wholesale_cost#145,ss_ext_list_price#146,ss_ext_tax#147,ss_coupon_amt#148,ss_net_paid#149,ss_net_paid_inc_tax#150,ss_net_profit#151,ss_sold_date_sk#152] parquet

     : benchmark
2022-09-08 15:18:09,333 INFO perf.Query: 
== Query: q82-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [i_item_id#565 ASC NULLS FIRST], true
      +- Aggregate [i_item_id#565, i_item_desc#568, i_current_price#569], [i_item_id#565, i_item_desc#568, i_current_price#569]
         +- Filter (((((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(62 as decimal(2,0)) as decimal(7,2))) AND (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((62 + 30) as decimal(10,0)) as decimal(12,2)))) AND (inv_item_sk#122 = i_item_sk#564)) AND ((d_date_sk#492 = inv_date_sk#125) AND ((d_date#494 >= cast(2000-05-25 as date)) AND (d_date#494 <= cast(2000-05-25 as date) + 60 days)))) AND ((i_manufact_id#577 IN (129,270,821,423) AND ((inv_quantity_on_hand#124 >= 100) AND (inv_quantity_on_hand#124 <= 500))) AND (ss_item_sk#131 = i_item_sk#564)))
            +- Join Inner
               :- Join Inner
               :  :- Join Inner
               :  :  :- SubqueryAlias item
               :  :  :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  :  +- SubqueryAlias inventory
               :  :     +- Relation[inv_item_sk#122,inv_warehouse_sk#123,inv_quantity_on_hand#124,inv_date_sk#125] parquet
               :  +- SubqueryAlias date_dim
               :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               +- SubqueryAlias store_sales
                  +- Relation[ss_sold_time_sk#130,ss_item_sk#131,ss_customer_sk#132,ss_cdemo_sk#133,ss_hdemo_sk#134,ss_addr_sk#135,ss_store_sk#136,ss_promo_sk#137,ss_ticket_number#138L,ss_quantity#139,ss_wholesale_cost#140,ss_list_price#141,ss_sales_price#142,ss_ext_discount_amt#143,ss_ext_sales_price#144,ss_ext_wholesale_cost#145,ss_ext_list_price#146,ss_ext_tax#147,ss_coupon_amt#148,ss_net_paid#149,ss_net_paid_inc_tax#150,ss_net_profit#151,ss_sold_date_sk#152] parquet

      running Thread[benchmark runner,5,main]
2022-09-08 15:18:09,444 WARN adaptive.InsertAdaptiveSparkPlan: spark.sql.adaptive.enabled is enabled but is not supported for query: TakeOrderedAndProject(limit=100, orderBy=[i_item_id#565 ASC NULLS FIRST], output=[i_item_id#565,i_item_desc#568,i_current_price#569])
+- HashAggregate(keys=[i_item_id#565, i_item_desc#568, i_current_price#569], functions=[], output=[i_item_id#565, i_item_desc#568, i_current_price#569])
   +- HashAggregate(keys=[i_item_id#565, i_item_desc#568, i_current_price#569], functions=[], output=[i_item_id#565, i_item_desc#568, i_current_price#569])
      +- Project [i_item_id#565, i_item_desc#568, i_current_price#569]
         +- SortMergeJoin [i_item_sk#564], [ss_item_sk#131], Inner
            :- Project [i_item_sk#564, i_item_id#565, i_item_desc#568, i_current_price#569]
            :  +- BroadcastHashJoin [inv_date_sk#125], [d_date_sk#492], Inner, BuildRight, false
            :     :- Project [i_item_sk#564, i_item_id#565, i_item_desc#568, i_current_price#569, inv_date_sk#125]
            :     :  +- BroadcastHashJoin [i_item_sk#564], [inv_item_sk#122], Inner, BuildLeft, false
            :     :     :- Project [i_item_sk#564, i_item_id#565, i_item_desc#568, i_current_price#569]
            :     :     :  +- Filter ((((isnotnull(i_current_price#569) AND (i_current_price#569 >= 62.00)) AND (i_current_price#569 <= 92.00)) AND i_manufact_id#577 IN (129,270,821,423)) AND isnotnull(i_item_sk#564))
            :     :     :     +- FileScan parquet [i_item_sk#564,i_item_id#565,i_item_desc#568,i_current_price#569,i_manufact_id#577] Batched: true, DataFilters: [isnotnull(i_current_price#569), (i_current_price#569 >= 62.00), (i_current_price#569 <= 92.00), ..., Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/item], PartitionFilters: [], PushedFilters: [IsNotNull(i_current_price), GreaterThanOrEqual(i_current_price,62.00), LessThanOrEqual(i_current..., ReadSchema: struct<i_item_sk:int,i_item_id:string,i_item_desc:string,i_current_price:decimal(7,2),i_manufact_...
            :     :     +- Project [inv_item_sk#122, inv_date_sk#125]
            :     :        +- Filter (((isnotnull(inv_quantity_on_hand#124) AND (inv_quantity_on_hand#124 >= 100)) AND (inv_quantity_on_hand#124 <= 500)) AND isnotnull(inv_item_sk#122))
            :     :           +- FileScan parquet [inv_item_sk#122,inv_quantity_on_hand#124,inv_date_sk#125] Batched: true, DataFilters: [isnotnull(inv_quantity_on_hand#124), (inv_quantity_on_hand#124 >= 100), (inv_quantity_on_hand#12..., Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/inventory], PartitionFilters: [isnotnull(inv_date_sk#125), dynamicpruning#4531 [inv_date_sk#125]], PushedFilters: [IsNotNull(inv_quantity_on_hand), GreaterThanOrEqual(inv_quantity_on_hand,100), LessThanOrEqual(i..., ReadSchema: struct<inv_item_sk:int,inv_quantity_on_hand:int>
            :     :                 +- Project [d_date_sk#492]
            :     :                    +- Filter (((isnotnull(d_date#494) AND (d_date#494 >= 11102)) AND (d_date#494 <= 11162)) AND isnotnull(d_date_sk#492))
            :     :                       +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            :     +- Project [d_date_sk#492]
            :        +- Filter (((isnotnull(d_date#494) AND (d_date#494 >= 11102)) AND (d_date#494 <= 11162)) AND isnotnull(d_date_sk#492))
            :           +- FileScan parquet [d_date_sk#492,d_date#494] Batched: true, DataFilters: [isnotnull(d_date#494), (d_date#494 >= 11102), (d_date#494 <= 11162), isnotnull(d_date_sk#492)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_date), GreaterThanOrEqual(d_date,2000-05-25), LessThanOrEqual(d_date,2000-07-24), Is..., ReadSchema: struct<d_date_sk:int,d_date:date>
            +- Project [ss_item_sk#131]
               +- Filter isnotnull(ss_item_sk#131)
                  +- FileScan parquet [ss_item_sk#131,ss_sold_date_sk#152] Batched: true, DataFilters: [isnotnull(ss_item_sk#131)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/store_sales], PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk)], ReadSchema: struct<ss_item_sk:int>
.
Execution time: 21.697501952s
Running execution q64-v2.4 iteration: 3, StandardRun=true
2022-09-08 15:18:32,800 WARN adaptive.InsertAdaptiveSparkPlan: spark.sql.adaptive.enabled is enabled but is not supported for query: Sort [product_name#4540 ASC NULLS FIRST, store_name#4542 ASC NULLS FIRST, cnt#4774L ASC NULLS FIRST], true, 0
+- Project [product_name#4540, store_name#4542, store_zip#4543, b_street_number#4544, b_streen_name#4545, b_city#4546, b_zip#4547, c_street_number#4548, c_street_name#4549, c_city#4550, c_zip#4551, syear#4552, cnt#4555L, s1#4556, s2#4557, s3#4558, s1#4775, s2#4776, s3#4777, syear#4771, cnt#4774L]
   +- SortMergeJoin [item_sk#4541, store_name#4542, store_zip#4543], [item_sk#4760, store_name#4761, store_zip#4762], Inner, (cnt#4774L <= cnt#4555L)
      :- HashAggregate(keys=[i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#4647, ca_street_name#4648, ca_city#4651, ca_zip#4654, d_year#498, d_year#4581, d_year#4609], functions=[count(1), sum(UnscaledValue(ss_wholesale_cost#140)), sum(UnscaledValue(ss_list_price#141)), sum(UnscaledValue(ss_coupon_amt#148))], output=[product_name#4540, item_sk#4541, store_name#4542, store_zip#4543, b_street_number#4544, b_streen_name#4545, b_city#4546, b_zip#4547, c_street_number#4548, c_street_name#4549, c_city#4550, c_zip#4551, syear#4552, cnt#4555L, s1#4556, s2#4557, s3#4558])
      :  +- HashAggregate(keys=[i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#4647, ca_street_name#4648, ca_city#4651, ca_zip#4654, d_year#498, d_year#4581, d_year#4609], functions=[partial_count(1), partial_sum(UnscaledValue(ss_wholesale_cost#140)), partial_sum(UnscaledValue(ss_list_price#141)), partial_sum(UnscaledValue(ss_coupon_amt#148))], output=[i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#4647, ca_street_name#4648, ca_city#4651, ca_zip#4654, d_year#498, d_year#4581, d_year#4609, count#4809L, sum#4810L, sum#4811L, sum#4812L])
      :     +- Project [ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, d_year#4581, d_year#4609, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#4647, ca_street_name#4648, ca_city#4651, ca_zip#4654, i_item_sk#564, i_product_name#585]
      :        +- BroadcastHashJoin [ss_item_sk#131], [i_item_sk#564], Inner, BuildRight, false
      :           :- Project [ss_item_sk#131, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, d_year#4581, d_year#4609, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#4647, ca_street_name#4648, ca_city#4651, ca_zip#4654]
      :           :  +- BroadcastHashJoin [hd_income_band_sk#4641], [ib_income_band_sk#4658], Inner, BuildRight, false
      :           :     :- Project [ss_item_sk#131, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, d_year#4581, d_year#4609, hd_income_band_sk#4641, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#4647, ca_street_name#4648, ca_city#4651, ca_zip#4654]
      :           :     :  +- BroadcastHashJoin [hd_income_band_sk#549], [ib_income_band_sk#558], Inner, BuildRight, false
      :           :     :     :- Project [ss_item_sk#131, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, d_year#4581, d_year#4609, hd_income_band_sk#549, hd_income_band_sk#4641, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#4647, ca_street_name#4648, ca_city#4651, ca_zip#4654]
      :           :     :     :  +- BroadcastHashJoin [c_current_addr_sk#416], [ca_address_sk#4645], Inner, BuildRight, false
      :           :     :     :     :- Project [ss_item_sk#131, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_addr_sk#416, d_year#4581, d_year#4609, hd_income_band_sk#549, hd_income_band_sk#4641, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457]
      :           :     :     :     :  +- BroadcastHashJoin [ss_addr_sk#135], [ca_address_sk#448], Inner, BuildRight, false
      :           :     :     :     :     :- Project [ss_item_sk#131, ss_addr_sk#135, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_addr_sk#416, d_year#4581, d_year#4609, hd_income_band_sk#549, hd_income_band_sk#4641]
      :           :     :     :     :     :  +- BroadcastHashJoin [c_current_hdemo_sk#415], [hd_demo_sk#4640], Inner, BuildRight, false
      :           :     :     :     :     :     :- Project [ss_item_sk#131, ss_addr_sk#135, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_hdemo_sk#415, c_current_addr_sk#416, d_year#4581, d_year#4609, hd_income_band_sk#549]
      :           :     :     :     :     :     :  +- BroadcastHashJoin [ss_hdemo_sk#134], [hd_demo_sk#548], Inner, BuildRight, false
      :           :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_hdemo_sk#134, ss_addr_sk#135, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_hdemo_sk#415, c_current_addr_sk#416, d_year#4581, d_year#4609]
      :           :     :     :     :     :     :     :  +- BroadcastHashJoin [ss_promo_sk#137], [p_promo_sk#608], Inner, BuildRight, false
      :           :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_hdemo_sk#134, ss_addr_sk#135, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_hdemo_sk#415, c_current_addr_sk#416, d_year#4581, d_year#4609]
      :           :     :     :     :     :     :     :     :  +- BroadcastHashJoin [c_current_cdemo_sk#414], [cd_demo_sk#4631], Inner, BuildRight, NOT (cd_marital_status#476 = cd_marital_status#4633), false
      :           :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_hdemo_sk#134, ss_addr_sk#135, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_cdemo_sk#414, c_current_hdemo_sk#415, c_current_addr_sk#416, d_year#4581, d_year#4609, cd_marital_status#476]
      :           :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [ss_cdemo_sk#133], [cd_demo_sk#474], Inner, BuildRight, false
      :           :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_cdemo_sk#414, c_current_hdemo_sk#415, c_current_addr_sk#416, d_year#4581, d_year#4609]
      :           :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [c_first_shipto_date_sk#417], [d_date_sk#4603], Inner, BuildRight, false
      :           :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_cdemo_sk#414, c_current_hdemo_sk#415, c_current_addr_sk#416, c_first_shipto_date_sk#417, d_year#4581]
      :           :     :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [c_first_sales_date_sk#418], [d_date_sk#4575], Inner, BuildRight, false
      :           :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_cdemo_sk#414, c_current_hdemo_sk#415, c_current_addr_sk#416, c_first_shipto_date_sk#417, c_first_sales_date_sk#418]
      :           :     :     :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [ss_customer_sk#132], [c_customer_sk#412], Inner, BuildRight, false
      :           :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_customer_sk#132, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689]
      :           :     :     :     :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [ss_store_sk#136], [s_store_sk#664], Inner, BuildRight, false
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_customer_sk#132, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_store_sk#136, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498]
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [ss_sold_date_sk#152], [d_date_sk#492], Inner, BuildRight, false
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_customer_sk#132, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_store_sk#136, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, ss_sold_date_sk#152]
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- SortMergeJoin [ss_item_sk#131], [cs_item_sk#14], Inner
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_customer_sk#132, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_store_sk#136, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, ss_sold_date_sk#152]
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- SortMergeJoin [ss_item_sk#131, ss_ticket_number#138L], [sr_item_sk#177, sr_ticket_number#184L], Inner
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_customer_sk#132, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_store_sk#136, ss_promo_sk#137, ss_ticket_number#138L, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, ss_sold_date_sk#152]
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- Filter (((((((isnotnull(ss_item_sk#131) AND isnotnull(ss_ticket_number#138L)) AND isnotnull(ss_store_sk#136)) AND isnotnull(ss_customer_sk#132)) AND isnotnull(ss_cdemo_sk#133)) AND isnotnull(ss_promo_sk#137)) AND isnotnull(ss_hdemo_sk#134)) AND isnotnull(ss_addr_sk#135))
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- FileScan parquet [ss_item_sk#131,ss_customer_sk#132,ss_cdemo_sk#133,ss_hdemo_sk#134,ss_addr_sk#135,ss_store_sk#136,ss_promo_sk#137,ss_ticket_number#138L,ss_wholesale_cost#140,ss_list_price#141,ss_coupon_amt#148,ss_sold_date_sk#152] Batched: true, DataFilters: [isnotnull(ss_item_sk#131), isnotnull(ss_ticket_number#138L), isnotnull(ss_store_sk#136), isnotnu..., Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/store_sales], PartitionFilters: [isnotnull(ss_sold_date_sk#152), dynamicpruning#4803 [ss_sold_date_sk#152]], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_ticket_number), IsNotNull(ss_store_sk), IsNotNull(ss_custome..., ReadSchema: struct<ss_item_sk:int,ss_customer_sk:int,ss_cdemo_sk:int,ss_hdemo_sk:int,ss_addr_sk:int,ss_store_...
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- Project [d_date_sk#492, d_year#498]
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :              +- Filter ((isnotnull(d_year#498) AND (d_year#498 = 1999)) AND isnotnull(d_date_sk#492))
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                 +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [sr_item_sk#177, sr_ticket_number#184L]
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter (isnotnull(sr_item_sk#177) AND isnotnull(sr_ticket_number#184L))
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- FileScan parquet [sr_item_sk#177,sr_ticket_number#184L,sr_returned_date_sk#195] Batched: true, DataFilters: [isnotnull(sr_item_sk#177), isnotnull(sr_ticket_number#184L)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/store_returns], PartitionFilters: [], PushedFilters: [IsNotNull(sr_item_sk), IsNotNull(sr_ticket_number)], ReadSchema: struct<sr_item_sk:int,sr_ticket_number:bigint>
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [cs_item_sk#14]
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter (isnotnull(sum(cs_ext_list_price#24)#4568) AND (cast(sum(cs_ext_list_price#24)#4568 as decimal(21,2)) > CheckOverflow((2.00 * promote_precision(sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#90 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#91 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#92 as decimal(9,2)))), DecimalType(9,2), true))#4569)), DecimalType(21,2), true)))
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- HashAggregate(keys=[cs_item_sk#14], functions=[sum(UnscaledValue(cs_ext_list_price#24)), sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#90 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#91 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#92 as decimal(9,2)))), DecimalType(9,2), true))], output=[cs_item_sk#14, sum(cs_ext_list_price#24)#4568, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#90 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#91 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#92 as decimal(9,2)))), DecimalType(9,2), true))#4569])
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :              +- HashAggregate(keys=[cs_item_sk#14], functions=[partial_sum(UnscaledValue(cs_ext_list_price#24)), partial_sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#90 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#91 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#92 as decimal(9,2)))), DecimalType(9,2), true))], output=[cs_item_sk#14, sum#4816L, sum#4817, isEmpty#4818])
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                 +- Project [cs_item_sk#14, cs_ext_list_price#24, cr_refunded_cash#90, cr_reversed_charge#91, cr_store_credit#92]
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                    +- SortMergeJoin [cs_item_sk#14, cs_order_number#16L], [cr_item_sk#69, cr_order_number#83L], Inner
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                       :- Project [cs_item_sk#14, cs_order_number#16L, cs_ext_list_price#24]
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                       :  +- Filter (isnotnull(cs_item_sk#14) AND isnotnull(cs_order_number#16L))
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                       :     +- FileScan parquet [cs_item_sk#14,cs_order_number#16L,cs_ext_list_price#24,cs_sold_date_sk#33] Batched: true, DataFilters: [isnotnull(cs_item_sk#14), isnotnull(cs_order_number#16L)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/catalog_sales], PartitionFilters: [], PushedFilters: [IsNotNull(cs_item_sk), IsNotNull(cs_order_number)], ReadSchema: struct<cs_item_sk:int,cs_order_number:bigint,cs_ext_list_price:decimal(7,2)>
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                       +- Project [cr_item_sk#69, cr_order_number#83L, cr_refunded_cash#90, cr_reversed_charge#91, cr_store_credit#92]
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                          +- Filter (isnotnull(cr_item_sk#69) AND isnotnull(cr_order_number#83L))
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                             +- FileScan parquet [cr_item_sk#69,cr_order_number#83L,cr_refunded_cash#90,cr_reversed_charge#91,cr_store_credit#92,cr_returned_date_sk#94] Batched: true, DataFilters: [isnotnull(cr_item_sk#69), isnotnull(cr_order_number#83L)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/catalog_returns], PartitionFilters: [], PushedFilters: [IsNotNull(cr_item_sk), IsNotNull(cr_order_number)], ReadSchema: struct<cr_item_sk:int,cr_order_number:bigint,cr_refunded_cash:decimal(7,2),cr_reversed_charge:dec...
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [d_date_sk#492, d_year#498]
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter ((isnotnull(d_year#498) AND (d_year#498 = 1999)) AND isnotnull(d_date_sk#492))
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- FileScan parquet [d_date_sk#492,d_year#498] Batched: true, DataFilters: [isnotnull(d_year#498), (d_year#498 = 1999), isnotnull(d_date_sk#492)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), EqualTo(d_year,1999), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [s_store_sk#664, s_store_name#669, s_zip#689]
      :           :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter ((isnotnull(s_store_sk#664) AND isnotnull(s_store_name#669)) AND isnotnull(s_zip#689))
      :           :     :     :     :     :     :     :     :     :     :     :     :     :           +- FileScan parquet [s_store_sk#664,s_store_name#669,s_zip#689] Batched: true, DataFilters: [isnotnull(s_store_sk#664), isnotnull(s_store_name#669), isnotnull(s_zip#689)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/store], PartitionFilters: [], PushedFilters: [IsNotNull(s_store_sk), IsNotNull(s_store_name), IsNotNull(s_zip)], ReadSchema: struct<s_store_sk:int,s_store_name:string,s_zip:string>
      :           :     :     :     :     :     :     :     :     :     :     :     :     +- Project [c_customer_sk#412, c_current_cdemo_sk#414, c_current_hdemo_sk#415, c_current_addr_sk#416, c_first_shipto_date_sk#417, c_first_sales_date_sk#418]
      :           :     :     :     :     :     :     :     :     :     :     :     :        +- Filter (((((isnotnull(c_customer_sk#412) AND isnotnull(c_first_sales_date_sk#418)) AND isnotnull(c_first_shipto_date_sk#417)) AND isnotnull(c_current_cdemo_sk#414)) AND isnotnull(c_current_hdemo_sk#415)) AND isnotnull(c_current_addr_sk#416))
      :           :     :     :     :     :     :     :     :     :     :     :     :           +- FileScan parquet [c_customer_sk#412,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418] Batched: true, DataFilters: [isnotnull(c_customer_sk#412), isnotnull(c_first_sales_date_sk#418), isnotnull(c_first_shipto_dat..., Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/customer], PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk), IsNotNull(c_first_sales_date_sk), IsNotNull(c_first_shipto_date_sk), I..., ReadSchema: struct<c_customer_sk:int,c_current_cdemo_sk:int,c_current_hdemo_sk:int,c_current_addr_sk:int,c_fi...
      :           :     :     :     :     :     :     :     :     :     :     :     +- Project [d_date_sk#4575, d_year#4581]
      :           :     :     :     :     :     :     :     :     :     :     :        +- Filter isnotnull(d_date_sk#4575)
      :           :     :     :     :     :     :     :     :     :     :     :           +- FileScan parquet [d_date_sk#4575,d_year#4581] Batched: true, DataFilters: [isnotnull(d_date_sk#4575)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
      :           :     :     :     :     :     :     :     :     :     :     +- Project [d_date_sk#4603, d_year#4609]
      :           :     :     :     :     :     :     :     :     :     :        +- Filter isnotnull(d_date_sk#4603)
      :           :     :     :     :     :     :     :     :     :     :           +- FileScan parquet [d_date_sk#4603,d_year#4609] Batched: true, DataFilters: [isnotnull(d_date_sk#4603)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
      :           :     :     :     :     :     :     :     :     :     +- Project [cd_demo_sk#474, cd_marital_status#476]
      :           :     :     :     :     :     :     :     :     :        +- Filter (isnotnull(cd_demo_sk#474) AND isnotnull(cd_marital_status#476))
      :           :     :     :     :     :     :     :     :     :           +- FileScan parquet [cd_demo_sk#474,cd_marital_status#476] Batched: true, DataFilters: [isnotnull(cd_demo_sk#474), isnotnull(cd_marital_status#476)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/customer_demographics], PartitionFilters: [], PushedFilters: [IsNotNull(cd_demo_sk), IsNotNull(cd_marital_status)], ReadSchema: struct<cd_demo_sk:int,cd_marital_status:string>
      :           :     :     :     :     :     :     :     :     +- Project [cd_demo_sk#4631, cd_marital_status#4633]
      :           :     :     :     :     :     :     :     :        +- Filter (isnotnull(cd_demo_sk#4631) AND isnotnull(cd_marital_status#4633))
      :           :     :     :     :     :     :     :     :           +- FileScan parquet [cd_demo_sk#4631,cd_marital_status#4633] Batched: true, DataFilters: [isnotnull(cd_demo_sk#4631), isnotnull(cd_marital_status#4633)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/customer_demographics], PartitionFilters: [], PushedFilters: [IsNotNull(cd_demo_sk), IsNotNull(cd_marital_status)], ReadSchema: struct<cd_demo_sk:int,cd_marital_status:string>
      :           :     :     :     :     :     :     :     +- Project [p_promo_sk#608]
      :           :     :     :     :     :     :     :        +- Filter isnotnull(p_promo_sk#608)
      :           :     :     :     :     :     :     :           +- FileScan parquet [p_promo_sk#608] Batched: true, DataFilters: [isnotnull(p_promo_sk#608)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/promotion], PartitionFilters: [], PushedFilters: [IsNotNull(p_promo_sk)], ReadSchema: struct<p_promo_sk:int>
      :           :     :     :     :     :     :     +- Project [hd_demo_sk#548, hd_income_band_sk#549]
      :           :     :     :     :     :     :        +- Filter (isnotnull(hd_demo_sk#548) AND isnotnull(hd_income_band_sk#549))
      :           :     :     :     :     :     :           +- FileScan parquet [hd_demo_sk#548,hd_income_band_sk#549] Batched: true, DataFilters: [isnotnull(hd_demo_sk#548), isnotnull(hd_income_band_sk#549)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/household_demographics], PartitionFilters: [], PushedFilters: [IsNotNull(hd_demo_sk), IsNotNull(hd_income_band_sk)], ReadSchema: struct<hd_demo_sk:int,hd_income_band_sk:int>
      :           :     :     :     :     :     +- Project [hd_demo_sk#4640, hd_income_band_sk#4641]
      :           :     :     :     :     :        +- Filter (isnotnull(hd_demo_sk#4640) AND isnotnull(hd_income_band_sk#4641))
      :           :     :     :     :     :           +- FileScan parquet [hd_demo_sk#4640,hd_income_band_sk#4641] Batched: true, DataFilters: [isnotnull(hd_demo_sk#4640), isnotnull(hd_income_band_sk#4641)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/household_demographics], PartitionFilters: [], PushedFilters: [IsNotNull(hd_demo_sk), IsNotNull(hd_income_band_sk)], ReadSchema: struct<hd_demo_sk:int,hd_income_band_sk:int>
      :           :     :     :     :     +- Project [ca_address_sk#448, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457]
      :           :     :     :     :        +- Filter isnotnull(ca_address_sk#448)
      :           :     :     :     :           +- FileScan parquet [ca_address_sk#448,ca_street_number#450,ca_street_name#451,ca_city#454,ca_zip#457] Batched: true, DataFilters: [isnotnull(ca_address_sk#448)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/customer_address], PartitionFilters: [], PushedFilters: [IsNotNull(ca_address_sk)], ReadSchema: struct<ca_address_sk:int,ca_street_number:string,ca_street_name:string,ca_city:string,ca_zip:string>
      :           :     :     :     +- Project [ca_address_sk#4645, ca_street_number#4647, ca_street_name#4648, ca_city#4651, ca_zip#4654]
      :           :     :     :        +- Filter isnotnull(ca_address_sk#4645)
      :           :     :     :           +- FileScan parquet [ca_address_sk#4645,ca_street_number#4647,ca_street_name#4648,ca_city#4651,ca_zip#4654] Batched: true, DataFilters: [isnotnull(ca_address_sk#4645)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/customer_address], PartitionFilters: [], PushedFilters: [IsNotNull(ca_address_sk)], ReadSchema: struct<ca_address_sk:int,ca_street_number:string,ca_street_name:string,ca_city:string,ca_zip:string>
      :           :     :     +- Project [ib_income_band_sk#558]
      :           :     :        +- Filter isnotnull(ib_income_band_sk#558)
      :           :     :           +- FileScan parquet [ib_income_band_sk#558] Batched: true, DataFilters: [isnotnull(ib_income_band_sk#558)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/income_band], PartitionFilters: [], PushedFilters: [IsNotNull(ib_income_band_sk)], ReadSchema: struct<ib_income_band_sk:int>
      :           :     +- Project [ib_income_band_sk#4658]
      :           :        +- Filter isnotnull(ib_income_band_sk#4658)
      :           :           +- FileScan parquet [ib_income_band_sk#4658] Batched: true, DataFilters: [isnotnull(ib_income_band_sk#4658)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/income_band], PartitionFilters: [], PushedFilters: [IsNotNull(ib_income_band_sk)], ReadSchema: struct<ib_income_band_sk:int>
      :           +- Project [i_item_sk#564, i_product_name#585]
      :              +- Filter ((((((isnotnull(i_current_price#569) AND i_color#581 IN (purple,burlywood,indian,spring,floral,medium)) AND (i_current_price#569 >= 64.00)) AND (i_current_price#569 <= 74.00)) AND (i_current_price#569 >= 65.00)) AND (i_current_price#569 <= 79.00)) AND isnotnull(i_item_sk#564))
      :                 +- FileScan parquet [i_item_sk#564,i_current_price#569,i_color#581,i_product_name#585] Batched: true, DataFilters: [isnotnull(i_current_price#569), i_color#581 IN (purple,burlywood,indian,spring,floral,medium), (..., Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/item], PartitionFilters: [], PushedFilters: [IsNotNull(i_current_price), In(i_color, [purple,burlywood,indian,spring,floral,medium]), Greater..., ReadSchema: struct<i_item_sk:int,i_current_price:decimal(7,2),i_color:string,i_product_name:string>
      +- HashAggregate(keys=[i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#4733, ca_street_name#4734, ca_city#4737, ca_zip#4740, d_year#498, d_year#4667, d_year#4695], functions=[count(1), sum(UnscaledValue(ss_wholesale_cost#140)), sum(UnscaledValue(ss_list_price#141)), sum(UnscaledValue(ss_coupon_amt#148))], output=[item_sk#4760, store_name#4761, store_zip#4762, syear#4771, cnt#4774L, s1#4775, s2#4776, s3#4777])
         +- HashAggregate(keys=[i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#4733, ca_street_name#4734, ca_city#4737, ca_zip#4740, d_year#498, d_year#4667, d_year#4695], functions=[partial_count(1), partial_sum(UnscaledValue(ss_wholesale_cost#140)), partial_sum(UnscaledValue(ss_list_price#141)), partial_sum(UnscaledValue(ss_coupon_amt#148))], output=[i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#4733, ca_street_name#4734, ca_city#4737, ca_zip#4740, d_year#498, d_year#4667, d_year#4695, count#4823L, sum#4824L, sum#4825L, sum#4826L])
            +- Project [ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, d_year#4667, d_year#4695, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#4733, ca_street_name#4734, ca_city#4737, ca_zip#4740, i_item_sk#564, i_product_name#585]
               +- BroadcastHashJoin [ss_item_sk#131], [i_item_sk#564], Inner, BuildRight, false
                  :- Project [ss_item_sk#131, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, d_year#4667, d_year#4695, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#4733, ca_street_name#4734, ca_city#4737, ca_zip#4740]
                  :  +- BroadcastHashJoin [hd_income_band_sk#4727], [ib_income_band_sk#4744], Inner, BuildRight, false
                  :     :- Project [ss_item_sk#131, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, d_year#4667, d_year#4695, hd_income_band_sk#4727, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#4733, ca_street_name#4734, ca_city#4737, ca_zip#4740]
                  :     :  +- BroadcastHashJoin [hd_income_band_sk#549], [ib_income_band_sk#558], Inner, BuildRight, false
                  :     :     :- Project [ss_item_sk#131, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, d_year#4667, d_year#4695, hd_income_band_sk#549, hd_income_band_sk#4727, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#4733, ca_street_name#4734, ca_city#4737, ca_zip#4740]
                  :     :     :  +- BroadcastHashJoin [c_current_addr_sk#416], [ca_address_sk#4731], Inner, BuildRight, false
                  :     :     :     :- Project [ss_item_sk#131, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_addr_sk#416, d_year#4667, d_year#4695, hd_income_band_sk#549, hd_income_band_sk#4727, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457]
                  :     :     :     :  +- BroadcastHashJoin [ss_addr_sk#135], [ca_address_sk#448], Inner, BuildRight, false
                  :     :     :     :     :- Project [ss_item_sk#131, ss_addr_sk#135, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_addr_sk#416, d_year#4667, d_year#4695, hd_income_band_sk#549, hd_income_band_sk#4727]
                  :     :     :     :     :  +- BroadcastHashJoin [c_current_hdemo_sk#415], [hd_demo_sk#4726], Inner, BuildRight, false
                  :     :     :     :     :     :- Project [ss_item_sk#131, ss_addr_sk#135, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_hdemo_sk#415, c_current_addr_sk#416, d_year#4667, d_year#4695, hd_income_band_sk#549]
                  :     :     :     :     :     :  +- BroadcastHashJoin [ss_hdemo_sk#134], [hd_demo_sk#548], Inner, BuildRight, false
                  :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_hdemo_sk#134, ss_addr_sk#135, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_hdemo_sk#415, c_current_addr_sk#416, d_year#4667, d_year#4695]
                  :     :     :     :     :     :     :  +- BroadcastHashJoin [ss_promo_sk#137], [p_promo_sk#608], Inner, BuildRight, false
                  :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_hdemo_sk#134, ss_addr_sk#135, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_hdemo_sk#415, c_current_addr_sk#416, d_year#4667, d_year#4695]
                  :     :     :     :     :     :     :     :  +- BroadcastHashJoin [c_current_cdemo_sk#414], [cd_demo_sk#4717], Inner, BuildRight, NOT (cd_marital_status#476 = cd_marital_status#4719), false
                  :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_hdemo_sk#134, ss_addr_sk#135, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_cdemo_sk#414, c_current_hdemo_sk#415, c_current_addr_sk#416, d_year#4667, d_year#4695, cd_marital_status#476]
                  :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [ss_cdemo_sk#133], [cd_demo_sk#474], Inner, BuildRight, false
                  :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_cdemo_sk#414, c_current_hdemo_sk#415, c_current_addr_sk#416, d_year#4667, d_year#4695]
                  :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [c_first_shipto_date_sk#417], [d_date_sk#4689], Inner, BuildRight, false
                  :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_cdemo_sk#414, c_current_hdemo_sk#415, c_current_addr_sk#416, c_first_shipto_date_sk#417, d_year#4667]
                  :     :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [c_first_sales_date_sk#418], [d_date_sk#4661], Inner, BuildRight, false
                  :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_cdemo_sk#414, c_current_hdemo_sk#415, c_current_addr_sk#416, c_first_shipto_date_sk#417, c_first_sales_date_sk#418]
                  :     :     :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [ss_customer_sk#132], [c_customer_sk#412], Inner, BuildRight, false
                  :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_customer_sk#132, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689]
                  :     :     :     :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [ss_store_sk#136], [s_store_sk#664], Inner, BuildRight, false
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_customer_sk#132, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_store_sk#136, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498]
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [ss_sold_date_sk#152], [d_date_sk#492], Inner, BuildRight, false
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_customer_sk#132, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_store_sk#136, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, ss_sold_date_sk#152]
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- SortMergeJoin [ss_item_sk#131], [cs_item_sk#14], Inner
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_customer_sk#132, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_store_sk#136, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, ss_sold_date_sk#152]
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- SortMergeJoin [ss_item_sk#131, ss_ticket_number#138L], [sr_item_sk#177, sr_ticket_number#184L], Inner
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_customer_sk#132, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_store_sk#136, ss_promo_sk#137, ss_ticket_number#138L, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, ss_sold_date_sk#152]
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- Filter (((((((isnotnull(ss_item_sk#131) AND isnotnull(ss_ticket_number#138L)) AND isnotnull(ss_store_sk#136)) AND isnotnull(ss_customer_sk#132)) AND isnotnull(ss_cdemo_sk#133)) AND isnotnull(ss_promo_sk#137)) AND isnotnull(ss_hdemo_sk#134)) AND isnotnull(ss_addr_sk#135))
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- FileScan parquet [ss_item_sk#131,ss_customer_sk#132,ss_cdemo_sk#133,ss_hdemo_sk#134,ss_addr_sk#135,ss_store_sk#136,ss_promo_sk#137,ss_ticket_number#138L,ss_wholesale_cost#140,ss_list_price#141,ss_coupon_amt#148,ss_sold_date_sk#152] Batched: true, DataFilters: [isnotnull(ss_item_sk#131), isnotnull(ss_ticket_number#138L), isnotnull(ss_store_sk#136), isnotnu..., Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/store_sales], PartitionFilters: [isnotnull(ss_sold_date_sk#152), dynamicpruning#4804 [ss_sold_date_sk#152]], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_ticket_number), IsNotNull(ss_store_sk), IsNotNull(ss_custome..., ReadSchema: struct<ss_item_sk:int,ss_customer_sk:int,ss_cdemo_sk:int,ss_hdemo_sk:int,ss_addr_sk:int,ss_store_...
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- Project [d_date_sk#492, d_year#498]
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :              +- Filter ((isnotnull(d_year#498) AND (d_year#498 = 2000)) AND isnotnull(d_date_sk#492))
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                 +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [sr_item_sk#177, sr_ticket_number#184L]
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter (isnotnull(sr_item_sk#177) AND isnotnull(sr_ticket_number#184L))
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- FileScan parquet [sr_item_sk#177,sr_ticket_number#184L,sr_returned_date_sk#195] Batched: true, DataFilters: [isnotnull(sr_item_sk#177), isnotnull(sr_ticket_number#184L)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/store_returns], PartitionFilters: [], PushedFilters: [IsNotNull(sr_item_sk), IsNotNull(sr_ticket_number)], ReadSchema: struct<sr_item_sk:int,sr_ticket_number:bigint>
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [cs_item_sk#14]
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter (isnotnull(sum(cs_ext_list_price#24)#4573) AND (cast(sum(cs_ext_list_price#24)#4573 as decimal(21,2)) > CheckOverflow((2.00 * promote_precision(sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#90 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#91 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#92 as decimal(9,2)))), DecimalType(9,2), true))#4574)), DecimalType(21,2), true)))
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- HashAggregate(keys=[cs_item_sk#14], functions=[sum(UnscaledValue(cs_ext_list_price#24)), sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#90 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#91 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#92 as decimal(9,2)))), DecimalType(9,2), true))], output=[cs_item_sk#14, sum(cs_ext_list_price#24)#4573, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#90 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#91 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#92 as decimal(9,2)))), DecimalType(9,2), true))#4574])
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :              +- HashAggregate(keys=[cs_item_sk#14], functions=[partial_sum(UnscaledValue(cs_ext_list_price#24)), partial_sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#90 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#91 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#92 as decimal(9,2)))), DecimalType(9,2), true))], output=[cs_item_sk#14, sum#4830L, sum#4831, isEmpty#4832])
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                 +- Project [cs_item_sk#14, cs_ext_list_price#24, cr_refunded_cash#90, cr_reversed_charge#91, cr_store_credit#92]
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                    +- SortMergeJoin [cs_item_sk#14, cs_order_number#16L], [cr_item_sk#69, cr_order_number#83L], Inner
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                       :- Project [cs_item_sk#14, cs_order_number#16L, cs_ext_list_price#24]
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                       :  +- Filter (isnotnull(cs_item_sk#14) AND isnotnull(cs_order_number#16L))
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                       :     +- FileScan parquet [cs_item_sk#14,cs_order_number#16L,cs_ext_list_price#24,cs_sold_date_sk#33] Batched: true, DataFilters: [isnotnull(cs_item_sk#14), isnotnull(cs_order_number#16L)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/catalog_sales], PartitionFilters: [], PushedFilters: [IsNotNull(cs_item_sk), IsNotNull(cs_order_number)], ReadSchema: struct<cs_item_sk:int,cs_order_number:bigint,cs_ext_list_price:decimal(7,2)>
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                       +- Project [cr_item_sk#69, cr_order_number#83L, cr_refunded_cash#90, cr_reversed_charge#91, cr_store_credit#92]
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                          +- Filter (isnotnull(cr_item_sk#69) AND isnotnull(cr_order_number#83L))
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                             +- FileScan parquet [cr_item_sk#69,cr_order_number#83L,cr_refunded_cash#90,cr_reversed_charge#91,cr_store_credit#92,cr_returned_date_sk#94] Batched: true, DataFilters: [isnotnull(cr_item_sk#69), isnotnull(cr_order_number#83L)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/catalog_returns], PartitionFilters: [], PushedFilters: [IsNotNull(cr_item_sk), IsNotNull(cr_order_number)], ReadSchema: struct<cr_item_sk:int,cr_order_number:bigint,cr_refunded_cash:decimal(7,2),cr_reversed_charge:dec...
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [d_date_sk#492, d_year#498]
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter ((isnotnull(d_year#498) AND (d_year#498 = 2000)) AND isnotnull(d_date_sk#492))
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- FileScan parquet [d_date_sk#492,d_year#498] Batched: true, DataFilters: [isnotnull(d_year#498), (d_year#498 = 2000), isnotnull(d_date_sk#492)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), EqualTo(d_year,2000), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
                  :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [s_store_sk#664, s_store_name#669, s_zip#689]
                  :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter ((isnotnull(s_store_sk#664) AND isnotnull(s_store_name#669)) AND isnotnull(s_zip#689))
                  :     :     :     :     :     :     :     :     :     :     :     :     :           +- FileScan parquet [s_store_sk#664,s_store_name#669,s_zip#689] Batched: true, DataFilters: [isnotnull(s_store_sk#664), isnotnull(s_store_name#669), isnotnull(s_zip#689)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/store], PartitionFilters: [], PushedFilters: [IsNotNull(s_store_sk), IsNotNull(s_store_name), IsNotNull(s_zip)], ReadSchema: struct<s_store_sk:int,s_store_name:string,s_zip:string>
                  :     :     :     :     :     :     :     :     :     :     :     :     +- Project [c_customer_sk#412, c_current_cdemo_sk#414, c_current_hdemo_sk#415, c_current_addr_sk#416, c_first_shipto_date_sk#417, c_first_sales_date_sk#418]
                  :     :     :     :     :     :     :     :     :     :     :     :        +- Filter (((((isnotnull(c_customer_sk#412) AND isnotnull(c_first_sales_date_sk#418)) AND isnotnull(c_first_shipto_date_sk#417)) AND isnotnull(c_current_cdemo_sk#414)) AND isnotnull(c_current_hdemo_sk#415)) AND isnotnull(c_current_addr_sk#416))
                  :     :     :     :     :     :     :     :     :     :     :     :           +- FileScan parquet [c_customer_sk#412,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418] Batched: true, DataFilters: [isnotnull(c_customer_sk#412), isnotnull(c_first_sales_date_sk#418), isnotnull(c_first_shipto_dat..., Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/customer], PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk), IsNotNull(c_first_sales_date_sk), IsNotNull(c_first_shipto_date_sk), I..., ReadSchema: struct<c_customer_sk:int,c_current_cdemo_sk:int,c_current_hdemo_sk:int,c_current_addr_sk:int,c_fi...
                  :     :     :     :     :     :     :     :     :     :     :     +- Project [d_date_sk#4661, d_year#4667]
                  :     :     :     :     :     :     :     :     :     :     :        +- Filter isnotnull(d_date_sk#4661)
                  :     :     :     :     :     :     :     :     :     :     :           +- FileScan parquet [d_date_sk#4661,d_year#4667] Batched: true, DataFilters: [isnotnull(d_date_sk#4661)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
                  :     :     :     :     :     :     :     :     :     :     +- Project [d_date_sk#4689, d_year#4695]
                  :     :     :     :     :     :     :     :     :     :        +- Filter isnotnull(d_date_sk#4689)
                  :     :     :     :     :     :     :     :     :     :           +- FileScan parquet [d_date_sk#4689,d_year#4695] Batched: true, DataFilters: [isnotnull(d_date_sk#4689)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
                  :     :     :     :     :     :     :     :     :     +- Project [cd_demo_sk#474, cd_marital_status#476]
                  :     :     :     :     :     :     :     :     :        +- Filter (isnotnull(cd_demo_sk#474) AND isnotnull(cd_marital_status#476))
                  :     :     :     :     :     :     :     :     :           +- FileScan parquet [cd_demo_sk#474,cd_marital_status#476] Batched: true, DataFilters: [isnotnull(cd_demo_sk#474), isnotnull(cd_marital_status#476)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/customer_demographics], PartitionFilters: [], PushedFilters: [IsNotNull(cd_demo_sk), IsNotNull(cd_marital_status)], ReadSchema: struct<cd_demo_sk:int,cd_marital_status:string>
                  :     :     :     :     :     :     :     :     +- Project [cd_demo_sk#4717, cd_marital_status#4719]
                  :     :     :     :     :     :     :     :        +- Filter (isnotnull(cd_demo_sk#4717) AND isnotnull(cd_marital_status#4719))
                  :     :     :     :     :     :     :     :           +- FileScan parquet [cd_demo_sk#4717,cd_marital_status#4719] Batched: true, DataFilters: [isnotnull(cd_demo_sk#4717), isnotnull(cd_marital_status#4719)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/customer_demographics], PartitionFilters: [], PushedFilters: [IsNotNull(cd_demo_sk), IsNotNull(cd_marital_status)], ReadSchema: struct<cd_demo_sk:int,cd_marital_status:string>
                  :     :     :     :     :     :     :     +- Project [p_promo_sk#608]
                  :     :     :     :     :     :     :        +- Filter isnotnull(p_promo_sk#608)
                  :     :     :     :     :     :     :           +- FileScan parquet [p_promo_sk#608] Batched: true, DataFilters: [isnotnull(p_promo_sk#608)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/promotion], PartitionFilters: [], PushedFilters: [IsNotNull(p_promo_sk)], ReadSchema: struct<p_promo_sk:int>
                  :     :     :     :     :     :     +- Project [hd_demo_sk#548, hd_income_band_sk#549]
                  :     :     :     :     :     :        +- Filter (isnotnull(hd_demo_sk#548) AND isnotnull(hd_income_band_sk#549))
                  :     :     :     :     :     :           +- FileScan parquet [hd_demo_sk#548,hd_income_band_sk#549] Batched: true, DataFilters: [isnotnull(hd_demo_sk#548), isnotnull(hd_income_band_sk#549)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/household_demographics], PartitionFilters: [], PushedFilters: [IsNotNull(hd_demo_sk), IsNotNull(hd_income_band_sk)], ReadSchema: struct<hd_demo_sk:int,hd_income_band_sk:int>
                  :     :     :     :     :     +- Project [hd_demo_sk#4726, hd_income_band_sk#4727]
                  :     :     :     :     :        +- Filter (isnotnull(hd_demo_sk#4726) AND isnotnull(hd_income_band_sk#4727))
                  :     :     :     :     :           +- FileScan parquet [hd_demo_sk#4726,hd_income_band_sk#4727] Batched: true, DataFilters: [isnotnull(hd_demo_sk#4726), isnotnull(hd_income_band_sk#4727)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/household_demographics], PartitionFilters: [], PushedFilters: [IsNotNull(hd_demo_sk), IsNotNull(hd_income_band_sk)], ReadSchema: struct<hd_demo_sk:int,hd_income_band_sk:int>
                  :     :     :     :     +- Project [ca_address_sk#448, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457]
                  :     :     :     :        +- Filter isnotnull(ca_address_sk#448)
                  :     :     :     :           +- FileScan parquet [ca_address_sk#448,ca_street_number#450,ca_street_name#451,ca_city#454,ca_zip#457] Batched: true, DataFilters: [isnotnull(ca_address_sk#448)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/customer_address], PartitionFilters: [], PushedFilters: [IsNotNull(ca_address_sk)], ReadSchema: struct<ca_address_sk:int,ca_street_number:string,ca_street_name:string,ca_city:string,ca_zip:string>
                  :     :     :     +- Project [ca_address_sk#4731, ca_street_number#4733, ca_street_name#4734, ca_city#4737, ca_zip#4740]
                  :     :     :        +- Filter isnotnull(ca_address_sk#4731)
                  :     :     :           +- FileScan parquet [ca_address_sk#4731,ca_street_number#4733,ca_street_name#4734,ca_city#4737,ca_zip#4740] Batched: true, DataFilters: [isnotnull(ca_address_sk#4731)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/customer_address], PartitionFilters: [], PushedFilters: [IsNotNull(ca_address_sk)], ReadSchema: struct<ca_address_sk:int,ca_street_number:string,ca_street_name:string,ca_city:string,ca_zip:string>
                  :     :     +- Project [ib_income_band_sk#558]
                  :     :        +- Filter isnotnull(ib_income_band_sk#558)
                  :     :           +- FileScan parquet [ib_income_band_sk#558] Batched: true, DataFilters: [isnotnull(ib_income_band_sk#558)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/income_band], PartitionFilters: [], PushedFilters: [IsNotNull(ib_income_band_sk)], ReadSchema: struct<ib_income_band_sk:int>
                  :     +- Project [ib_income_band_sk#4744]
                  :        +- Filter isnotnull(ib_income_band_sk#4744)
                  :           +- FileScan parquet [ib_income_band_sk#4744] Batched: true, DataFilters: [isnotnull(ib_income_band_sk#4744)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/income_band], PartitionFilters: [], PushedFilters: [IsNotNull(ib_income_band_sk)], ReadSchema: struct<ib_income_band_sk:int>
                  +- Project [i_item_sk#564, i_product_name#585]
                     +- Filter ((((((isnotnull(i_current_price#569) AND i_color#581 IN (purple,burlywood,indian,spring,floral,medium)) AND (i_current_price#569 >= 64.00)) AND (i_current_price#569 <= 74.00)) AND (i_current_price#569 >= 65.00)) AND (i_current_price#569 <= 79.00)) AND isnotnull(i_item_sk#564))
                        +- FileScan parquet [i_item_sk#564,i_current_price#569,i_color#581,i_product_name#585] Batched: true, DataFilters: [isnotnull(i_current_price#569), i_color#581 IN (purple,burlywood,indian,spring,floral,medium), (..., Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/item], PartitionFilters: [], PushedFilters: [IsNotNull(i_current_price), In(i_color, [purple,burlywood,indian,spring,floral,medium]), Greater..., ReadSchema: struct<i_item_sk:int,i_current_price:decimal(7,2),i_color:string,i_product_name:string>
.
2022-09-08 15:18:33,371 INFO perf.Query: 
== Query: q64-v2.4 ==
Sort [product_name#4843 ASC NULLS FIRST, store_name#4845 ASC NULLS FIRST, cnt#5077L ASC NULLS FIRST], true
+- Project [product_name#4843, store_name#4845, store_zip#4846, b_street_number#4847, b_streen_name#4848, b_city#4849, b_zip#4850, c_street_number#4851, c_street_name#4852, c_city#4853, c_zip#4854, syear#4855, cnt#4858L, s1#4859, s2#4860, s3#4861, s1#5078, s2#5079, s3#5080, syear#5074, cnt#5077L]
   +- Filter ((((item_sk#4844 = item_sk#5063) AND (syear#4855 = 1999)) AND (syear#5074 = (1999 + 1))) AND (((cnt#5077L <= cnt#4858L) AND (store_name#4845 = store_name#5064)) AND (store_zip#4846 = store_zip#5065)))
      +- Join Inner
         :- SubqueryAlias cs1
         :  +- SubqueryAlias cross_sales
         :     +- Aggregate [i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#4950, ca_street_name#4951, ca_city#4954, ca_zip#4957, d_year#498, d_year#4884, d_year#4912], [i_product_name#585 AS product_name#4843, i_item_sk#564 AS item_sk#4844, s_store_name#669 AS store_name#4845, s_zip#689 AS store_zip#4846, ca_street_number#450 AS b_street_number#4847, ca_street_name#451 AS b_streen_name#4848, ca_city#454 AS b_city#4849, ca_zip#457 AS b_zip#4850, ca_street_number#4950 AS c_street_number#4851, ca_street_name#4951 AS c_street_name#4852, ca_city#4954 AS c_city#4853, ca_zip#4957 AS c_zip#4854, d_year#498 AS syear#4855, d_year#4884 AS fsyear#4856, d_year#4912 AS s2year#4857, count(1) AS cnt#4858L, sum(ss_wholesale_cost#140) AS s1#4859, sum(ss_list_price#141) AS s2#4860, sum(ss_coupon_amt#148) AS s3#4861]
         :        +- Filter ((((((ss_store_sk#136 = s_store_sk#664) AND (ss_sold_date_sk#152 = d_date_sk#492)) AND (ss_customer_sk#132 = c_customer_sk#412)) AND (((ss_cdemo_sk#133 = cd_demo_sk#474) AND (ss_hdemo_sk#134 = hd_demo_sk#548)) AND (ss_addr_sk#135 = ca_address_sk#448))) AND ((((ss_item_sk#131 = i_item_sk#564) AND (ss_item_sk#131 = sr_item_sk#177)) AND (ss_ticket_number#138L = sr_ticket_number#184L)) AND ((ss_item_sk#131 = cs_item_sk#14) AND (c_current_cdemo_sk#414 = cd_demo_sk#4934)))) AND (((((c_current_hdemo_sk#415 = hd_demo_sk#4943) AND (c_current_addr_sk#416 = ca_address_sk#4948)) AND (c_first_sales_date_sk#418 = d_date_sk#4878)) AND (((c_first_shipto_date_sk#417 = d_date_sk#4906) AND (ss_promo_sk#137 = p_promo_sk#608)) AND (hd_income_band_sk#549 = ib_income_band_sk#558))) AND ((((hd_income_band_sk#4944 = ib_income_band_sk#4961) AND NOT (cd_marital_status#476 = cd_marital_status#4936)) AND i_color#581 IN (purple,burlywood,indian,spring,floral,medium)) AND (((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(64 as decimal(2,0)) as decimal(7,2))) AND (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 10) as decimal(10,0)) as decimal(12,2)))) AND ((cast(i_current_price#569 as decimal(12,2)) >= cast(cast((64 + 1) as decimal(10,0)) as decimal(12,2))) AND (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 15) as decimal(10,0)) as decimal(12,2))))))))
         :           +- Join Inner
         :              :- Join Inner
         :              :  :- Join Inner
         :              :  :  :- Join Inner
         :              :  :  :  :- Join Inner
         :              :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- SubqueryAlias store_sales
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- Relation[ss_sold_time_sk#130,ss_item_sk#131,ss_customer_sk#132,ss_cdemo_sk#133,ss_hdemo_sk#134,ss_addr_sk#135,ss_store_sk#136,ss_promo_sk#137,ss_ticket_number#138L,ss_quantity#139,ss_wholesale_cost#140,ss_list_price#141,ss_sales_price#142,ss_ext_discount_amt#143,ss_ext_sales_price#144,ss_ext_wholesale_cost#145,ss_ext_list_price#146,ss_ext_tax#147,ss_coupon_amt#148,ss_net_paid#149,ss_net_paid_inc_tax#150,ss_net_profit#151,ss_sold_date_sk#152] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias store_returns
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Relation[sr_return_time_sk#176,sr_item_sk#177,sr_customer_sk#178,sr_cdemo_sk#179,sr_hdemo_sk#180,sr_addr_sk#181,sr_store_sk#182,sr_reason_sk#183,sr_ticket_number#184L,sr_return_quantity#185,sr_return_amt#186,sr_return_tax#187,sr_return_amt_inc_tax#188,sr_fee#189,sr_return_ship_cost#190,sr_refunded_cash#191,sr_reversed_charge#192,sr_store_credit#193,sr_net_loss#194,sr_returned_date_sk#195] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias cs_ui
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Project [cs_item_sk#14, sale#4841, refund#4842]
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Filter (cast(sum(cs_ext_list_price#24)#4871 as decimal(21,2)) > cast(CheckOverflow((promote_precision(cast(cast(2 as decimal(1,0)) as decimal(19,2))) * promote_precision(cast(sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#90 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#91 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#92 as decimal(9,2)))), DecimalType(9,2), true))#4872 as decimal(19,2)))), DecimalType(21,2), true) as decimal(21,2)))
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :           +- Aggregate [cs_item_sk#14], [cs_item_sk#14, sum(cs_ext_list_price#24) AS sale#4841, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#90 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#91 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#92 as decimal(9,2)))), DecimalType(9,2), true)) AS refund#4842, sum(cs_ext_list_price#24) AS sum(cs_ext_list_price#24)#4871, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#90 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#91 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#92 as decimal(9,2)))), DecimalType(9,2), true)) AS sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#90 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#91 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#92 as decimal(9,2)))), DecimalType(9,2), true))#4872]
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :              +- Filter ((cs_item_sk#14 = cr_item_sk#69) AND (cs_order_number#16L = cr_order_number#83L))
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                 +- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :- SubqueryAlias catalog_sales
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :  +- Relation[cs_sold_time_sk#0,cs_ship_date_sk#1,cs_bill_customer_sk#2,cs_bill_cdemo_sk#3,cs_bill_hdemo_sk#4,cs_bill_addr_sk#5,cs_ship_customer_sk#6,cs_ship_cdemo_sk#7,cs_ship_hdemo_sk#8,cs_ship_addr_sk#9,cs_call_center_sk#10,cs_catalog_page_sk#11,cs_ship_mode_sk#12,cs_warehouse_sk#13,cs_item_sk#14,cs_promo_sk#15,cs_order_number#16L,cs_quantity#17,cs_wholesale_cost#18,cs_list_price#19,cs_sales_price#20,cs_ext_discount_amt#21,cs_ext_sales_price#22,cs_ext_wholesale_cost#23,... 10 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    +- SubqueryAlias catalog_returns
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                       +- Relation[cr_returned_time_sk#68,cr_item_sk#69,cr_refunded_customer_sk#70,cr_refunded_cdemo_sk#71,cr_refunded_hdemo_sk#72,cr_refunded_addr_sk#73,cr_returning_customer_sk#74,cr_returning_cdemo_sk#75,cr_returning_hdemo_sk#76,cr_returning_addr_sk#77,cr_call_center_sk#78,cr_catalog_page_sk#79,cr_ship_mode_sk#80,cr_warehouse_sk#81,cr_reason_sk#82,cr_order_number#83L,cr_return_quantity#84,cr_return_amount#85,cr_return_tax#86,cr_return_amt_inc_tax#87,cr_fee#88,cr_return_ship_cost#89,cr_refunded_cash#90,cr_reversed_charge#91,... 3 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias d1
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias date_dim
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias d2
         :              :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias date_dim
         :              :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#4878,d_date_id#4879,d_date#4880,d_month_seq#4881,d_week_seq#4882,d_quarter_seq#4883,d_year#4884,d_dow#4885,d_moy#4886,d_dom#4887,d_qoy#4888,d_fy_year#4889,d_fy_quarter_seq#4890,d_fy_week_seq#4891,d_day_name#4892,d_quarter_name#4893,d_holiday#4894,d_weekend#4895,d_following_holiday#4896,d_first_dom#4897,d_last_dom#4898,d_same_day_ly#4899,d_same_day_lq#4900,d_current_day#4901,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias d3
         :              :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias date_dim
         :              :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#4906,d_date_id#4907,d_date#4908,d_month_seq#4909,d_week_seq#4910,d_quarter_seq#4911,d_year#4912,d_dow#4913,d_moy#4914,d_dom#4915,d_qoy#4916,d_fy_year#4917,d_fy_quarter_seq#4918,d_fy_week_seq#4919,d_day_name#4920,d_quarter_name#4921,d_holiday#4922,d_weekend#4923,d_following_holiday#4924,d_first_dom#4925,d_last_dom#4926,d_same_day_ly#4927,d_same_day_lq#4928,d_current_day#4929,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias store
         :              :  :  :  :  :  :  :  :  :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias customer
         :              :  :  :  :  :  :  :  :  :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
         :              :  :  :  :  :  :  :  :  :  +- SubqueryAlias cd1
         :              :  :  :  :  :  :  :  :  :     +- SubqueryAlias customer_demographics
         :              :  :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
         :              :  :  :  :  :  :  :  :  +- SubqueryAlias cd2
         :              :  :  :  :  :  :  :  :     +- SubqueryAlias customer_demographics
         :              :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#4934,cd_gender#4935,cd_marital_status#4936,cd_education_status#4937,cd_purchase_estimate#4938,cd_credit_rating#4939,cd_dep_count#4940,cd_dep_employed_count#4941,cd_dep_college_count#4942] parquet
         :              :  :  :  :  :  :  :  +- SubqueryAlias promotion
         :              :  :  :  :  :  :  :     +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet
         :              :  :  :  :  :  :  +- SubqueryAlias hd1
         :              :  :  :  :  :  :     +- SubqueryAlias household_demographics
         :              :  :  :  :  :  :        +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
         :              :  :  :  :  :  +- SubqueryAlias hd2
         :              :  :  :  :  :     +- SubqueryAlias household_demographics
         :              :  :  :  :  :        +- Relation[hd_demo_sk#4943,hd_income_band_sk#4944,hd_buy_potential#4945,hd_dep_count#4946,hd_vehicle_count#4947] parquet
         :              :  :  :  :  +- SubqueryAlias ad1
         :              :  :  :  :     +- SubqueryAlias customer_address
         :              :  :  :  :        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
         :              :  :  :  +- SubqueryAlias ad2
         :              :  :  :     +- SubqueryAlias customer_address
         :              :  :  :        +- Relation[ca_address_sk#4948,ca_address_id#4949,ca_street_number#4950,ca_street_name#4951,ca_street_type#4952,ca_suite_number#4953,ca_city#4954,ca_county#4955,ca_state#4956,ca_zip#4957,ca_country#4958,ca_gmt_offset#4959,ca_location_type#4960] parquet
         :              :  :  +- SubqueryAlias ib1
         :              :  :     +- SubqueryAlias income_band
         :              :  :        +- Relation[ib_income_band_sk#558,ib_lower_bound#559,ib_upper_bound#560] parquet
         :              :  +- SubqueryAlias ib2
         :              :     +- SubqueryAlias income_band
         :              :        +- Relation[ib_income_band_sk#4961,ib_lower_bound#4962,ib_upper_bound#4963] parquet
         :              +- SubqueryAlias item
         :                 +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
         +- SubqueryAlias cs2
            +- SubqueryAlias cross_sales
               +- Aggregate [i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#5036, ca_street_name#5037, ca_city#5040, ca_zip#5043, d_year#498, d_year#4970, d_year#4998], [i_product_name#585 AS product_name#5062, i_item_sk#564 AS item_sk#5063, s_store_name#669 AS store_name#5064, s_zip#689 AS store_zip#5065, ca_street_number#450 AS b_street_number#5066, ca_street_name#451 AS b_streen_name#5067, ca_city#454 AS b_city#5068, ca_zip#457 AS b_zip#5069, ca_street_number#5036 AS c_street_number#5070, ca_street_name#5037 AS c_street_name#5071, ca_city#5040 AS c_city#5072, ca_zip#5043 AS c_zip#5073, d_year#498 AS syear#5074, d_year#4970 AS fsyear#5075, d_year#4998 AS s2year#5076, count(1) AS cnt#5077L, sum(ss_wholesale_cost#140) AS s1#5078, sum(ss_list_price#141) AS s2#5079, sum(ss_coupon_amt#148) AS s3#5080]
                  +- Filter ((((((ss_store_sk#136 = s_store_sk#664) AND (ss_sold_date_sk#152 = d_date_sk#492)) AND (ss_customer_sk#132 = c_customer_sk#412)) AND (((ss_cdemo_sk#133 = cd_demo_sk#474) AND (ss_hdemo_sk#134 = hd_demo_sk#548)) AND (ss_addr_sk#135 = ca_address_sk#448))) AND ((((ss_item_sk#131 = i_item_sk#564) AND (ss_item_sk#131 = sr_item_sk#177)) AND (ss_ticket_number#138L = sr_ticket_number#184L)) AND ((ss_item_sk#131 = cs_item_sk#14) AND (c_current_cdemo_sk#414 = cd_demo_sk#5020)))) AND (((((c_current_hdemo_sk#415 = hd_demo_sk#5029) AND (c_current_addr_sk#416 = ca_address_sk#5034)) AND (c_first_sales_date_sk#418 = d_date_sk#4964)) AND (((c_first_shipto_date_sk#417 = d_date_sk#4992) AND (ss_promo_sk#137 = p_promo_sk#608)) AND (hd_income_band_sk#549 = ib_income_band_sk#558))) AND ((((hd_income_band_sk#5030 = ib_income_band_sk#5047) AND NOT (cd_marital_status#476 = cd_marital_status#5022)) AND i_color#581 IN (purple,burlywood,indian,spring,floral,medium)) AND (((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(64 as decimal(2,0)) as decimal(7,2))) AND (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 10) as decimal(10,0)) as decimal(12,2)))) AND ((cast(i_current_price#569 as decimal(12,2)) >= cast(cast((64 + 1) as decimal(10,0)) as decimal(12,2))) AND (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 15) as decimal(10,0)) as decimal(12,2))))))))
                     +- Join Inner
                        :- Join Inner
                        :  :- Join Inner
                        :  :  :- Join Inner
                        :  :  :  :- Join Inner
                        :  :  :  :  :- Join Inner
                        :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- SubqueryAlias store_sales
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- Relation[ss_sold_time_sk#130,ss_item_sk#131,ss_customer_sk#132,ss_cdemo_sk#133,ss_hdemo_sk#134,ss_addr_sk#135,ss_store_sk#136,ss_promo_sk#137,ss_ticket_number#138L,ss_quantity#139,ss_wholesale_cost#140,ss_list_price#141,ss_sales_price#142,ss_ext_discount_amt#143,ss_ext_sales_price#144,ss_ext_wholesale_cost#145,ss_ext_list_price#146,ss_ext_tax#147,ss_coupon_amt#148,ss_net_paid#149,ss_net_paid_inc_tax#150,ss_net_profit#151,ss_sold_date_sk#152] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias store_returns
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Relation[sr_return_time_sk#176,sr_item_sk#177,sr_customer_sk#178,sr_cdemo_sk#179,sr_hdemo_sk#180,sr_addr_sk#181,sr_store_sk#182,sr_reason_sk#183,sr_ticket_number#184L,sr_return_quantity#185,sr_return_amt#186,sr_return_tax#187,sr_return_amt_inc_tax#188,sr_fee#189,sr_return_ship_cost#190,sr_refunded_cash#191,sr_reversed_charge#192,sr_store_credit#193,sr_net_loss#194,sr_returned_date_sk#195] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias cs_ui
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Project [cs_item_sk#14, sale#4841, refund#4842]
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Filter (cast(sum(cs_ext_list_price#24)#4876 as decimal(21,2)) > cast(CheckOverflow((promote_precision(cast(cast(2 as decimal(1,0)) as decimal(19,2))) * promote_precision(cast(sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#90 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#91 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#92 as decimal(9,2)))), DecimalType(9,2), true))#4877 as decimal(19,2)))), DecimalType(21,2), true) as decimal(21,2)))
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :           +- Aggregate [cs_item_sk#14], [cs_item_sk#14, sum(cs_ext_list_price#24) AS sale#4841, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#90 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#91 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#92 as decimal(9,2)))), DecimalType(9,2), true)) AS refund#4842, sum(cs_ext_list_price#24) AS sum(cs_ext_list_price#24)#4876, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#90 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#91 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#92 as decimal(9,2)))), DecimalType(9,2), true)) AS sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#90 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#91 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#92 as decimal(9,2)))), DecimalType(9,2), true))#4877]
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :              +- Filter ((cs_item_sk#14 = cr_item_sk#69) AND (cs_order_number#16L = cr_order_number#83L))
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                 +- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :- SubqueryAlias catalog_sales
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :  +- Relation[cs_sold_time_sk#0,cs_ship_date_sk#1,cs_bill_customer_sk#2,cs_bill_cdemo_sk#3,cs_bill_hdemo_sk#4,cs_bill_addr_sk#5,cs_ship_customer_sk#6,cs_ship_cdemo_sk#7,cs_ship_hdemo_sk#8,cs_ship_addr_sk#9,cs_call_center_sk#10,cs_catalog_page_sk#11,cs_ship_mode_sk#12,cs_warehouse_sk#13,cs_item_sk#14,cs_promo_sk#15,cs_order_number#16L,cs_quantity#17,cs_wholesale_cost#18,cs_list_price#19,cs_sales_price#20,cs_ext_discount_amt#21,cs_ext_sales_price#22,cs_ext_wholesale_cost#23,... 10 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    +- SubqueryAlias catalog_returns
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                       +- Relation[cr_returned_time_sk#68,cr_item_sk#69,cr_refunded_customer_sk#70,cr_refunded_cdemo_sk#71,cr_refunded_hdemo_sk#72,cr_refunded_addr_sk#73,cr_returning_customer_sk#74,cr_returning_cdemo_sk#75,cr_returning_hdemo_sk#76,cr_returning_addr_sk#77,cr_call_center_sk#78,cr_catalog_page_sk#79,cr_ship_mode_sk#80,cr_warehouse_sk#81,cr_reason_sk#82,cr_order_number#83L,cr_return_quantity#84,cr_return_amount#85,cr_return_tax#86,cr_return_amt_inc_tax#87,cr_fee#88,cr_return_ship_cost#89,cr_refunded_cash#90,cr_reversed_charge#91,... 3 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias d1
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias date_dim
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias d2
                        :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias date_dim
                        :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#4964,d_date_id#4965,d_date#4966,d_month_seq#4967,d_week_seq#4968,d_quarter_seq#4969,d_year#4970,d_dow#4971,d_moy#4972,d_dom#4973,d_qoy#4974,d_fy_year#4975,d_fy_quarter_seq#4976,d_fy_week_seq#4977,d_day_name#4978,d_quarter_name#4979,d_holiday#4980,d_weekend#4981,d_following_holiday#4982,d_first_dom#4983,d_last_dom#4984,d_same_day_ly#4985,d_same_day_lq#4986,d_current_day#4987,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias d3
                        :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias date_dim
                        :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#4992,d_date_id#4993,d_date#4994,d_month_seq#4995,d_week_seq#4996,d_quarter_seq#4997,d_year#4998,d_dow#4999,d_moy#5000,d_dom#5001,d_qoy#5002,d_fy_year#5003,d_fy_quarter_seq#5004,d_fy_week_seq#5005,d_day_name#5006,d_quarter_name#5007,d_holiday#5008,d_weekend#5009,d_following_holiday#5010,d_first_dom#5011,d_last_dom#5012,d_same_day_ly#5013,d_same_day_lq#5014,d_current_day#5015,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias store
                        :  :  :  :  :  :  :  :  :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias customer
                        :  :  :  :  :  :  :  :  :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                        :  :  :  :  :  :  :  :  :  +- SubqueryAlias cd1
                        :  :  :  :  :  :  :  :  :     +- SubqueryAlias customer_demographics
                        :  :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
                        :  :  :  :  :  :  :  :  +- SubqueryAlias cd2
                        :  :  :  :  :  :  :  :     +- SubqueryAlias customer_demographics
                        :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#5020,cd_gender#5021,cd_marital_status#5022,cd_education_status#5023,cd_purchase_estimate#5024,cd_credit_rating#5025,cd_dep_count#5026,cd_dep_employed_count#5027,cd_dep_college_count#5028] parquet
                        :  :  :  :  :  :  :  +- SubqueryAlias promotion
                        :  :  :  :  :  :  :     +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet
                        :  :  :  :  :  :  +- SubqueryAlias hd1
                        :  :  :  :  :  :     +- SubqueryAlias household_demographics
                        :  :  :  :  :  :        +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
                        :  :  :  :  :  +- SubqueryAlias hd2
                        :  :  :  :  :     +- SubqueryAlias household_demographics
                        :  :  :  :  :        +- Relation[hd_demo_sk#5029,hd_income_band_sk#5030,hd_buy_potential#5031,hd_dep_count#5032,hd_vehicle_count#5033] parquet
                        :  :  :  :  +- SubqueryAlias ad1
                        :  :  :  :     +- SubqueryAlias customer_address
                        :  :  :  :        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                        :  :  :  +- SubqueryAlias ad2
                        :  :  :     +- SubqueryAlias customer_address
                        :  :  :        +- Relation[ca_address_sk#5034,ca_address_id#5035,ca_street_number#5036,ca_street_name#5037,ca_street_type#5038,ca_suite_number#5039,ca_city#5040,ca_county#5041,ca_state#5042,ca_zip#5043,ca_country#5044,ca_gmt_offset#5045,ca_location_type#5046] parquet
                        :  :  +- SubqueryAlias ib1
                        :  :     +- SubqueryAlias income_band
                        :  :        +- Relation[ib_income_band_sk#558,ib_lower_bound#559,ib_upper_bound#560] parquet
                        :  +- SubqueryAlias ib2
                        :     +- SubqueryAlias income_band
                        :        +- Relation[ib_income_band_sk#5047,ib_lower_bound#5048,ib_upper_bound#5049] parquet
                        +- SubqueryAlias item
                           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

     : benchmark
2022-09-08 15:18:33,930 INFO perf.Query: 
== Query: q64-v2.4 ==
Sort [product_name#5108 ASC NULLS FIRST, store_name#5110 ASC NULLS FIRST, cnt#5342L ASC NULLS FIRST], true
+- Project [product_name#5108, store_name#5110, store_zip#5111, b_street_number#5112, b_streen_name#5113, b_city#5114, b_zip#5115, c_street_number#5116, c_street_name#5117, c_city#5118, c_zip#5119, syear#5120, cnt#5123L, s1#5124, s2#5125, s3#5126, s1#5343, s2#5344, s3#5345, syear#5339, cnt#5342L]
   +- Filter ((((item_sk#5109 = item_sk#5328) AND (syear#5120 = 1999)) AND (syear#5339 = (1999 + 1))) AND (((cnt#5342L <= cnt#5123L) AND (store_name#5110 = store_name#5329)) AND (store_zip#5111 = store_zip#5330)))
      +- Join Inner
         :- SubqueryAlias cs1
         :  +- SubqueryAlias cross_sales
         :     +- Aggregate [i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#5215, ca_street_name#5216, ca_city#5219, ca_zip#5222, d_year#498, d_year#5149, d_year#5177], [i_product_name#585 AS product_name#5108, i_item_sk#564 AS item_sk#5109, s_store_name#669 AS store_name#5110, s_zip#689 AS store_zip#5111, ca_street_number#450 AS b_street_number#5112, ca_street_name#451 AS b_streen_name#5113, ca_city#454 AS b_city#5114, ca_zip#457 AS b_zip#5115, ca_street_number#5215 AS c_street_number#5116, ca_street_name#5216 AS c_street_name#5117, ca_city#5219 AS c_city#5118, ca_zip#5222 AS c_zip#5119, d_year#498 AS syear#5120, d_year#5149 AS fsyear#5121, d_year#5177 AS s2year#5122, count(1) AS cnt#5123L, sum(ss_wholesale_cost#140) AS s1#5124, sum(ss_list_price#141) AS s2#5125, sum(ss_coupon_amt#148) AS s3#5126]
         :        +- Filter ((((((ss_store_sk#136 = s_store_sk#664) AND (ss_sold_date_sk#152 = d_date_sk#492)) AND (ss_customer_sk#132 = c_customer_sk#412)) AND (((ss_cdemo_sk#133 = cd_demo_sk#474) AND (ss_hdemo_sk#134 = hd_demo_sk#548)) AND (ss_addr_sk#135 = ca_address_sk#448))) AND ((((ss_item_sk#131 = i_item_sk#564) AND (ss_item_sk#131 = sr_item_sk#177)) AND (ss_ticket_number#138L = sr_ticket_number#184L)) AND ((ss_item_sk#131 = cs_item_sk#14) AND (c_current_cdemo_sk#414 = cd_demo_sk#5199)))) AND (((((c_current_hdemo_sk#415 = hd_demo_sk#5208) AND (c_current_addr_sk#416 = ca_address_sk#5213)) AND (c_first_sales_date_sk#418 = d_date_sk#5143)) AND (((c_first_shipto_date_sk#417 = d_date_sk#5171) AND (ss_promo_sk#137 = p_promo_sk#608)) AND (hd_income_band_sk#549 = ib_income_band_sk#558))) AND ((((hd_income_band_sk#5209 = ib_income_band_sk#5226) AND NOT (cd_marital_status#476 = cd_marital_status#5201)) AND i_color#581 IN (purple,burlywood,indian,spring,floral,medium)) AND (((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(64 as decimal(2,0)) as decimal(7,2))) AND (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 10) as decimal(10,0)) as decimal(12,2)))) AND ((cast(i_current_price#569 as decimal(12,2)) >= cast(cast((64 + 1) as decimal(10,0)) as decimal(12,2))) AND (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 15) as decimal(10,0)) as decimal(12,2))))))))
         :           +- Join Inner
         :              :- Join Inner
         :              :  :- Join Inner
         :              :  :  :- Join Inner
         :              :  :  :  :- Join Inner
         :              :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- SubqueryAlias store_sales
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- Relation[ss_sold_time_sk#130,ss_item_sk#131,ss_customer_sk#132,ss_cdemo_sk#133,ss_hdemo_sk#134,ss_addr_sk#135,ss_store_sk#136,ss_promo_sk#137,ss_ticket_number#138L,ss_quantity#139,ss_wholesale_cost#140,ss_list_price#141,ss_sales_price#142,ss_ext_discount_amt#143,ss_ext_sales_price#144,ss_ext_wholesale_cost#145,ss_ext_list_price#146,ss_ext_tax#147,ss_coupon_amt#148,ss_net_paid#149,ss_net_paid_inc_tax#150,ss_net_profit#151,ss_sold_date_sk#152] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias store_returns
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Relation[sr_return_time_sk#176,sr_item_sk#177,sr_customer_sk#178,sr_cdemo_sk#179,sr_hdemo_sk#180,sr_addr_sk#181,sr_store_sk#182,sr_reason_sk#183,sr_ticket_number#184L,sr_return_quantity#185,sr_return_amt#186,sr_return_tax#187,sr_return_amt_inc_tax#188,sr_fee#189,sr_return_ship_cost#190,sr_refunded_cash#191,sr_reversed_charge#192,sr_store_credit#193,sr_net_loss#194,sr_returned_date_sk#195] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias cs_ui
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Project [cs_item_sk#14, sale#5106, refund#5107]
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Filter (cast(sum(cs_ext_list_price#24)#5136 as decimal(21,2)) > cast(CheckOverflow((promote_precision(cast(cast(2 as decimal(1,0)) as decimal(19,2))) * promote_precision(cast(sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#90 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#91 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#92 as decimal(9,2)))), DecimalType(9,2), true))#5137 as decimal(19,2)))), DecimalType(21,2), true) as decimal(21,2)))
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :           +- Aggregate [cs_item_sk#14], [cs_item_sk#14, sum(cs_ext_list_price#24) AS sale#5106, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#90 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#91 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#92 as decimal(9,2)))), DecimalType(9,2), true)) AS refund#5107, sum(cs_ext_list_price#24) AS sum(cs_ext_list_price#24)#5136, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#90 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#91 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#92 as decimal(9,2)))), DecimalType(9,2), true)) AS sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#90 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#91 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#92 as decimal(9,2)))), DecimalType(9,2), true))#5137]
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :              +- Filter ((cs_item_sk#14 = cr_item_sk#69) AND (cs_order_number#16L = cr_order_number#83L))
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                 +- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :- SubqueryAlias catalog_sales
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :  +- Relation[cs_sold_time_sk#0,cs_ship_date_sk#1,cs_bill_customer_sk#2,cs_bill_cdemo_sk#3,cs_bill_hdemo_sk#4,cs_bill_addr_sk#5,cs_ship_customer_sk#6,cs_ship_cdemo_sk#7,cs_ship_hdemo_sk#8,cs_ship_addr_sk#9,cs_call_center_sk#10,cs_catalog_page_sk#11,cs_ship_mode_sk#12,cs_warehouse_sk#13,cs_item_sk#14,cs_promo_sk#15,cs_order_number#16L,cs_quantity#17,cs_wholesale_cost#18,cs_list_price#19,cs_sales_price#20,cs_ext_discount_amt#21,cs_ext_sales_price#22,cs_ext_wholesale_cost#23,... 10 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    +- SubqueryAlias catalog_returns
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                       +- Relation[cr_returned_time_sk#68,cr_item_sk#69,cr_refunded_customer_sk#70,cr_refunded_cdemo_sk#71,cr_refunded_hdemo_sk#72,cr_refunded_addr_sk#73,cr_returning_customer_sk#74,cr_returning_cdemo_sk#75,cr_returning_hdemo_sk#76,cr_returning_addr_sk#77,cr_call_center_sk#78,cr_catalog_page_sk#79,cr_ship_mode_sk#80,cr_warehouse_sk#81,cr_reason_sk#82,cr_order_number#83L,cr_return_quantity#84,cr_return_amount#85,cr_return_tax#86,cr_return_amt_inc_tax#87,cr_fee#88,cr_return_ship_cost#89,cr_refunded_cash#90,cr_reversed_charge#91,... 3 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias d1
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias date_dim
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias d2
         :              :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias date_dim
         :              :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#5143,d_date_id#5144,d_date#5145,d_month_seq#5146,d_week_seq#5147,d_quarter_seq#5148,d_year#5149,d_dow#5150,d_moy#5151,d_dom#5152,d_qoy#5153,d_fy_year#5154,d_fy_quarter_seq#5155,d_fy_week_seq#5156,d_day_name#5157,d_quarter_name#5158,d_holiday#5159,d_weekend#5160,d_following_holiday#5161,d_first_dom#5162,d_last_dom#5163,d_same_day_ly#5164,d_same_day_lq#5165,d_current_day#5166,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias d3
         :              :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias date_dim
         :              :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#5171,d_date_id#5172,d_date#5173,d_month_seq#5174,d_week_seq#5175,d_quarter_seq#5176,d_year#5177,d_dow#5178,d_moy#5179,d_dom#5180,d_qoy#5181,d_fy_year#5182,d_fy_quarter_seq#5183,d_fy_week_seq#5184,d_day_name#5185,d_quarter_name#5186,d_holiday#5187,d_weekend#5188,d_following_holiday#5189,d_first_dom#5190,d_last_dom#5191,d_same_day_ly#5192,d_same_day_lq#5193,d_current_day#5194,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias store
         :              :  :  :  :  :  :  :  :  :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias customer
         :              :  :  :  :  :  :  :  :  :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
         :              :  :  :  :  :  :  :  :  :  +- SubqueryAlias cd1
         :              :  :  :  :  :  :  :  :  :     +- SubqueryAlias customer_demographics
         :              :  :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
         :              :  :  :  :  :  :  :  :  +- SubqueryAlias cd2
         :              :  :  :  :  :  :  :  :     +- SubqueryAlias customer_demographics
         :              :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#5199,cd_gender#5200,cd_marital_status#5201,cd_education_status#5202,cd_purchase_estimate#5203,cd_credit_rating#5204,cd_dep_count#5205,cd_dep_employed_count#5206,cd_dep_college_count#5207] parquet
         :              :  :  :  :  :  :  :  +- SubqueryAlias promotion
         :              :  :  :  :  :  :  :     +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet
         :              :  :  :  :  :  :  +- SubqueryAlias hd1
         :              :  :  :  :  :  :     +- SubqueryAlias household_demographics
         :              :  :  :  :  :  :        +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
         :              :  :  :  :  :  +- SubqueryAlias hd2
         :              :  :  :  :  :     +- SubqueryAlias household_demographics
         :              :  :  :  :  :        +- Relation[hd_demo_sk#5208,hd_income_band_sk#5209,hd_buy_potential#5210,hd_dep_count#5211,hd_vehicle_count#5212] parquet
         :              :  :  :  :  +- SubqueryAlias ad1
         :              :  :  :  :     +- SubqueryAlias customer_address
         :              :  :  :  :        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
         :              :  :  :  +- SubqueryAlias ad2
         :              :  :  :     +- SubqueryAlias customer_address
         :              :  :  :        +- Relation[ca_address_sk#5213,ca_address_id#5214,ca_street_number#5215,ca_street_name#5216,ca_street_type#5217,ca_suite_number#5218,ca_city#5219,ca_county#5220,ca_state#5221,ca_zip#5222,ca_country#5223,ca_gmt_offset#5224,ca_location_type#5225] parquet
         :              :  :  +- SubqueryAlias ib1
         :              :  :     +- SubqueryAlias income_band
         :              :  :        +- Relation[ib_income_band_sk#558,ib_lower_bound#559,ib_upper_bound#560] parquet
         :              :  +- SubqueryAlias ib2
         :              :     +- SubqueryAlias income_band
         :              :        +- Relation[ib_income_band_sk#5226,ib_lower_bound#5227,ib_upper_bound#5228] parquet
         :              +- SubqueryAlias item
         :                 +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
         +- SubqueryAlias cs2
            +- SubqueryAlias cross_sales
               +- Aggregate [i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#5301, ca_street_name#5302, ca_city#5305, ca_zip#5308, d_year#498, d_year#5235, d_year#5263], [i_product_name#585 AS product_name#5327, i_item_sk#564 AS item_sk#5328, s_store_name#669 AS store_name#5329, s_zip#689 AS store_zip#5330, ca_street_number#450 AS b_street_number#5331, ca_street_name#451 AS b_streen_name#5332, ca_city#454 AS b_city#5333, ca_zip#457 AS b_zip#5334, ca_street_number#5301 AS c_street_number#5335, ca_street_name#5302 AS c_street_name#5336, ca_city#5305 AS c_city#5337, ca_zip#5308 AS c_zip#5338, d_year#498 AS syear#5339, d_year#5235 AS fsyear#5340, d_year#5263 AS s2year#5341, count(1) AS cnt#5342L, sum(ss_wholesale_cost#140) AS s1#5343, sum(ss_list_price#141) AS s2#5344, sum(ss_coupon_amt#148) AS s3#5345]
                  +- Filter ((((((ss_store_sk#136 = s_store_sk#664) AND (ss_sold_date_sk#152 = d_date_sk#492)) AND (ss_customer_sk#132 = c_customer_sk#412)) AND (((ss_cdemo_sk#133 = cd_demo_sk#474) AND (ss_hdemo_sk#134 = hd_demo_sk#548)) AND (ss_addr_sk#135 = ca_address_sk#448))) AND ((((ss_item_sk#131 = i_item_sk#564) AND (ss_item_sk#131 = sr_item_sk#177)) AND (ss_ticket_number#138L = sr_ticket_number#184L)) AND ((ss_item_sk#131 = cs_item_sk#14) AND (c_current_cdemo_sk#414 = cd_demo_sk#5285)))) AND (((((c_current_hdemo_sk#415 = hd_demo_sk#5294) AND (c_current_addr_sk#416 = ca_address_sk#5299)) AND (c_first_sales_date_sk#418 = d_date_sk#5229)) AND (((c_first_shipto_date_sk#417 = d_date_sk#5257) AND (ss_promo_sk#137 = p_promo_sk#608)) AND (hd_income_band_sk#549 = ib_income_band_sk#558))) AND ((((hd_income_band_sk#5295 = ib_income_band_sk#5312) AND NOT (cd_marital_status#476 = cd_marital_status#5287)) AND i_color#581 IN (purple,burlywood,indian,spring,floral,medium)) AND (((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(64 as decimal(2,0)) as decimal(7,2))) AND (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 10) as decimal(10,0)) as decimal(12,2)))) AND ((cast(i_current_price#569 as decimal(12,2)) >= cast(cast((64 + 1) as decimal(10,0)) as decimal(12,2))) AND (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 15) as decimal(10,0)) as decimal(12,2))))))))
                     +- Join Inner
                        :- Join Inner
                        :  :- Join Inner
                        :  :  :- Join Inner
                        :  :  :  :- Join Inner
                        :  :  :  :  :- Join Inner
                        :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- SubqueryAlias store_sales
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- Relation[ss_sold_time_sk#130,ss_item_sk#131,ss_customer_sk#132,ss_cdemo_sk#133,ss_hdemo_sk#134,ss_addr_sk#135,ss_store_sk#136,ss_promo_sk#137,ss_ticket_number#138L,ss_quantity#139,ss_wholesale_cost#140,ss_list_price#141,ss_sales_price#142,ss_ext_discount_amt#143,ss_ext_sales_price#144,ss_ext_wholesale_cost#145,ss_ext_list_price#146,ss_ext_tax#147,ss_coupon_amt#148,ss_net_paid#149,ss_net_paid_inc_tax#150,ss_net_profit#151,ss_sold_date_sk#152] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias store_returns
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Relation[sr_return_time_sk#176,sr_item_sk#177,sr_customer_sk#178,sr_cdemo_sk#179,sr_hdemo_sk#180,sr_addr_sk#181,sr_store_sk#182,sr_reason_sk#183,sr_ticket_number#184L,sr_return_quantity#185,sr_return_amt#186,sr_return_tax#187,sr_return_amt_inc_tax#188,sr_fee#189,sr_return_ship_cost#190,sr_refunded_cash#191,sr_reversed_charge#192,sr_store_credit#193,sr_net_loss#194,sr_returned_date_sk#195] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias cs_ui
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Project [cs_item_sk#14, sale#5106, refund#5107]
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Filter (cast(sum(cs_ext_list_price#24)#5141 as decimal(21,2)) > cast(CheckOverflow((promote_precision(cast(cast(2 as decimal(1,0)) as decimal(19,2))) * promote_precision(cast(sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#90 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#91 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#92 as decimal(9,2)))), DecimalType(9,2), true))#5142 as decimal(19,2)))), DecimalType(21,2), true) as decimal(21,2)))
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :           +- Aggregate [cs_item_sk#14], [cs_item_sk#14, sum(cs_ext_list_price#24) AS sale#5106, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#90 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#91 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#92 as decimal(9,2)))), DecimalType(9,2), true)) AS refund#5107, sum(cs_ext_list_price#24) AS sum(cs_ext_list_price#24)#5141, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#90 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#91 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#92 as decimal(9,2)))), DecimalType(9,2), true)) AS sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#90 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#91 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#92 as decimal(9,2)))), DecimalType(9,2), true))#5142]
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :              +- Filter ((cs_item_sk#14 = cr_item_sk#69) AND (cs_order_number#16L = cr_order_number#83L))
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                 +- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :- SubqueryAlias catalog_sales
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :  +- Relation[cs_sold_time_sk#0,cs_ship_date_sk#1,cs_bill_customer_sk#2,cs_bill_cdemo_sk#3,cs_bill_hdemo_sk#4,cs_bill_addr_sk#5,cs_ship_customer_sk#6,cs_ship_cdemo_sk#7,cs_ship_hdemo_sk#8,cs_ship_addr_sk#9,cs_call_center_sk#10,cs_catalog_page_sk#11,cs_ship_mode_sk#12,cs_warehouse_sk#13,cs_item_sk#14,cs_promo_sk#15,cs_order_number#16L,cs_quantity#17,cs_wholesale_cost#18,cs_list_price#19,cs_sales_price#20,cs_ext_discount_amt#21,cs_ext_sales_price#22,cs_ext_wholesale_cost#23,... 10 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    +- SubqueryAlias catalog_returns
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                       +- Relation[cr_returned_time_sk#68,cr_item_sk#69,cr_refunded_customer_sk#70,cr_refunded_cdemo_sk#71,cr_refunded_hdemo_sk#72,cr_refunded_addr_sk#73,cr_returning_customer_sk#74,cr_returning_cdemo_sk#75,cr_returning_hdemo_sk#76,cr_returning_addr_sk#77,cr_call_center_sk#78,cr_catalog_page_sk#79,cr_ship_mode_sk#80,cr_warehouse_sk#81,cr_reason_sk#82,cr_order_number#83L,cr_return_quantity#84,cr_return_amount#85,cr_return_tax#86,cr_return_amt_inc_tax#87,cr_fee#88,cr_return_ship_cost#89,cr_refunded_cash#90,cr_reversed_charge#91,... 3 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias d1
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias date_dim
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias d2
                        :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias date_dim
                        :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#5229,d_date_id#5230,d_date#5231,d_month_seq#5232,d_week_seq#5233,d_quarter_seq#5234,d_year#5235,d_dow#5236,d_moy#5237,d_dom#5238,d_qoy#5239,d_fy_year#5240,d_fy_quarter_seq#5241,d_fy_week_seq#5242,d_day_name#5243,d_quarter_name#5244,d_holiday#5245,d_weekend#5246,d_following_holiday#5247,d_first_dom#5248,d_last_dom#5249,d_same_day_ly#5250,d_same_day_lq#5251,d_current_day#5252,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias d3
                        :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias date_dim
                        :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#5257,d_date_id#5258,d_date#5259,d_month_seq#5260,d_week_seq#5261,d_quarter_seq#5262,d_year#5263,d_dow#5264,d_moy#5265,d_dom#5266,d_qoy#5267,d_fy_year#5268,d_fy_quarter_seq#5269,d_fy_week_seq#5270,d_day_name#5271,d_quarter_name#5272,d_holiday#5273,d_weekend#5274,d_following_holiday#5275,d_first_dom#5276,d_last_dom#5277,d_same_day_ly#5278,d_same_day_lq#5279,d_current_day#5280,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias store
                        :  :  :  :  :  :  :  :  :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias customer
                        :  :  :  :  :  :  :  :  :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                        :  :  :  :  :  :  :  :  :  +- SubqueryAlias cd1
                        :  :  :  :  :  :  :  :  :     +- SubqueryAlias customer_demographics
                        :  :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
                        :  :  :  :  :  :  :  :  +- SubqueryAlias cd2
                        :  :  :  :  :  :  :  :     +- SubqueryAlias customer_demographics
                        :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#5285,cd_gender#5286,cd_marital_status#5287,cd_education_status#5288,cd_purchase_estimate#5289,cd_credit_rating#5290,cd_dep_count#5291,cd_dep_employed_count#5292,cd_dep_college_count#5293] parquet
                        :  :  :  :  :  :  :  +- SubqueryAlias promotion
                        :  :  :  :  :  :  :     +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet
                        :  :  :  :  :  :  +- SubqueryAlias hd1
                        :  :  :  :  :  :     +- SubqueryAlias household_demographics
                        :  :  :  :  :  :        +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
                        :  :  :  :  :  +- SubqueryAlias hd2
                        :  :  :  :  :     +- SubqueryAlias household_demographics
                        :  :  :  :  :        +- Relation[hd_demo_sk#5294,hd_income_band_sk#5295,hd_buy_potential#5296,hd_dep_count#5297,hd_vehicle_count#5298] parquet
                        :  :  :  :  +- SubqueryAlias ad1
                        :  :  :  :     +- SubqueryAlias customer_address
                        :  :  :  :        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                        :  :  :  +- SubqueryAlias ad2
                        :  :  :     +- SubqueryAlias customer_address
                        :  :  :        +- Relation[ca_address_sk#5299,ca_address_id#5300,ca_street_number#5301,ca_street_name#5302,ca_street_type#5303,ca_suite_number#5304,ca_city#5305,ca_county#5306,ca_state#5307,ca_zip#5308,ca_country#5309,ca_gmt_offset#5310,ca_location_type#5311] parquet
                        :  :  +- SubqueryAlias ib1
                        :  :     +- SubqueryAlias income_band
                        :  :        +- Relation[ib_income_band_sk#558,ib_lower_bound#559,ib_upper_bound#560] parquet
                        :  +- SubqueryAlias ib2
                        :     +- SubqueryAlias income_band
                        :        +- Relation[ib_income_band_sk#5312,ib_lower_bound#5313,ib_upper_bound#5314] parquet
                        +- SubqueryAlias item
                           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

      running Thread[benchmark runner,5,main]
2022-09-08 15:18:35,206 WARN adaptive.InsertAdaptiveSparkPlan: spark.sql.adaptive.enabled is enabled but is not supported for query: Sort [product_name#5373 ASC NULLS FIRST, store_name#5375 ASC NULLS FIRST, cnt#5607L ASC NULLS FIRST], true, 0
+- Project [product_name#5373, store_name#5375, store_zip#5376, b_street_number#5377, b_streen_name#5378, b_city#5379, b_zip#5380, c_street_number#5381, c_street_name#5382, c_city#5383, c_zip#5384, syear#5385, cnt#5388L, s1#5389, s2#5390, s3#5391, s1#5608, s2#5609, s3#5610, syear#5604, cnt#5607L]
   +- SortMergeJoin [item_sk#5374, store_name#5375, store_zip#5376], [item_sk#5593, store_name#5594, store_zip#5595], Inner, (cnt#5607L <= cnt#5388L)
      :- HashAggregate(keys=[i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#5480, ca_street_name#5481, ca_city#5484, ca_zip#5487, d_year#498, d_year#5414, d_year#5442], functions=[count(1), sum(UnscaledValue(ss_wholesale_cost#140)), sum(UnscaledValue(ss_list_price#141)), sum(UnscaledValue(ss_coupon_amt#148))], output=[product_name#5373, item_sk#5374, store_name#5375, store_zip#5376, b_street_number#5377, b_streen_name#5378, b_city#5379, b_zip#5380, c_street_number#5381, c_street_name#5382, c_city#5383, c_zip#5384, syear#5385, cnt#5388L, s1#5389, s2#5390, s3#5391])
      :  +- HashAggregate(keys=[i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#5480, ca_street_name#5481, ca_city#5484, ca_zip#5487, d_year#498, d_year#5414, d_year#5442], functions=[partial_count(1), partial_sum(UnscaledValue(ss_wholesale_cost#140)), partial_sum(UnscaledValue(ss_list_price#141)), partial_sum(UnscaledValue(ss_coupon_amt#148))], output=[i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#5480, ca_street_name#5481, ca_city#5484, ca_zip#5487, d_year#498, d_year#5414, d_year#5442, count#5642L, sum#5643L, sum#5644L, sum#5645L])
      :     +- Project [ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, d_year#5414, d_year#5442, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#5480, ca_street_name#5481, ca_city#5484, ca_zip#5487, i_item_sk#564, i_product_name#585]
      :        +- BroadcastHashJoin [ss_item_sk#131], [i_item_sk#564], Inner, BuildRight, false
      :           :- Project [ss_item_sk#131, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, d_year#5414, d_year#5442, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#5480, ca_street_name#5481, ca_city#5484, ca_zip#5487]
      :           :  +- BroadcastHashJoin [hd_income_band_sk#5474], [ib_income_band_sk#5491], Inner, BuildRight, false
      :           :     :- Project [ss_item_sk#131, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, d_year#5414, d_year#5442, hd_income_band_sk#5474, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#5480, ca_street_name#5481, ca_city#5484, ca_zip#5487]
      :           :     :  +- BroadcastHashJoin [hd_income_band_sk#549], [ib_income_band_sk#558], Inner, BuildRight, false
      :           :     :     :- Project [ss_item_sk#131, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, d_year#5414, d_year#5442, hd_income_band_sk#549, hd_income_band_sk#5474, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#5480, ca_street_name#5481, ca_city#5484, ca_zip#5487]
      :           :     :     :  +- BroadcastHashJoin [c_current_addr_sk#416], [ca_address_sk#5478], Inner, BuildRight, false
      :           :     :     :     :- Project [ss_item_sk#131, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_addr_sk#416, d_year#5414, d_year#5442, hd_income_band_sk#549, hd_income_band_sk#5474, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457]
      :           :     :     :     :  +- BroadcastHashJoin [ss_addr_sk#135], [ca_address_sk#448], Inner, BuildRight, false
      :           :     :     :     :     :- Project [ss_item_sk#131, ss_addr_sk#135, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_addr_sk#416, d_year#5414, d_year#5442, hd_income_band_sk#549, hd_income_band_sk#5474]
      :           :     :     :     :     :  +- BroadcastHashJoin [c_current_hdemo_sk#415], [hd_demo_sk#5473], Inner, BuildRight, false
      :           :     :     :     :     :     :- Project [ss_item_sk#131, ss_addr_sk#135, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_hdemo_sk#415, c_current_addr_sk#416, d_year#5414, d_year#5442, hd_income_band_sk#549]
      :           :     :     :     :     :     :  +- BroadcastHashJoin [ss_hdemo_sk#134], [hd_demo_sk#548], Inner, BuildRight, false
      :           :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_hdemo_sk#134, ss_addr_sk#135, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_hdemo_sk#415, c_current_addr_sk#416, d_year#5414, d_year#5442]
      :           :     :     :     :     :     :     :  +- BroadcastHashJoin [ss_promo_sk#137], [p_promo_sk#608], Inner, BuildRight, false
      :           :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_hdemo_sk#134, ss_addr_sk#135, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_hdemo_sk#415, c_current_addr_sk#416, d_year#5414, d_year#5442]
      :           :     :     :     :     :     :     :     :  +- BroadcastHashJoin [c_current_cdemo_sk#414], [cd_demo_sk#5464], Inner, BuildRight, NOT (cd_marital_status#476 = cd_marital_status#5466), false
      :           :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_hdemo_sk#134, ss_addr_sk#135, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_cdemo_sk#414, c_current_hdemo_sk#415, c_current_addr_sk#416, d_year#5414, d_year#5442, cd_marital_status#476]
      :           :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [ss_cdemo_sk#133], [cd_demo_sk#474], Inner, BuildRight, false
      :           :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_cdemo_sk#414, c_current_hdemo_sk#415, c_current_addr_sk#416, d_year#5414, d_year#5442]
      :           :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [c_first_shipto_date_sk#417], [d_date_sk#5436], Inner, BuildRight, false
      :           :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_cdemo_sk#414, c_current_hdemo_sk#415, c_current_addr_sk#416, c_first_shipto_date_sk#417, d_year#5414]
      :           :     :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [c_first_sales_date_sk#418], [d_date_sk#5408], Inner, BuildRight, false
      :           :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_cdemo_sk#414, c_current_hdemo_sk#415, c_current_addr_sk#416, c_first_shipto_date_sk#417, c_first_sales_date_sk#418]
      :           :     :     :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [ss_customer_sk#132], [c_customer_sk#412], Inner, BuildRight, false
      :           :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_customer_sk#132, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689]
      :           :     :     :     :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [ss_store_sk#136], [s_store_sk#664], Inner, BuildRight, false
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_customer_sk#132, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_store_sk#136, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498]
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [ss_sold_date_sk#152], [d_date_sk#492], Inner, BuildRight, false
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_customer_sk#132, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_store_sk#136, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, ss_sold_date_sk#152]
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- SortMergeJoin [ss_item_sk#131], [cs_item_sk#14], Inner
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_customer_sk#132, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_store_sk#136, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, ss_sold_date_sk#152]
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- SortMergeJoin [ss_item_sk#131, ss_ticket_number#138L], [sr_item_sk#177, sr_ticket_number#184L], Inner
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_customer_sk#132, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_store_sk#136, ss_promo_sk#137, ss_ticket_number#138L, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, ss_sold_date_sk#152]
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- Filter (((((((isnotnull(ss_item_sk#131) AND isnotnull(ss_ticket_number#138L)) AND isnotnull(ss_store_sk#136)) AND isnotnull(ss_customer_sk#132)) AND isnotnull(ss_cdemo_sk#133)) AND isnotnull(ss_promo_sk#137)) AND isnotnull(ss_hdemo_sk#134)) AND isnotnull(ss_addr_sk#135))
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- FileScan parquet [ss_item_sk#131,ss_customer_sk#132,ss_cdemo_sk#133,ss_hdemo_sk#134,ss_addr_sk#135,ss_store_sk#136,ss_promo_sk#137,ss_ticket_number#138L,ss_wholesale_cost#140,ss_list_price#141,ss_coupon_amt#148,ss_sold_date_sk#152] Batched: true, DataFilters: [isnotnull(ss_item_sk#131), isnotnull(ss_ticket_number#138L), isnotnull(ss_store_sk#136), isnotnu..., Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/store_sales], PartitionFilters: [isnotnull(ss_sold_date_sk#152), dynamicpruning#5636 [ss_sold_date_sk#152]], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_ticket_number), IsNotNull(ss_store_sk), IsNotNull(ss_custome..., ReadSchema: struct<ss_item_sk:int,ss_customer_sk:int,ss_cdemo_sk:int,ss_hdemo_sk:int,ss_addr_sk:int,ss_store_...
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- Project [d_date_sk#492, d_year#498]
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :              +- Filter ((isnotnull(d_year#498) AND (d_year#498 = 1999)) AND isnotnull(d_date_sk#492))
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                 +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [sr_item_sk#177, sr_ticket_number#184L]
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter (isnotnull(sr_item_sk#177) AND isnotnull(sr_ticket_number#184L))
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- FileScan parquet [sr_item_sk#177,sr_ticket_number#184L,sr_returned_date_sk#195] Batched: true, DataFilters: [isnotnull(sr_item_sk#177), isnotnull(sr_ticket_number#184L)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/store_returns], PartitionFilters: [], PushedFilters: [IsNotNull(sr_item_sk), IsNotNull(sr_ticket_number)], ReadSchema: struct<sr_item_sk:int,sr_ticket_number:bigint>
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [cs_item_sk#14]
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter (isnotnull(sum(cs_ext_list_price#24)#5401) AND (cast(sum(cs_ext_list_price#24)#5401 as decimal(21,2)) > CheckOverflow((2.00 * promote_precision(sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#90 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#91 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#92 as decimal(9,2)))), DecimalType(9,2), true))#5402)), DecimalType(21,2), true)))
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- HashAggregate(keys=[cs_item_sk#14], functions=[sum(UnscaledValue(cs_ext_list_price#24)), sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#90 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#91 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#92 as decimal(9,2)))), DecimalType(9,2), true))], output=[cs_item_sk#14, sum(cs_ext_list_price#24)#5401, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#90 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#91 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#92 as decimal(9,2)))), DecimalType(9,2), true))#5402])
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :              +- HashAggregate(keys=[cs_item_sk#14], functions=[partial_sum(UnscaledValue(cs_ext_list_price#24)), partial_sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#90 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#91 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#92 as decimal(9,2)))), DecimalType(9,2), true))], output=[cs_item_sk#14, sum#5649L, sum#5650, isEmpty#5651])
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                 +- Project [cs_item_sk#14, cs_ext_list_price#24, cr_refunded_cash#90, cr_reversed_charge#91, cr_store_credit#92]
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                    +- SortMergeJoin [cs_item_sk#14, cs_order_number#16L], [cr_item_sk#69, cr_order_number#83L], Inner
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                       :- Project [cs_item_sk#14, cs_order_number#16L, cs_ext_list_price#24]
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                       :  +- Filter (isnotnull(cs_item_sk#14) AND isnotnull(cs_order_number#16L))
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                       :     +- FileScan parquet [cs_item_sk#14,cs_order_number#16L,cs_ext_list_price#24,cs_sold_date_sk#33] Batched: true, DataFilters: [isnotnull(cs_item_sk#14), isnotnull(cs_order_number#16L)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/catalog_sales], PartitionFilters: [], PushedFilters: [IsNotNull(cs_item_sk), IsNotNull(cs_order_number)], ReadSchema: struct<cs_item_sk:int,cs_order_number:bigint,cs_ext_list_price:decimal(7,2)>
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                       +- Project [cr_item_sk#69, cr_order_number#83L, cr_refunded_cash#90, cr_reversed_charge#91, cr_store_credit#92]
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                          +- Filter (isnotnull(cr_item_sk#69) AND isnotnull(cr_order_number#83L))
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                             +- FileScan parquet [cr_item_sk#69,cr_order_number#83L,cr_refunded_cash#90,cr_reversed_charge#91,cr_store_credit#92,cr_returned_date_sk#94] Batched: true, DataFilters: [isnotnull(cr_item_sk#69), isnotnull(cr_order_number#83L)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/catalog_returns], PartitionFilters: [], PushedFilters: [IsNotNull(cr_item_sk), IsNotNull(cr_order_number)], ReadSchema: struct<cr_item_sk:int,cr_order_number:bigint,cr_refunded_cash:decimal(7,2),cr_reversed_charge:dec...
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [d_date_sk#492, d_year#498]
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter ((isnotnull(d_year#498) AND (d_year#498 = 1999)) AND isnotnull(d_date_sk#492))
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- FileScan parquet [d_date_sk#492,d_year#498] Batched: true, DataFilters: [isnotnull(d_year#498), (d_year#498 = 1999), isnotnull(d_date_sk#492)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), EqualTo(d_year,1999), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
      :           :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [s_store_sk#664, s_store_name#669, s_zip#689]
      :           :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter ((isnotnull(s_store_sk#664) AND isnotnull(s_store_name#669)) AND isnotnull(s_zip#689))
      :           :     :     :     :     :     :     :     :     :     :     :     :     :           +- FileScan parquet [s_store_sk#664,s_store_name#669,s_zip#689] Batched: true, DataFilters: [isnotnull(s_store_sk#664), isnotnull(s_store_name#669), isnotnull(s_zip#689)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/store], PartitionFilters: [], PushedFilters: [IsNotNull(s_store_sk), IsNotNull(s_store_name), IsNotNull(s_zip)], ReadSchema: struct<s_store_sk:int,s_store_name:string,s_zip:string>
      :           :     :     :     :     :     :     :     :     :     :     :     :     +- Project [c_customer_sk#412, c_current_cdemo_sk#414, c_current_hdemo_sk#415, c_current_addr_sk#416, c_first_shipto_date_sk#417, c_first_sales_date_sk#418]
      :           :     :     :     :     :     :     :     :     :     :     :     :        +- Filter (((((isnotnull(c_customer_sk#412) AND isnotnull(c_first_sales_date_sk#418)) AND isnotnull(c_first_shipto_date_sk#417)) AND isnotnull(c_current_cdemo_sk#414)) AND isnotnull(c_current_hdemo_sk#415)) AND isnotnull(c_current_addr_sk#416))
      :           :     :     :     :     :     :     :     :     :     :     :     :           +- FileScan parquet [c_customer_sk#412,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418] Batched: true, DataFilters: [isnotnull(c_customer_sk#412), isnotnull(c_first_sales_date_sk#418), isnotnull(c_first_shipto_dat..., Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/customer], PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk), IsNotNull(c_first_sales_date_sk), IsNotNull(c_first_shipto_date_sk), I..., ReadSchema: struct<c_customer_sk:int,c_current_cdemo_sk:int,c_current_hdemo_sk:int,c_current_addr_sk:int,c_fi...
      :           :     :     :     :     :     :     :     :     :     :     :     +- Project [d_date_sk#5408, d_year#5414]
      :           :     :     :     :     :     :     :     :     :     :     :        +- Filter isnotnull(d_date_sk#5408)
      :           :     :     :     :     :     :     :     :     :     :     :           +- FileScan parquet [d_date_sk#5408,d_year#5414] Batched: true, DataFilters: [isnotnull(d_date_sk#5408)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
      :           :     :     :     :     :     :     :     :     :     :     +- Project [d_date_sk#5436, d_year#5442]
      :           :     :     :     :     :     :     :     :     :     :        +- Filter isnotnull(d_date_sk#5436)
      :           :     :     :     :     :     :     :     :     :     :           +- FileScan parquet [d_date_sk#5436,d_year#5442] Batched: true, DataFilters: [isnotnull(d_date_sk#5436)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
      :           :     :     :     :     :     :     :     :     :     +- Project [cd_demo_sk#474, cd_marital_status#476]
      :           :     :     :     :     :     :     :     :     :        +- Filter (isnotnull(cd_demo_sk#474) AND isnotnull(cd_marital_status#476))
      :           :     :     :     :     :     :     :     :     :           +- FileScan parquet [cd_demo_sk#474,cd_marital_status#476] Batched: true, DataFilters: [isnotnull(cd_demo_sk#474), isnotnull(cd_marital_status#476)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/customer_demographics], PartitionFilters: [], PushedFilters: [IsNotNull(cd_demo_sk), IsNotNull(cd_marital_status)], ReadSchema: struct<cd_demo_sk:int,cd_marital_status:string>
      :           :     :     :     :     :     :     :     :     +- Project [cd_demo_sk#5464, cd_marital_status#5466]
      :           :     :     :     :     :     :     :     :        +- Filter (isnotnull(cd_demo_sk#5464) AND isnotnull(cd_marital_status#5466))
      :           :     :     :     :     :     :     :     :           +- FileScan parquet [cd_demo_sk#5464,cd_marital_status#5466] Batched: true, DataFilters: [isnotnull(cd_demo_sk#5464), isnotnull(cd_marital_status#5466)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/customer_demographics], PartitionFilters: [], PushedFilters: [IsNotNull(cd_demo_sk), IsNotNull(cd_marital_status)], ReadSchema: struct<cd_demo_sk:int,cd_marital_status:string>
      :           :     :     :     :     :     :     :     +- Project [p_promo_sk#608]
      :           :     :     :     :     :     :     :        +- Filter isnotnull(p_promo_sk#608)
      :           :     :     :     :     :     :     :           +- FileScan parquet [p_promo_sk#608] Batched: true, DataFilters: [isnotnull(p_promo_sk#608)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/promotion], PartitionFilters: [], PushedFilters: [IsNotNull(p_promo_sk)], ReadSchema: struct<p_promo_sk:int>
      :           :     :     :     :     :     :     +- Project [hd_demo_sk#548, hd_income_band_sk#549]
      :           :     :     :     :     :     :        +- Filter (isnotnull(hd_demo_sk#548) AND isnotnull(hd_income_band_sk#549))
      :           :     :     :     :     :     :           +- FileScan parquet [hd_demo_sk#548,hd_income_band_sk#549] Batched: true, DataFilters: [isnotnull(hd_demo_sk#548), isnotnull(hd_income_band_sk#549)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/household_demographics], PartitionFilters: [], PushedFilters: [IsNotNull(hd_demo_sk), IsNotNull(hd_income_band_sk)], ReadSchema: struct<hd_demo_sk:int,hd_income_band_sk:int>
      :           :     :     :     :     :     +- Project [hd_demo_sk#5473, hd_income_band_sk#5474]
      :           :     :     :     :     :        +- Filter (isnotnull(hd_demo_sk#5473) AND isnotnull(hd_income_band_sk#5474))
      :           :     :     :     :     :           +- FileScan parquet [hd_demo_sk#5473,hd_income_band_sk#5474] Batched: true, DataFilters: [isnotnull(hd_demo_sk#5473), isnotnull(hd_income_band_sk#5474)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/household_demographics], PartitionFilters: [], PushedFilters: [IsNotNull(hd_demo_sk), IsNotNull(hd_income_band_sk)], ReadSchema: struct<hd_demo_sk:int,hd_income_band_sk:int>
      :           :     :     :     :     +- Project [ca_address_sk#448, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457]
      :           :     :     :     :        +- Filter isnotnull(ca_address_sk#448)
      :           :     :     :     :           +- FileScan parquet [ca_address_sk#448,ca_street_number#450,ca_street_name#451,ca_city#454,ca_zip#457] Batched: true, DataFilters: [isnotnull(ca_address_sk#448)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/customer_address], PartitionFilters: [], PushedFilters: [IsNotNull(ca_address_sk)], ReadSchema: struct<ca_address_sk:int,ca_street_number:string,ca_street_name:string,ca_city:string,ca_zip:string>
      :           :     :     :     +- Project [ca_address_sk#5478, ca_street_number#5480, ca_street_name#5481, ca_city#5484, ca_zip#5487]
      :           :     :     :        +- Filter isnotnull(ca_address_sk#5478)
      :           :     :     :           +- FileScan parquet [ca_address_sk#5478,ca_street_number#5480,ca_street_name#5481,ca_city#5484,ca_zip#5487] Batched: true, DataFilters: [isnotnull(ca_address_sk#5478)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/customer_address], PartitionFilters: [], PushedFilters: [IsNotNull(ca_address_sk)], ReadSchema: struct<ca_address_sk:int,ca_street_number:string,ca_street_name:string,ca_city:string,ca_zip:string>
      :           :     :     +- Project [ib_income_band_sk#558]
      :           :     :        +- Filter isnotnull(ib_income_band_sk#558)
      :           :     :           +- FileScan parquet [ib_income_band_sk#558] Batched: true, DataFilters: [isnotnull(ib_income_band_sk#558)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/income_band], PartitionFilters: [], PushedFilters: [IsNotNull(ib_income_band_sk)], ReadSchema: struct<ib_income_band_sk:int>
      :           :     +- Project [ib_income_band_sk#5491]
      :           :        +- Filter isnotnull(ib_income_band_sk#5491)
      :           :           +- FileScan parquet [ib_income_band_sk#5491] Batched: true, DataFilters: [isnotnull(ib_income_band_sk#5491)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/income_band], PartitionFilters: [], PushedFilters: [IsNotNull(ib_income_band_sk)], ReadSchema: struct<ib_income_band_sk:int>
      :           +- Project [i_item_sk#564, i_product_name#585]
      :              +- Filter ((((((isnotnull(i_current_price#569) AND i_color#581 IN (purple,burlywood,indian,spring,floral,medium)) AND (i_current_price#569 >= 64.00)) AND (i_current_price#569 <= 74.00)) AND (i_current_price#569 >= 65.00)) AND (i_current_price#569 <= 79.00)) AND isnotnull(i_item_sk#564))
      :                 +- FileScan parquet [i_item_sk#564,i_current_price#569,i_color#581,i_product_name#585] Batched: true, DataFilters: [isnotnull(i_current_price#569), i_color#581 IN (purple,burlywood,indian,spring,floral,medium), (..., Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/item], PartitionFilters: [], PushedFilters: [IsNotNull(i_current_price), In(i_color, [purple,burlywood,indian,spring,floral,medium]), Greater..., ReadSchema: struct<i_item_sk:int,i_current_price:decimal(7,2),i_color:string,i_product_name:string>
      +- HashAggregate(keys=[i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#5566, ca_street_name#5567, ca_city#5570, ca_zip#5573, d_year#498, d_year#5500, d_year#5528], functions=[count(1), sum(UnscaledValue(ss_wholesale_cost#140)), sum(UnscaledValue(ss_list_price#141)), sum(UnscaledValue(ss_coupon_amt#148))], output=[item_sk#5593, store_name#5594, store_zip#5595, syear#5604, cnt#5607L, s1#5608, s2#5609, s3#5610])
         +- HashAggregate(keys=[i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#5566, ca_street_name#5567, ca_city#5570, ca_zip#5573, d_year#498, d_year#5500, d_year#5528], functions=[partial_count(1), partial_sum(UnscaledValue(ss_wholesale_cost#140)), partial_sum(UnscaledValue(ss_list_price#141)), partial_sum(UnscaledValue(ss_coupon_amt#148))], output=[i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#5566, ca_street_name#5567, ca_city#5570, ca_zip#5573, d_year#498, d_year#5500, d_year#5528, count#5656L, sum#5657L, sum#5658L, sum#5659L])
            +- Project [ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, d_year#5500, d_year#5528, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#5566, ca_street_name#5567, ca_city#5570, ca_zip#5573, i_item_sk#564, i_product_name#585]
               +- BroadcastHashJoin [ss_item_sk#131], [i_item_sk#564], Inner, BuildRight, false
                  :- Project [ss_item_sk#131, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, d_year#5500, d_year#5528, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#5566, ca_street_name#5567, ca_city#5570, ca_zip#5573]
                  :  +- BroadcastHashJoin [hd_income_band_sk#5560], [ib_income_band_sk#5577], Inner, BuildRight, false
                  :     :- Project [ss_item_sk#131, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, d_year#5500, d_year#5528, hd_income_band_sk#5560, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#5566, ca_street_name#5567, ca_city#5570, ca_zip#5573]
                  :     :  +- BroadcastHashJoin [hd_income_band_sk#549], [ib_income_band_sk#558], Inner, BuildRight, false
                  :     :     :- Project [ss_item_sk#131, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, d_year#5500, d_year#5528, hd_income_band_sk#549, hd_income_band_sk#5560, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#5566, ca_street_name#5567, ca_city#5570, ca_zip#5573]
                  :     :     :  +- BroadcastHashJoin [c_current_addr_sk#416], [ca_address_sk#5564], Inner, BuildRight, false
                  :     :     :     :- Project [ss_item_sk#131, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_addr_sk#416, d_year#5500, d_year#5528, hd_income_band_sk#549, hd_income_band_sk#5560, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457]
                  :     :     :     :  +- BroadcastHashJoin [ss_addr_sk#135], [ca_address_sk#448], Inner, BuildRight, false
                  :     :     :     :     :- Project [ss_item_sk#131, ss_addr_sk#135, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_addr_sk#416, d_year#5500, d_year#5528, hd_income_band_sk#549, hd_income_band_sk#5560]
                  :     :     :     :     :  +- BroadcastHashJoin [c_current_hdemo_sk#415], [hd_demo_sk#5559], Inner, BuildRight, false
                  :     :     :     :     :     :- Project [ss_item_sk#131, ss_addr_sk#135, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_hdemo_sk#415, c_current_addr_sk#416, d_year#5500, d_year#5528, hd_income_band_sk#549]
                  :     :     :     :     :     :  +- BroadcastHashJoin [ss_hdemo_sk#134], [hd_demo_sk#548], Inner, BuildRight, false
                  :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_hdemo_sk#134, ss_addr_sk#135, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_hdemo_sk#415, c_current_addr_sk#416, d_year#5500, d_year#5528]
                  :     :     :     :     :     :     :  +- BroadcastHashJoin [ss_promo_sk#137], [p_promo_sk#608], Inner, BuildRight, false
                  :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_hdemo_sk#134, ss_addr_sk#135, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_hdemo_sk#415, c_current_addr_sk#416, d_year#5500, d_year#5528]
                  :     :     :     :     :     :     :     :  +- BroadcastHashJoin [c_current_cdemo_sk#414], [cd_demo_sk#5550], Inner, BuildRight, NOT (cd_marital_status#476 = cd_marital_status#5552), false
                  :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_hdemo_sk#134, ss_addr_sk#135, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_cdemo_sk#414, c_current_hdemo_sk#415, c_current_addr_sk#416, d_year#5500, d_year#5528, cd_marital_status#476]
                  :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [ss_cdemo_sk#133], [cd_demo_sk#474], Inner, BuildRight, false
                  :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_cdemo_sk#414, c_current_hdemo_sk#415, c_current_addr_sk#416, d_year#5500, d_year#5528]
                  :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [c_first_shipto_date_sk#417], [d_date_sk#5522], Inner, BuildRight, false
                  :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_cdemo_sk#414, c_current_hdemo_sk#415, c_current_addr_sk#416, c_first_shipto_date_sk#417, d_year#5500]
                  :     :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [c_first_sales_date_sk#418], [d_date_sk#5494], Inner, BuildRight, false
                  :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689, c_current_cdemo_sk#414, c_current_hdemo_sk#415, c_current_addr_sk#416, c_first_shipto_date_sk#417, c_first_sales_date_sk#418]
                  :     :     :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [ss_customer_sk#132], [c_customer_sk#412], Inner, BuildRight, false
                  :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_customer_sk#132, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498, s_store_name#669, s_zip#689]
                  :     :     :     :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [ss_store_sk#136], [s_store_sk#664], Inner, BuildRight, false
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_customer_sk#132, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_store_sk#136, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, d_year#498]
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [ss_sold_date_sk#152], [d_date_sk#492], Inner, BuildRight, false
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_customer_sk#132, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_store_sk#136, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, ss_sold_date_sk#152]
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- SortMergeJoin [ss_item_sk#131], [cs_item_sk#14], Inner
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_customer_sk#132, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_store_sk#136, ss_promo_sk#137, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, ss_sold_date_sk#152]
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- SortMergeJoin [ss_item_sk#131, ss_ticket_number#138L], [sr_item_sk#177, sr_ticket_number#184L], Inner
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#131, ss_customer_sk#132, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_store_sk#136, ss_promo_sk#137, ss_ticket_number#138L, ss_wholesale_cost#140, ss_list_price#141, ss_coupon_amt#148, ss_sold_date_sk#152]
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- Filter (((((((isnotnull(ss_item_sk#131) AND isnotnull(ss_ticket_number#138L)) AND isnotnull(ss_store_sk#136)) AND isnotnull(ss_customer_sk#132)) AND isnotnull(ss_cdemo_sk#133)) AND isnotnull(ss_promo_sk#137)) AND isnotnull(ss_hdemo_sk#134)) AND isnotnull(ss_addr_sk#135))
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- FileScan parquet [ss_item_sk#131,ss_customer_sk#132,ss_cdemo_sk#133,ss_hdemo_sk#134,ss_addr_sk#135,ss_store_sk#136,ss_promo_sk#137,ss_ticket_number#138L,ss_wholesale_cost#140,ss_list_price#141,ss_coupon_amt#148,ss_sold_date_sk#152] Batched: true, DataFilters: [isnotnull(ss_item_sk#131), isnotnull(ss_ticket_number#138L), isnotnull(ss_store_sk#136), isnotnu..., Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/store_sales], PartitionFilters: [isnotnull(ss_sold_date_sk#152), dynamicpruning#5637 [ss_sold_date_sk#152]], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_ticket_number), IsNotNull(ss_store_sk), IsNotNull(ss_custome..., ReadSchema: struct<ss_item_sk:int,ss_customer_sk:int,ss_cdemo_sk:int,ss_hdemo_sk:int,ss_addr_sk:int,ss_store_...
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- Project [d_date_sk#492, d_year#498]
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :              +- Filter ((isnotnull(d_year#498) AND (d_year#498 = 2000)) AND isnotnull(d_date_sk#492))
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                 +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [sr_item_sk#177, sr_ticket_number#184L]
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter (isnotnull(sr_item_sk#177) AND isnotnull(sr_ticket_number#184L))
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- FileScan parquet [sr_item_sk#177,sr_ticket_number#184L,sr_returned_date_sk#195] Batched: true, DataFilters: [isnotnull(sr_item_sk#177), isnotnull(sr_ticket_number#184L)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/store_returns], PartitionFilters: [], PushedFilters: [IsNotNull(sr_item_sk), IsNotNull(sr_ticket_number)], ReadSchema: struct<sr_item_sk:int,sr_ticket_number:bigint>
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [cs_item_sk#14]
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter (isnotnull(sum(cs_ext_list_price#24)#5406) AND (cast(sum(cs_ext_list_price#24)#5406 as decimal(21,2)) > CheckOverflow((2.00 * promote_precision(sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#90 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#91 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#92 as decimal(9,2)))), DecimalType(9,2), true))#5407)), DecimalType(21,2), true)))
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- HashAggregate(keys=[cs_item_sk#14], functions=[sum(UnscaledValue(cs_ext_list_price#24)), sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#90 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#91 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#92 as decimal(9,2)))), DecimalType(9,2), true))], output=[cs_item_sk#14, sum(cs_ext_list_price#24)#5406, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#90 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#91 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#92 as decimal(9,2)))), DecimalType(9,2), true))#5407])
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :              +- HashAggregate(keys=[cs_item_sk#14], functions=[partial_sum(UnscaledValue(cs_ext_list_price#24)), partial_sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#90 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#91 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#92 as decimal(9,2)))), DecimalType(9,2), true))], output=[cs_item_sk#14, sum#5663L, sum#5664, isEmpty#5665])
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                 +- Project [cs_item_sk#14, cs_ext_list_price#24, cr_refunded_cash#90, cr_reversed_charge#91, cr_store_credit#92]
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                    +- SortMergeJoin [cs_item_sk#14, cs_order_number#16L], [cr_item_sk#69, cr_order_number#83L], Inner
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                       :- Project [cs_item_sk#14, cs_order_number#16L, cs_ext_list_price#24]
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                       :  +- Filter (isnotnull(cs_item_sk#14) AND isnotnull(cs_order_number#16L))
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                       :     +- FileScan parquet [cs_item_sk#14,cs_order_number#16L,cs_ext_list_price#24,cs_sold_date_sk#33] Batched: true, DataFilters: [isnotnull(cs_item_sk#14), isnotnull(cs_order_number#16L)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/catalog_sales], PartitionFilters: [], PushedFilters: [IsNotNull(cs_item_sk), IsNotNull(cs_order_number)], ReadSchema: struct<cs_item_sk:int,cs_order_number:bigint,cs_ext_list_price:decimal(7,2)>
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                       +- Project [cr_item_sk#69, cr_order_number#83L, cr_refunded_cash#90, cr_reversed_charge#91, cr_store_credit#92]
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                          +- Filter (isnotnull(cr_item_sk#69) AND isnotnull(cr_order_number#83L))
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                             +- FileScan parquet [cr_item_sk#69,cr_order_number#83L,cr_refunded_cash#90,cr_reversed_charge#91,cr_store_credit#92,cr_returned_date_sk#94] Batched: true, DataFilters: [isnotnull(cr_item_sk#69), isnotnull(cr_order_number#83L)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/catalog_returns], PartitionFilters: [], PushedFilters: [IsNotNull(cr_item_sk), IsNotNull(cr_order_number)], ReadSchema: struct<cr_item_sk:int,cr_order_number:bigint,cr_refunded_cash:decimal(7,2),cr_reversed_charge:dec...
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [d_date_sk#492, d_year#498]
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter ((isnotnull(d_year#498) AND (d_year#498 = 2000)) AND isnotnull(d_date_sk#492))
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- FileScan parquet [d_date_sk#492,d_year#498] Batched: true, DataFilters: [isnotnull(d_year#498), (d_year#498 = 2000), isnotnull(d_date_sk#492)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), EqualTo(d_year,2000), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
                  :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [s_store_sk#664, s_store_name#669, s_zip#689]
                  :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter ((isnotnull(s_store_sk#664) AND isnotnull(s_store_name#669)) AND isnotnull(s_zip#689))
                  :     :     :     :     :     :     :     :     :     :     :     :     :           +- FileScan parquet [s_store_sk#664,s_store_name#669,s_zip#689] Batched: true, DataFilters: [isnotnull(s_store_sk#664), isnotnull(s_store_name#669), isnotnull(s_zip#689)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/store], PartitionFilters: [], PushedFilters: [IsNotNull(s_store_sk), IsNotNull(s_store_name), IsNotNull(s_zip)], ReadSchema: struct<s_store_sk:int,s_store_name:string,s_zip:string>
                  :     :     :     :     :     :     :     :     :     :     :     :     +- Project [c_customer_sk#412, c_current_cdemo_sk#414, c_current_hdemo_sk#415, c_current_addr_sk#416, c_first_shipto_date_sk#417, c_first_sales_date_sk#418]
                  :     :     :     :     :     :     :     :     :     :     :     :        +- Filter (((((isnotnull(c_customer_sk#412) AND isnotnull(c_first_sales_date_sk#418)) AND isnotnull(c_first_shipto_date_sk#417)) AND isnotnull(c_current_cdemo_sk#414)) AND isnotnull(c_current_hdemo_sk#415)) AND isnotnull(c_current_addr_sk#416))
                  :     :     :     :     :     :     :     :     :     :     :     :           +- FileScan parquet [c_customer_sk#412,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418] Batched: true, DataFilters: [isnotnull(c_customer_sk#412), isnotnull(c_first_sales_date_sk#418), isnotnull(c_first_shipto_dat..., Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/customer], PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk), IsNotNull(c_first_sales_date_sk), IsNotNull(c_first_shipto_date_sk), I..., ReadSchema: struct<c_customer_sk:int,c_current_cdemo_sk:int,c_current_hdemo_sk:int,c_current_addr_sk:int,c_fi...
                  :     :     :     :     :     :     :     :     :     :     :     +- Project [d_date_sk#5494, d_year#5500]
                  :     :     :     :     :     :     :     :     :     :     :        +- Filter isnotnull(d_date_sk#5494)
                  :     :     :     :     :     :     :     :     :     :     :           +- FileScan parquet [d_date_sk#5494,d_year#5500] Batched: true, DataFilters: [isnotnull(d_date_sk#5494)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
                  :     :     :     :     :     :     :     :     :     :     +- Project [d_date_sk#5522, d_year#5528]
                  :     :     :     :     :     :     :     :     :     :        +- Filter isnotnull(d_date_sk#5522)
                  :     :     :     :     :     :     :     :     :     :           +- FileScan parquet [d_date_sk#5522,d_year#5528] Batched: true, DataFilters: [isnotnull(d_date_sk#5522)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
                  :     :     :     :     :     :     :     :     :     +- Project [cd_demo_sk#474, cd_marital_status#476]
                  :     :     :     :     :     :     :     :     :        +- Filter (isnotnull(cd_demo_sk#474) AND isnotnull(cd_marital_status#476))
                  :     :     :     :     :     :     :     :     :           +- FileScan parquet [cd_demo_sk#474,cd_marital_status#476] Batched: true, DataFilters: [isnotnull(cd_demo_sk#474), isnotnull(cd_marital_status#476)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/customer_demographics], PartitionFilters: [], PushedFilters: [IsNotNull(cd_demo_sk), IsNotNull(cd_marital_status)], ReadSchema: struct<cd_demo_sk:int,cd_marital_status:string>
                  :     :     :     :     :     :     :     :     +- Project [cd_demo_sk#5550, cd_marital_status#5552]
                  :     :     :     :     :     :     :     :        +- Filter (isnotnull(cd_demo_sk#5550) AND isnotnull(cd_marital_status#5552))
                  :     :     :     :     :     :     :     :           +- FileScan parquet [cd_demo_sk#5550,cd_marital_status#5552] Batched: true, DataFilters: [isnotnull(cd_demo_sk#5550), isnotnull(cd_marital_status#5552)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/customer_demographics], PartitionFilters: [], PushedFilters: [IsNotNull(cd_demo_sk), IsNotNull(cd_marital_status)], ReadSchema: struct<cd_demo_sk:int,cd_marital_status:string>
                  :     :     :     :     :     :     :     +- Project [p_promo_sk#608]
                  :     :     :     :     :     :     :        +- Filter isnotnull(p_promo_sk#608)
                  :     :     :     :     :     :     :           +- FileScan parquet [p_promo_sk#608] Batched: true, DataFilters: [isnotnull(p_promo_sk#608)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/promotion], PartitionFilters: [], PushedFilters: [IsNotNull(p_promo_sk)], ReadSchema: struct<p_promo_sk:int>
                  :     :     :     :     :     :     +- Project [hd_demo_sk#548, hd_income_band_sk#549]
                  :     :     :     :     :     :        +- Filter (isnotnull(hd_demo_sk#548) AND isnotnull(hd_income_band_sk#549))
                  :     :     :     :     :     :           +- FileScan parquet [hd_demo_sk#548,hd_income_band_sk#549] Batched: true, DataFilters: [isnotnull(hd_demo_sk#548), isnotnull(hd_income_band_sk#549)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/household_demographics], PartitionFilters: [], PushedFilters: [IsNotNull(hd_demo_sk), IsNotNull(hd_income_band_sk)], ReadSchema: struct<hd_demo_sk:int,hd_income_band_sk:int>
                  :     :     :     :     :     +- Project [hd_demo_sk#5559, hd_income_band_sk#5560]
                  :     :     :     :     :        +- Filter (isnotnull(hd_demo_sk#5559) AND isnotnull(hd_income_band_sk#5560))
                  :     :     :     :     :           +- FileScan parquet [hd_demo_sk#5559,hd_income_band_sk#5560] Batched: true, DataFilters: [isnotnull(hd_demo_sk#5559), isnotnull(hd_income_band_sk#5560)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/household_demographics], PartitionFilters: [], PushedFilters: [IsNotNull(hd_demo_sk), IsNotNull(hd_income_band_sk)], ReadSchema: struct<hd_demo_sk:int,hd_income_band_sk:int>
                  :     :     :     :     +- Project [ca_address_sk#448, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457]
                  :     :     :     :        +- Filter isnotnull(ca_address_sk#448)
                  :     :     :     :           +- FileScan parquet [ca_address_sk#448,ca_street_number#450,ca_street_name#451,ca_city#454,ca_zip#457] Batched: true, DataFilters: [isnotnull(ca_address_sk#448)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/customer_address], PartitionFilters: [], PushedFilters: [IsNotNull(ca_address_sk)], ReadSchema: struct<ca_address_sk:int,ca_street_number:string,ca_street_name:string,ca_city:string,ca_zip:string>
                  :     :     :     +- Project [ca_address_sk#5564, ca_street_number#5566, ca_street_name#5567, ca_city#5570, ca_zip#5573]
                  :     :     :        +- Filter isnotnull(ca_address_sk#5564)
                  :     :     :           +- FileScan parquet [ca_address_sk#5564,ca_street_number#5566,ca_street_name#5567,ca_city#5570,ca_zip#5573] Batched: true, DataFilters: [isnotnull(ca_address_sk#5564)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/customer_address], PartitionFilters: [], PushedFilters: [IsNotNull(ca_address_sk)], ReadSchema: struct<ca_address_sk:int,ca_street_number:string,ca_street_name:string,ca_city:string,ca_zip:string>
                  :     :     +- Project [ib_income_band_sk#558]
                  :     :        +- Filter isnotnull(ib_income_band_sk#558)
                  :     :           +- FileScan parquet [ib_income_band_sk#558] Batched: true, DataFilters: [isnotnull(ib_income_band_sk#558)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/income_band], PartitionFilters: [], PushedFilters: [IsNotNull(ib_income_band_sk)], ReadSchema: struct<ib_income_band_sk:int>
                  :     +- Project [ib_income_band_sk#5577]
                  :        +- Filter isnotnull(ib_income_band_sk#5577)
                  :           +- FileScan parquet [ib_income_band_sk#5577] Batched: true, DataFilters: [isnotnull(ib_income_band_sk#5577)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/income_band], PartitionFilters: [], PushedFilters: [IsNotNull(ib_income_band_sk)], ReadSchema: struct<ib_income_band_sk:int>
                  +- Project [i_item_sk#564, i_product_name#585]
                     +- Filter ((((((isnotnull(i_current_price#569) AND i_color#581 IN (purple,burlywood,indian,spring,floral,medium)) AND (i_current_price#569 >= 64.00)) AND (i_current_price#569 <= 74.00)) AND (i_current_price#569 >= 65.00)) AND (i_current_price#569 <= 79.00)) AND isnotnull(i_item_sk#564))
                        +- FileScan parquet [i_item_sk#564,i_current_price#569,i_color#581,i_product_name#585] Batched: true, DataFilters: [isnotnull(i_current_price#569), i_color#581 IN (purple,burlywood,indian,spring,floral,medium), (..., Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/item], PartitionFilters: [], PushedFilters: [IsNotNull(i_current_price), In(i_color, [purple,burlywood,indian,spring,floral,medium]), Greater..., ReadSchema: struct<i_item_sk:int,i_current_price:decimal(7,2),i_color:string,i_product_name:string>
.
2022-09-08 15:20:14,423 WARN scheduler.TaskSetManager: Lost task 39.0 in stage 148.0 (TID 19039) (10.1.29.179 executor 2): FetchFailed(null, shuffleId=42, mapIndex=-1, mapId=-1, reduceId=39, message=
org.apache.spark.shuffle.MetadataFetchFailedException: Missing an output location for shuffle 42
	at org.apache.spark.MapOutputTracker$.$anonfun$convertMapStatuses$2(MapOutputTracker.scala:1013)
	at org.apache.spark.MapOutputTracker$.$anonfun$convertMapStatuses$2$adapted(MapOutputTracker.scala:1009)
	at scala.collection.Iterator.foreach(Iterator.scala:941)
	at scala.collection.Iterator.foreach$(Iterator.scala:941)
	at scala.collection.AbstractIterator.foreach(Iterator.scala:1429)
	at org.apache.spark.MapOutputTracker$.convertMapStatuses(MapOutputTracker.scala:1009)
	at org.apache.spark.MapOutputTrackerWorker.getMapSizesByExecutorId(MapOutputTracker.scala:821)
	at org.apache.spark.shuffle.sort.SortShuffleManager.getReader(SortShuffleManager.scala:133)
	at org.apache.spark.shuffle.ShuffleManager.getReader(ShuffleManager.scala:63)
	at org.apache.spark.shuffle.ShuffleManager.getReader$(ShuffleManager.scala:57)
	at org.apache.spark.shuffle.sort.SortShuffleManager.getReader(SortShuffleManager.scala:73)
	at org.apache.spark.sql.execution.ShuffledRowRDD.compute(ShuffledRowRDD.scala:190)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:373)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:337)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:373)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:337)
	at org.apache.spark.rdd.ZippedPartitionsRDD2.compute(ZippedPartitionsRDD.scala:89)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:373)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:337)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:373)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:337)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:373)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:337)
	at org.apache.spark.shuffle.ShuffleWriteProcessor.write(ShuffleWriteProcessor.scala:59)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:52)
	at org.apache.spark.scheduler.Task.run(Task.scala:131)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$3(Executor.scala:497)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1439)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:500)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

)
2022-09-08 15:20:14,426 WARN scheduler.TaskSetManager: Lost task 38.0 in stage 148.0 (TID 19038) (10.1.29.179 executor 2): FetchFailed(null, shuffleId=42, mapIndex=-1, mapId=-1, reduceId=38, message=
org.apache.spark.shuffle.MetadataFetchFailedException: Missing an output location for shuffle 42
	at org.apache.spark.MapOutputTracker$.$anonfun$convertMapStatuses$2(MapOutputTracker.scala:1013)
	at org.apache.spark.MapOutputTracker$.$anonfun$convertMapStatuses$2$adapted(MapOutputTracker.scala:1009)
	at scala.collection.Iterator.foreach(Iterator.scala:941)
	at scala.collection.Iterator.foreach$(Iterator.scala:941)
	at scala.collection.AbstractIterator.foreach(Iterator.scala:1429)
	at org.apache.spark.MapOutputTracker$.convertMapStatuses(MapOutputTracker.scala:1009)
	at org.apache.spark.MapOutputTrackerWorker.getMapSizesByExecutorId(MapOutputTracker.scala:821)
	at org.apache.spark.shuffle.sort.SortShuffleManager.getReader(SortShuffleManager.scala:133)
	at org.apache.spark.shuffle.ShuffleManager.getReader(ShuffleManager.scala:63)
	at org.apache.spark.shuffle.ShuffleManager.getReader$(ShuffleManager.scala:57)
	at org.apache.spark.shuffle.sort.SortShuffleManager.getReader(SortShuffleManager.scala:73)
	at org.apache.spark.sql.execution.ShuffledRowRDD.compute(ShuffledRowRDD.scala:190)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:373)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:337)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:373)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:337)
	at org.apache.spark.rdd.ZippedPartitionsRDD2.compute(ZippedPartitionsRDD.scala:89)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:373)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:337)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:373)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:337)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:373)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:337)
	at org.apache.spark.shuffle.ShuffleWriteProcessor.write(ShuffleWriteProcessor.scala:59)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:52)
	at org.apache.spark.scheduler.Task.run(Task.scala:131)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$3(Executor.scala:497)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1439)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:500)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

)
2022-09-08 15:20:14,475 WARN scheduler.TaskSetManager: Lost task 40.0 in stage 148.0 (TID 19040) (10.1.29.179 executor 2): FetchFailed(null, shuffleId=42, mapIndex=-1, mapId=-1, reduceId=40, message=
org.apache.spark.shuffle.MetadataFetchFailedException: Missing an output location for shuffle 42
	at org.apache.spark.MapOutputTracker$.$anonfun$convertMapStatuses$2(MapOutputTracker.scala:1013)
	at org.apache.spark.MapOutputTracker$.$anonfun$convertMapStatuses$2$adapted(MapOutputTracker.scala:1009)
	at scala.collection.Iterator.foreach(Iterator.scala:941)
	at scala.collection.Iterator.foreach$(Iterator.scala:941)
	at scala.collection.AbstractIterator.foreach(Iterator.scala:1429)
	at org.apache.spark.MapOutputTracker$.convertMapStatuses(MapOutputTracker.scala:1009)
	at org.apache.spark.MapOutputTrackerWorker.getMapSizesByExecutorId(MapOutputTracker.scala:821)
	at org.apache.spark.shuffle.sort.SortShuffleManager.getReader(SortShuffleManager.scala:133)
	at org.apache.spark.shuffle.ShuffleManager.getReader(ShuffleManager.scala:63)
	at org.apache.spark.shuffle.ShuffleManager.getReader$(ShuffleManager.scala:57)
	at org.apache.spark.shuffle.sort.SortShuffleManager.getReader(SortShuffleManager.scala:73)
	at org.apache.spark.sql.execution.ShuffledRowRDD.compute(ShuffledRowRDD.scala:190)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:373)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:337)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:373)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:337)
	at org.apache.spark.rdd.ZippedPartitionsRDD2.compute(ZippedPartitionsRDD.scala:89)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:373)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:337)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:373)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:337)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:373)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:337)
	at org.apache.spark.shuffle.ShuffleWriteProcessor.write(ShuffleWriteProcessor.scala:59)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:52)
	at org.apache.spark.scheduler.Task.run(Task.scala:131)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$3(Executor.scala:497)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1439)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:500)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

)
2022-09-08 15:20:14,486 WARN scheduler.TaskSetManager: Lost task 41.0 in stage 148.0 (TID 19041) (10.1.29.179 executor 2): FetchFailed(null, shuffleId=42, mapIndex=-1, mapId=-1, reduceId=41, message=
org.apache.spark.shuffle.MetadataFetchFailedException: Missing an output location for shuffle 42
	at org.apache.spark.MapOutputTracker$.$anonfun$convertMapStatuses$2(MapOutputTracker.scala:1013)
	at org.apache.spark.MapOutputTracker$.$anonfun$convertMapStatuses$2$adapted(MapOutputTracker.scala:1009)
	at scala.collection.Iterator.foreach(Iterator.scala:941)
	at scala.collection.Iterator.foreach$(Iterator.scala:941)
	at scala.collection.AbstractIterator.foreach(Iterator.scala:1429)
	at org.apache.spark.MapOutputTracker$.convertMapStatuses(MapOutputTracker.scala:1009)
	at org.apache.spark.MapOutputTrackerWorker.getMapSizesByExecutorId(MapOutputTracker.scala:821)
	at org.apache.spark.shuffle.sort.SortShuffleManager.getReader(SortShuffleManager.scala:133)
	at org.apache.spark.shuffle.ShuffleManager.getReader(ShuffleManager.scala:63)
	at org.apache.spark.shuffle.ShuffleManager.getReader$(ShuffleManager.scala:57)
	at org.apache.spark.shuffle.sort.SortShuffleManager.getReader(SortShuffleManager.scala:73)
	at org.apache.spark.sql.execution.ShuffledRowRDD.compute(ShuffledRowRDD.scala:190)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:373)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:337)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:373)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:337)
	at org.apache.spark.rdd.ZippedPartitionsRDD2.compute(ZippedPartitionsRDD.scala:89)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:373)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:337)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:373)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:337)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:373)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:337)
	at org.apache.spark.shuffle.ShuffleWriteProcessor.write(ShuffleWriteProcessor.scala:59)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:52)
	at org.apache.spark.scheduler.Task.run(Task.scala:131)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$3(Executor.scala:497)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1439)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:500)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

)
Execution time: 234.87521209399998s
Running execution q70-v2.4 iteration: 3, StandardRun=true
2022-09-08 15:22:31,024 WARN adaptive.InsertAdaptiveSparkPlan: spark.sql.adaptive.enabled is enabled but is not supported for query: TakeOrderedAndProject(limit=100, orderBy=[lochierarchy#5702 DESC NULLS LAST,CASE WHEN (lochierarchy#5702 = 0) THEN s_state#5721 END ASC NULLS FIRST,rank_within_parent#5703 ASC NULLS FIRST], output=[total_sum#5701,s_state#5721,s_county#5722,lochierarchy#5702,rank_within_parent#5703])
+- Project [total_sum#5701, s_state#5721, s_county#5722, lochierarchy#5702, rank_within_parent#5703]
   +- Window [rank(_w3#5737) windowspecdefinition(_w1#5735, _w2#5736, _w3#5737 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rank_within_parent#5703], [_w1#5735, _w2#5736], [_w3#5737 DESC NULLS LAST]
      +- HashAggregate(keys=[s_state#5721, s_county#5722, spark_grouping_id#5720L], functions=[sum(UnscaledValue(ss_net_profit#151))], output=[total_sum#5701, s_state#5721, s_county#5722, lochierarchy#5702, _w1#5735, _w2#5736, _w3#5737])
         +- HashAggregate(keys=[s_state#5721, s_county#5722, spark_grouping_id#5720L], functions=[partial_sum(UnscaledValue(ss_net_profit#151))], output=[s_state#5721, s_county#5722, spark_grouping_id#5720L, sum#5762L])
            +- Expand [List(ss_net_profit#151, s_state#688, s_county#687, 0), List(ss_net_profit#151, s_state#688, null, 1), List(ss_net_profit#151, null, null, 3)], [ss_net_profit#151, s_state#5721, s_county#5722, spark_grouping_id#5720L]
               +- Project [ss_net_profit#151, s_state#688, s_county#687]
                  +- BroadcastHashJoin [ss_store_sk#136], [s_store_sk#664], Inner, BuildRight, false
                     :- Project [ss_store_sk#136, ss_net_profit#151]
                     :  +- BroadcastHashJoin [ss_sold_date_sk#152], [d_date_sk#492], Inner, BuildRight, false
                     :     :- Project [ss_store_sk#136, ss_net_profit#151, ss_sold_date_sk#152]
                     :     :  +- Filter isnotnull(ss_store_sk#136)
                     :     :     +- FileScan parquet [ss_store_sk#136,ss_net_profit#151,ss_sold_date_sk#152] Batched: true, DataFilters: [isnotnull(ss_store_sk#136)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/store_sales], PartitionFilters: [isnotnull(ss_sold_date_sk#152), dynamicpruning#5759 [ss_sold_date_sk#152]], PushedFilters: [IsNotNull(ss_store_sk)], ReadSchema: struct<ss_store_sk:int,ss_net_profit:decimal(7,2)>
                     :     :           +- Project [d_date_sk#492]
                     :     :              +- Filter (((isnotnull(d_month_seq#495) AND (d_month_seq#495 >= 1200)) AND (d_month_seq#495 <= 1211)) AND isnotnull(d_date_sk#492))
                     :     :                 +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :     +- Project [d_date_sk#492]
                     :        +- Filter (((isnotnull(d_month_seq#495) AND (d_month_seq#495 >= 1200)) AND (d_month_seq#495 <= 1211)) AND isnotnull(d_date_sk#492))
                     :           +- FileScan parquet [d_date_sk#492,d_month_seq#495] Batched: true, DataFilters: [isnotnull(d_month_seq#495), (d_month_seq#495 >= 1200), (d_month_seq#495 <= 1211), isnotnull(d_da..., Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_month_seq), GreaterThanOrEqual(d_month_seq,1200), LessThanOrEqual(d_month_seq,1211),..., ReadSchema: struct<d_date_sk:int,d_month_seq:int>
                     +- SortMergeJoin [s_state#688], [s_state#5698], LeftSemi
                        :- Project [s_store_sk#664, s_county#687, s_state#688]
                        :  +- Filter isnotnull(s_store_sk#664)
                        :     +- FileScan parquet [s_store_sk#664,s_county#687,s_state#688] Batched: true, DataFilters: [isnotnull(s_store_sk#664)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/store], PartitionFilters: [], PushedFilters: [IsNotNull(s_store_sk)], ReadSchema: struct<s_store_sk:int,s_county:string,s_state:string>
                        +- Project [s_state#5698]
                           +- Filter (isnotnull(ranking#5699) AND (ranking#5699 <= 5))
                              +- Window [rank(_w1#5709) windowspecdefinition(s_state#688, _w1#5709 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS ranking#5699], [s_state#688], [_w1#5709 DESC NULLS LAST]
                                 +- HashAggregate(keys=[s_state#688], functions=[sum(UnscaledValue(ss_net_profit#151))], output=[s_state#5698, s_state#688, _w1#5709])
                                    +- HashAggregate(keys=[s_state#688], functions=[partial_sum(UnscaledValue(ss_net_profit#151))], output=[s_state#688, sum#5764L])
                                       +- Project [ss_net_profit#151, s_state#688]
                                          +- BroadcastHashJoin [ss_sold_date_sk#152], [d_date_sk#492], Inner, BuildRight, false
                                             :- Project [ss_net_profit#151, ss_sold_date_sk#152, s_state#688]
                                             :  +- BroadcastHashJoin [ss_store_sk#136], [s_store_sk#664], Inner, BuildRight, false
                                             :     :- Project [ss_store_sk#136, ss_net_profit#151, ss_sold_date_sk#152]
                                             :     :  +- Filter isnotnull(ss_store_sk#136)
                                             :     :     +- FileScan parquet [ss_store_sk#136,ss_net_profit#151,ss_sold_date_sk#152] Batched: true, DataFilters: [isnotnull(ss_store_sk#136)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/store_sales], PartitionFilters: [isnotnull(ss_sold_date_sk#152), dynamicpruning#5752 [ss_sold_date_sk#152]], PushedFilters: [IsNotNull(ss_store_sk)], ReadSchema: struct<ss_store_sk:int,ss_net_profit:decimal(7,2)>
                                             :     :           +- Project [d_date_sk#492]
                                             :     :              +- Filter (((isnotnull(d_month_seq#495) AND (d_month_seq#495 >= 1200)) AND (d_month_seq#495 <= 1211)) AND isnotnull(d_date_sk#492))
                                             :     :                 +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                                             :     +- Project [s_store_sk#664, s_state#688]
                                             :        +- Filter isnotnull(s_store_sk#664)
                                             :           +- FileScan parquet [s_store_sk#664,s_state#688] Batched: true, DataFilters: [isnotnull(s_store_sk#664)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/store], PartitionFilters: [], PushedFilters: [IsNotNull(s_store_sk)], ReadSchema: struct<s_store_sk:int,s_state:string>
                                             +- Project [d_date_sk#492]
                                                +- Filter (((isnotnull(d_month_seq#495) AND (d_month_seq#495 >= 1200)) AND (d_month_seq#495 <= 1211)) AND isnotnull(d_date_sk#492))
                                                   +- FileScan parquet [d_date_sk#492,d_month_seq#495] Batched: true, DataFilters: [isnotnull(d_month_seq#495), (d_month_seq#495 >= 1200), (d_month_seq#495 <= 1211), isnotnull(d_da..., Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_month_seq), GreaterThanOrEqual(d_month_seq,1200), LessThanOrEqual(d_month_seq,1211),..., ReadSchema: struct<d_date_sk:int,d_month_seq:int>
.
2022-09-08 15:22:31,167 INFO perf.Query: 
== Query: q70-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [lochierarchy#5788 DESC NULLS LAST, CASE WHEN (cast(lochierarchy#5788 as int) = 0) THEN s_state#5807 END ASC NULLS FIRST, rank_within_parent#5789 ASC NULLS FIRST], true
      +- Project [total_sum#5787, s_state#5807, s_county#5808, lochierarchy#5788, rank_within_parent#5789]
         +- Project [total_sum#5787, s_state#5807, s_county#5808, lochierarchy#5788, _w0#5817, _w1#5821, _w2#5822, _w3#5823, rank_within_parent#5789, rank_within_parent#5789]
            +- Window [rank(_w3#5823) windowspecdefinition(_w1#5821, _w2#5822, _w3#5823 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rank_within_parent#5789], [_w1#5821, _w2#5822], [_w3#5823 DESC NULLS LAST]
               +- Aggregate [s_state#5807, s_county#5808, spark_grouping_id#5806L], [sum(ss_net_profit#151) AS total_sum#5787, s_state#5807, s_county#5808, (cast((shiftright(spark_grouping_id#5806L, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#5806L, 0) & 1) as tinyint)) AS lochierarchy#5788, sum(ss_net_profit#151) AS _w0#5817, (cast((shiftright(spark_grouping_id#5806L, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#5806L, 0) & 1) as tinyint)) AS _w1#5821, CASE WHEN (cast(cast((shiftright(spark_grouping_id#5806L, 0) & 1) as tinyint) as int) = 0) THEN s_state#5807 END AS _w2#5822, sum(ss_net_profit#151) AS _w3#5823]
                  +- Expand [List(ss_sold_time_sk#130, ss_item_sk#131, ss_customer_sk#132, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_store_sk#136, ss_promo_sk#137, ss_ticket_number#138L, ss_quantity#139, ss_wholesale_cost#140, ss_list_price#141, ss_sales_price#142, ss_ext_discount_amt#143, ss_ext_sales_price#144, ss_ext_wholesale_cost#145, ss_ext_list_price#146, ss_ext_tax#147, ss_coupon_amt#148, ss_net_paid#149, ss_net_paid_inc_tax#150, ss_net_profit#151, ss_sold_date_sk#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, s_state#5804, s_county#5805, 0), List(ss_sold_time_sk#130, ss_item_sk#131, ss_customer_sk#132, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_store_sk#136, ss_promo_sk#137, ss_ticket_number#138L, ss_quantity#139, ss_wholesale_cost#140, ss_list_price#141, ss_sales_price#142, ss_ext_discount_amt#143, ss_ext_sales_price#144, ss_ext_wholesale_cost#145, ss_ext_list_price#146, ss_ext_tax#147, ss_coupon_amt#148, ss_net_paid#149, ss_net_paid_inc_tax#150, ss_net_profit#151, ss_sold_date_sk#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, s_state#5804, null, 1), List(ss_sold_time_sk#130, ss_item_sk#131, ss_customer_sk#132, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_store_sk#136, ss_promo_sk#137, ss_ticket_number#138L, ss_quantity#139, ss_wholesale_cost#140, ss_list_price#141, ss_sales_price#142, ss_ext_discount_amt#143, ss_ext_sales_price#144, ss_ext_wholesale_cost#145, ss_ext_list_price#146, ss_ext_tax#147, ss_coupon_amt#148, ss_net_paid#149, ss_net_paid_inc_tax#150, ss_net_profit#151, ss_sold_date_sk#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, null, null, 3)], [ss_sold_time_sk#130, ss_item_sk#131, ss_customer_sk#132, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_store_sk#136, ss_promo_sk#137, ss_ticket_number#138L, ss_quantity#139, ss_wholesale_cost#140, ss_list_price#141, ss_sales_price#142, ss_ext_discount_amt#143, ss_ext_sales_price#144, ss_ext_wholesale_cost#145, ss_ext_list_price#146, ss_ext_tax#147, ss_coupon_amt#148, ss_net_paid#149, ss_net_paid_inc_tax#150, ss_net_profit#151, ss_sold_date_sk#152, d_date_sk#492, ... 59 more fields]
                     +- Project [ss_sold_time_sk#130, ss_item_sk#131, ss_customer_sk#132, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_store_sk#136, ss_promo_sk#137, ss_ticket_number#138L, ss_quantity#139, ss_wholesale_cost#140, ss_list_price#141, ss_sales_price#142, ss_ext_discount_amt#143, ss_ext_sales_price#144, ss_ext_wholesale_cost#145, ss_ext_list_price#146, ss_ext_tax#147, ss_coupon_amt#148, ss_net_paid#149, ss_net_paid_inc_tax#150, ss_net_profit#151, ss_sold_date_sk#152, d_date_sk#492, ... 58 more fields]
                        +- Filter ((((d_month_seq#495 >= 1200) AND (d_month_seq#495 <= (1200 + 11))) AND (d_date_sk#492 = ss_sold_date_sk#152)) AND ((s_store_sk#664 = ss_store_sk#136) AND s_state#688 IN (list#5786 [])))
                           :  +- Project [s_state#5784]
                           :     +- Filter (ranking#5785 <= 5)
                           :        +- SubqueryAlias tmp1
                           :           +- Project [s_state#5784, ranking#5785]
                           :              +- Project [s_state#5784, s_state#688, _w1#5795, ranking#5785, ranking#5785]
                           :                 +- Window [rank(_w1#5795) windowspecdefinition(s_state#688, _w1#5795 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS ranking#5785], [s_state#688], [_w1#5795 DESC NULLS LAST]
                           :                    +- Aggregate [s_state#688], [s_state#688 AS s_state#5784, s_state#688, sum(ss_net_profit#151) AS _w1#5795]
                           :                       +- Filter ((((d_month_seq#495 >= 1200) AND (d_month_seq#495 <= (1200 + 11))) AND (d_date_sk#492 = ss_sold_date_sk#152)) AND (s_store_sk#664 = ss_store_sk#136))
                           :                          +- Join Inner
                           :                             :- Join Inner
                           :                             :  :- SubqueryAlias store_sales
                           :                             :  :  +- Relation[ss_sold_time_sk#130,ss_item_sk#131,ss_customer_sk#132,ss_cdemo_sk#133,ss_hdemo_sk#134,ss_addr_sk#135,ss_store_sk#136,ss_promo_sk#137,ss_ticket_number#138L,ss_quantity#139,ss_wholesale_cost#140,ss_list_price#141,ss_sales_price#142,ss_ext_discount_amt#143,ss_ext_sales_price#144,ss_ext_wholesale_cost#145,ss_ext_list_price#146,ss_ext_tax#147,ss_coupon_amt#148,ss_net_paid#149,ss_net_paid_inc_tax#150,ss_net_profit#151,ss_sold_date_sk#152] parquet
                           :                             :  +- SubqueryAlias store
                           :                             :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                           :                             +- SubqueryAlias date_dim
                           :                                +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                           +- Join Inner
                              :- Join Inner
                              :  :- SubqueryAlias store_sales
                              :  :  +- Relation[ss_sold_time_sk#130,ss_item_sk#131,ss_customer_sk#132,ss_cdemo_sk#133,ss_hdemo_sk#134,ss_addr_sk#135,ss_store_sk#136,ss_promo_sk#137,ss_ticket_number#138L,ss_quantity#139,ss_wholesale_cost#140,ss_list_price#141,ss_sales_price#142,ss_ext_discount_amt#143,ss_ext_sales_price#144,ss_ext_wholesale_cost#145,ss_ext_list_price#146,ss_ext_tax#147,ss_coupon_amt#148,ss_net_paid#149,ss_net_paid_inc_tax#150,ss_net_profit#151,ss_sold_date_sk#152] parquet
                              :  +- SubqueryAlias d1
                              :     +- SubqueryAlias date_dim
                              :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                              +- SubqueryAlias store
                                 +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet

     : benchmark
2022-09-08 15:22:31,267 INFO perf.Query: 
== Query: q70-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [lochierarchy#5842 DESC NULLS LAST, CASE WHEN (cast(lochierarchy#5842 as int) = 0) THEN s_state#5861 END ASC NULLS FIRST, rank_within_parent#5843 ASC NULLS FIRST], true
      +- Project [total_sum#5841, s_state#5861, s_county#5862, lochierarchy#5842, rank_within_parent#5843]
         +- Project [total_sum#5841, s_state#5861, s_county#5862, lochierarchy#5842, _w0#5871, _w1#5875, _w2#5876, _w3#5877, rank_within_parent#5843, rank_within_parent#5843]
            +- Window [rank(_w3#5877) windowspecdefinition(_w1#5875, _w2#5876, _w3#5877 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rank_within_parent#5843], [_w1#5875, _w2#5876], [_w3#5877 DESC NULLS LAST]
               +- Aggregate [s_state#5861, s_county#5862, spark_grouping_id#5860L], [sum(ss_net_profit#151) AS total_sum#5841, s_state#5861, s_county#5862, (cast((shiftright(spark_grouping_id#5860L, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#5860L, 0) & 1) as tinyint)) AS lochierarchy#5842, sum(ss_net_profit#151) AS _w0#5871, (cast((shiftright(spark_grouping_id#5860L, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#5860L, 0) & 1) as tinyint)) AS _w1#5875, CASE WHEN (cast(cast((shiftright(spark_grouping_id#5860L, 0) & 1) as tinyint) as int) = 0) THEN s_state#5861 END AS _w2#5876, sum(ss_net_profit#151) AS _w3#5877]
                  +- Expand [List(ss_sold_time_sk#130, ss_item_sk#131, ss_customer_sk#132, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_store_sk#136, ss_promo_sk#137, ss_ticket_number#138L, ss_quantity#139, ss_wholesale_cost#140, ss_list_price#141, ss_sales_price#142, ss_ext_discount_amt#143, ss_ext_sales_price#144, ss_ext_wholesale_cost#145, ss_ext_list_price#146, ss_ext_tax#147, ss_coupon_amt#148, ss_net_paid#149, ss_net_paid_inc_tax#150, ss_net_profit#151, ss_sold_date_sk#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, s_state#5858, s_county#5859, 0), List(ss_sold_time_sk#130, ss_item_sk#131, ss_customer_sk#132, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_store_sk#136, ss_promo_sk#137, ss_ticket_number#138L, ss_quantity#139, ss_wholesale_cost#140, ss_list_price#141, ss_sales_price#142, ss_ext_discount_amt#143, ss_ext_sales_price#144, ss_ext_wholesale_cost#145, ss_ext_list_price#146, ss_ext_tax#147, ss_coupon_amt#148, ss_net_paid#149, ss_net_paid_inc_tax#150, ss_net_profit#151, ss_sold_date_sk#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, s_state#5858, null, 1), List(ss_sold_time_sk#130, ss_item_sk#131, ss_customer_sk#132, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_store_sk#136, ss_promo_sk#137, ss_ticket_number#138L, ss_quantity#139, ss_wholesale_cost#140, ss_list_price#141, ss_sales_price#142, ss_ext_discount_amt#143, ss_ext_sales_price#144, ss_ext_wholesale_cost#145, ss_ext_list_price#146, ss_ext_tax#147, ss_coupon_amt#148, ss_net_paid#149, ss_net_paid_inc_tax#150, ss_net_profit#151, ss_sold_date_sk#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, null, null, 3)], [ss_sold_time_sk#130, ss_item_sk#131, ss_customer_sk#132, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_store_sk#136, ss_promo_sk#137, ss_ticket_number#138L, ss_quantity#139, ss_wholesale_cost#140, ss_list_price#141, ss_sales_price#142, ss_ext_discount_amt#143, ss_ext_sales_price#144, ss_ext_wholesale_cost#145, ss_ext_list_price#146, ss_ext_tax#147, ss_coupon_amt#148, ss_net_paid#149, ss_net_paid_inc_tax#150, ss_net_profit#151, ss_sold_date_sk#152, d_date_sk#492, ... 59 more fields]
                     +- Project [ss_sold_time_sk#130, ss_item_sk#131, ss_customer_sk#132, ss_cdemo_sk#133, ss_hdemo_sk#134, ss_addr_sk#135, ss_store_sk#136, ss_promo_sk#137, ss_ticket_number#138L, ss_quantity#139, ss_wholesale_cost#140, ss_list_price#141, ss_sales_price#142, ss_ext_discount_amt#143, ss_ext_sales_price#144, ss_ext_wholesale_cost#145, ss_ext_list_price#146, ss_ext_tax#147, ss_coupon_amt#148, ss_net_paid#149, ss_net_paid_inc_tax#150, ss_net_profit#151, ss_sold_date_sk#152, d_date_sk#492, ... 58 more fields]
                        +- Filter ((((d_month_seq#495 >= 1200) AND (d_month_seq#495 <= (1200 + 11))) AND (d_date_sk#492 = ss_sold_date_sk#152)) AND ((s_store_sk#664 = ss_store_sk#136) AND s_state#688 IN (list#5840 [])))
                           :  +- Project [s_state#5838]
                           :     +- Filter (ranking#5839 <= 5)
                           :        +- SubqueryAlias tmp1
                           :           +- Project [s_state#5838, ranking#5839]
                           :              +- Project [s_state#5838, s_state#688, _w1#5849, ranking#5839, ranking#5839]
                           :                 +- Window [rank(_w1#5849) windowspecdefinition(s_state#688, _w1#5849 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS ranking#5839], [s_state#688], [_w1#5849 DESC NULLS LAST]
                           :                    +- Aggregate [s_state#688], [s_state#688 AS s_state#5838, s_state#688, sum(ss_net_profit#151) AS _w1#5849]
                           :                       +- Filter ((((d_month_seq#495 >= 1200) AND (d_month_seq#495 <= (1200 + 11))) AND (d_date_sk#492 = ss_sold_date_sk#152)) AND (s_store_sk#664 = ss_store_sk#136))
                           :                          +- Join Inner
                           :                             :- Join Inner
                           :                             :  :- SubqueryAlias store_sales
                           :                             :  :  +- Relation[ss_sold_time_sk#130,ss_item_sk#131,ss_customer_sk#132,ss_cdemo_sk#133,ss_hdemo_sk#134,ss_addr_sk#135,ss_store_sk#136,ss_promo_sk#137,ss_ticket_number#138L,ss_quantity#139,ss_wholesale_cost#140,ss_list_price#141,ss_sales_price#142,ss_ext_discount_amt#143,ss_ext_sales_price#144,ss_ext_wholesale_cost#145,ss_ext_list_price#146,ss_ext_tax#147,ss_coupon_amt#148,ss_net_paid#149,ss_net_paid_inc_tax#150,ss_net_profit#151,ss_sold_date_sk#152] parquet
                           :                             :  +- SubqueryAlias store
                           :                             :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                           :                             +- SubqueryAlias date_dim
                           :                                +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                           +- Join Inner
                              :- Join Inner
                              :  :- SubqueryAlias store_sales
                              :  :  +- Relation[ss_sold_time_sk#130,ss_item_sk#131,ss_customer_sk#132,ss_cdemo_sk#133,ss_hdemo_sk#134,ss_addr_sk#135,ss_store_sk#136,ss_promo_sk#137,ss_ticket_number#138L,ss_quantity#139,ss_wholesale_cost#140,ss_list_price#141,ss_sales_price#142,ss_ext_discount_amt#143,ss_ext_sales_price#144,ss_ext_wholesale_cost#145,ss_ext_list_price#146,ss_ext_tax#147,ss_coupon_amt#148,ss_net_paid#149,ss_net_paid_inc_tax#150,ss_net_profit#151,ss_sold_date_sk#152] parquet
                              :  +- SubqueryAlias d1
                              :     +- SubqueryAlias date_dim
                              :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                              +- SubqueryAlias store
                                 +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet

      running Thread[benchmark runner,5,main]
2022-09-08 15:22:31,455 WARN adaptive.InsertAdaptiveSparkPlan: spark.sql.adaptive.enabled is enabled but is not supported for query: TakeOrderedAndProject(limit=100, orderBy=[lochierarchy#5896 DESC NULLS LAST,CASE WHEN (lochierarchy#5896 = 0) THEN s_state#5915 END ASC NULLS FIRST,rank_within_parent#5897 ASC NULLS FIRST], output=[total_sum#5895,s_state#5915,s_county#5916,lochierarchy#5896,rank_within_parent#5897])
+- Project [total_sum#5895, s_state#5915, s_county#5916, lochierarchy#5896, rank_within_parent#5897]
   +- Window [rank(_w3#5931) windowspecdefinition(_w1#5929, _w2#5930, _w3#5931 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rank_within_parent#5897], [_w1#5929, _w2#5930], [_w3#5931 DESC NULLS LAST]
      +- HashAggregate(keys=[s_state#5915, s_county#5916, spark_grouping_id#5914L], functions=[sum(UnscaledValue(ss_net_profit#151))], output=[total_sum#5895, s_state#5915, s_county#5916, lochierarchy#5896, _w1#5929, _w2#5930, _w3#5931])
         +- HashAggregate(keys=[s_state#5915, s_county#5916, spark_grouping_id#5914L], functions=[partial_sum(UnscaledValue(ss_net_profit#151))], output=[s_state#5915, s_county#5916, spark_grouping_id#5914L, sum#5956L])
            +- Expand [List(ss_net_profit#151, s_state#688, s_county#687, 0), List(ss_net_profit#151, s_state#688, null, 1), List(ss_net_profit#151, null, null, 3)], [ss_net_profit#151, s_state#5915, s_county#5916, spark_grouping_id#5914L]
               +- Project [ss_net_profit#151, s_state#688, s_county#687]
                  +- BroadcastHashJoin [ss_store_sk#136], [s_store_sk#664], Inner, BuildRight, false
                     :- Project [ss_store_sk#136, ss_net_profit#151]
                     :  +- BroadcastHashJoin [ss_sold_date_sk#152], [d_date_sk#492], Inner, BuildRight, false
                     :     :- Project [ss_store_sk#136, ss_net_profit#151, ss_sold_date_sk#152]
                     :     :  +- Filter isnotnull(ss_store_sk#136)
                     :     :     +- FileScan parquet [ss_store_sk#136,ss_net_profit#151,ss_sold_date_sk#152] Batched: true, DataFilters: [isnotnull(ss_store_sk#136)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/store_sales], PartitionFilters: [isnotnull(ss_sold_date_sk#152), dynamicpruning#5953 [ss_sold_date_sk#152]], PushedFilters: [IsNotNull(ss_store_sk)], ReadSchema: struct<ss_store_sk:int,ss_net_profit:decimal(7,2)>
                     :     :           +- Project [d_date_sk#492]
                     :     :              +- Filter (((isnotnull(d_month_seq#495) AND (d_month_seq#495 >= 1200)) AND (d_month_seq#495 <= 1211)) AND isnotnull(d_date_sk#492))
                     :     :                 +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :     +- Project [d_date_sk#492]
                     :        +- Filter (((isnotnull(d_month_seq#495) AND (d_month_seq#495 >= 1200)) AND (d_month_seq#495 <= 1211)) AND isnotnull(d_date_sk#492))
                     :           +- FileScan parquet [d_date_sk#492,d_month_seq#495] Batched: true, DataFilters: [isnotnull(d_month_seq#495), (d_month_seq#495 >= 1200), (d_month_seq#495 <= 1211), isnotnull(d_da..., Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_month_seq), GreaterThanOrEqual(d_month_seq,1200), LessThanOrEqual(d_month_seq,1211),..., ReadSchema: struct<d_date_sk:int,d_month_seq:int>
                     +- SortMergeJoin [s_state#688], [s_state#5892], LeftSemi
                        :- Project [s_store_sk#664, s_county#687, s_state#688]
                        :  +- Filter isnotnull(s_store_sk#664)
                        :     +- FileScan parquet [s_store_sk#664,s_county#687,s_state#688] Batched: true, DataFilters: [isnotnull(s_store_sk#664)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/store], PartitionFilters: [], PushedFilters: [IsNotNull(s_store_sk)], ReadSchema: struct<s_store_sk:int,s_county:string,s_state:string>
                        +- Project [s_state#5892]
                           +- Filter (isnotnull(ranking#5893) AND (ranking#5893 <= 5))
                              +- Window [rank(_w1#5903) windowspecdefinition(s_state#688, _w1#5903 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS ranking#5893], [s_state#688], [_w1#5903 DESC NULLS LAST]
                                 +- HashAggregate(keys=[s_state#688], functions=[sum(UnscaledValue(ss_net_profit#151))], output=[s_state#5892, s_state#688, _w1#5903])
                                    +- HashAggregate(keys=[s_state#688], functions=[partial_sum(UnscaledValue(ss_net_profit#151))], output=[s_state#688, sum#5958L])
                                       +- Project [ss_net_profit#151, s_state#688]
                                          +- BroadcastHashJoin [ss_sold_date_sk#152], [d_date_sk#492], Inner, BuildRight, false
                                             :- Project [ss_net_profit#151, ss_sold_date_sk#152, s_state#688]
                                             :  +- BroadcastHashJoin [ss_store_sk#136], [s_store_sk#664], Inner, BuildRight, false
                                             :     :- Project [ss_store_sk#136, ss_net_profit#151, ss_sold_date_sk#152]
                                             :     :  +- Filter isnotnull(ss_store_sk#136)
                                             :     :     +- FileScan parquet [ss_store_sk#136,ss_net_profit#151,ss_sold_date_sk#152] Batched: true, DataFilters: [isnotnull(ss_store_sk#136)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/store_sales], PartitionFilters: [isnotnull(ss_sold_date_sk#152), dynamicpruning#5946 [ss_sold_date_sk#152]], PushedFilters: [IsNotNull(ss_store_sk)], ReadSchema: struct<ss_store_sk:int,ss_net_profit:decimal(7,2)>
                                             :     :           +- Project [d_date_sk#492]
                                             :     :              +- Filter (((isnotnull(d_month_seq#495) AND (d_month_seq#495 >= 1200)) AND (d_month_seq#495 <= 1211)) AND isnotnull(d_date_sk#492))
                                             :     :                 +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                                             :     +- Project [s_store_sk#664, s_state#688]
                                             :        +- Filter isnotnull(s_store_sk#664)
                                             :           +- FileScan parquet [s_store_sk#664,s_state#688] Batched: true, DataFilters: [isnotnull(s_store_sk#664)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/store], PartitionFilters: [], PushedFilters: [IsNotNull(s_store_sk)], ReadSchema: struct<s_store_sk:int,s_state:string>
                                             +- Project [d_date_sk#492]
                                                +- Filter (((isnotnull(d_month_seq#495) AND (d_month_seq#495 >= 1200)) AND (d_month_seq#495 <= 1211)) AND isnotnull(d_date_sk#492))
                                                   +- FileScan parquet [d_date_sk#492,d_month_seq#495] Batched: true, DataFilters: [isnotnull(d_month_seq#495), (d_month_seq#495 >= 1200), (d_month_seq#495 <= 1211), isnotnull(d_da..., Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_month_seq), GreaterThanOrEqual(d_month_seq,1200), LessThanOrEqual(d_month_seq,1211),..., ReadSchema: struct<d_date_sk:int,d_month_seq:int>
.
Execution time: 16.82603787s
Running execution q82-v2.4 iteration: 3, StandardRun=true
2022-09-08 15:22:48,741 WARN adaptive.InsertAdaptiveSparkPlan: spark.sql.adaptive.enabled is enabled but is not supported for query: TakeOrderedAndProject(limit=100, orderBy=[i_item_id#565 ASC NULLS FIRST], output=[i_item_id#565,i_item_desc#568,i_current_price#569])
+- HashAggregate(keys=[i_item_id#565, i_item_desc#568, i_current_price#569], functions=[], output=[i_item_id#565, i_item_desc#568, i_current_price#569])
   +- HashAggregate(keys=[i_item_id#565, i_item_desc#568, i_current_price#569], functions=[], output=[i_item_id#565, i_item_desc#568, i_current_price#569])
      +- Project [i_item_id#565, i_item_desc#568, i_current_price#569]
         +- SortMergeJoin [i_item_sk#564], [ss_item_sk#131], Inner
            :- Project [i_item_sk#564, i_item_id#565, i_item_desc#568, i_current_price#569]
            :  +- BroadcastHashJoin [inv_date_sk#125], [d_date_sk#492], Inner, BuildRight, false
            :     :- Project [i_item_sk#564, i_item_id#565, i_item_desc#568, i_current_price#569, inv_date_sk#125]
            :     :  +- BroadcastHashJoin [i_item_sk#564], [inv_item_sk#122], Inner, BuildLeft, false
            :     :     :- Project [i_item_sk#564, i_item_id#565, i_item_desc#568, i_current_price#569]
            :     :     :  +- Filter ((((isnotnull(i_current_price#569) AND (i_current_price#569 >= 62.00)) AND (i_current_price#569 <= 92.00)) AND i_manufact_id#577 IN (129,270,821,423)) AND isnotnull(i_item_sk#564))
            :     :     :     +- FileScan parquet [i_item_sk#564,i_item_id#565,i_item_desc#568,i_current_price#569,i_manufact_id#577] Batched: true, DataFilters: [isnotnull(i_current_price#569), (i_current_price#569 >= 62.00), (i_current_price#569 <= 92.00), ..., Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/item], PartitionFilters: [], PushedFilters: [IsNotNull(i_current_price), GreaterThanOrEqual(i_current_price,62.00), LessThanOrEqual(i_current..., ReadSchema: struct<i_item_sk:int,i_item_id:string,i_item_desc:string,i_current_price:decimal(7,2),i_manufact_...
            :     :     +- Project [inv_item_sk#122, inv_date_sk#125]
            :     :        +- Filter (((isnotnull(inv_quantity_on_hand#124) AND (inv_quantity_on_hand#124 >= 100)) AND (inv_quantity_on_hand#124 <= 500)) AND isnotnull(inv_item_sk#122))
            :     :           +- FileScan parquet [inv_item_sk#122,inv_quantity_on_hand#124,inv_date_sk#125] Batched: true, DataFilters: [isnotnull(inv_quantity_on_hand#124), (inv_quantity_on_hand#124 >= 100), (inv_quantity_on_hand#12..., Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/inventory], PartitionFilters: [isnotnull(inv_date_sk#125), dynamicpruning#5989 [inv_date_sk#125]], PushedFilters: [IsNotNull(inv_quantity_on_hand), GreaterThanOrEqual(inv_quantity_on_hand,100), LessThanOrEqual(i..., ReadSchema: struct<inv_item_sk:int,inv_quantity_on_hand:int>
            :     :                 +- Project [d_date_sk#492]
            :     :                    +- Filter (((isnotnull(d_date#494) AND (d_date#494 >= 11102)) AND (d_date#494 <= 11162)) AND isnotnull(d_date_sk#492))
            :     :                       +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            :     +- Project [d_date_sk#492]
            :        +- Filter (((isnotnull(d_date#494) AND (d_date#494 >= 11102)) AND (d_date#494 <= 11162)) AND isnotnull(d_date_sk#492))
            :           +- FileScan parquet [d_date_sk#492,d_date#494] Batched: true, DataFilters: [isnotnull(d_date#494), (d_date#494 >= 11102), (d_date#494 <= 11162), isnotnull(d_date_sk#492)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_date), GreaterThanOrEqual(d_date,2000-05-25), LessThanOrEqual(d_date,2000-07-24), Is..., ReadSchema: struct<d_date_sk:int,d_date:date>
            +- Project [ss_item_sk#131]
               +- Filter isnotnull(ss_item_sk#131)
                  +- FileScan parquet [ss_item_sk#131,ss_sold_date_sk#152] Batched: true, DataFilters: [isnotnull(ss_item_sk#131)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/store_sales], PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk)], ReadSchema: struct<ss_item_sk:int>
.
2022-09-08 15:22:48,790 INFO perf.Query: 
== Query: q82-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [i_item_id#565 ASC NULLS FIRST], true
      +- Aggregate [i_item_id#565, i_item_desc#568, i_current_price#569], [i_item_id#565, i_item_desc#568, i_current_price#569]
         +- Filter (((((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(62 as decimal(2,0)) as decimal(7,2))) AND (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((62 + 30) as decimal(10,0)) as decimal(12,2)))) AND (inv_item_sk#122 = i_item_sk#564)) AND ((d_date_sk#492 = inv_date_sk#125) AND ((d_date#494 >= cast(2000-05-25 as date)) AND (d_date#494 <= cast(2000-05-25 as date) + 60 days)))) AND ((i_manufact_id#577 IN (129,270,821,423) AND ((inv_quantity_on_hand#124 >= 100) AND (inv_quantity_on_hand#124 <= 500))) AND (ss_item_sk#131 = i_item_sk#564)))
            +- Join Inner
               :- Join Inner
               :  :- Join Inner
               :  :  :- SubqueryAlias item
               :  :  :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  :  +- SubqueryAlias inventory
               :  :     +- Relation[inv_item_sk#122,inv_warehouse_sk#123,inv_quantity_on_hand#124,inv_date_sk#125] parquet
               :  +- SubqueryAlias date_dim
               :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               +- SubqueryAlias store_sales
                  +- Relation[ss_sold_time_sk#130,ss_item_sk#131,ss_customer_sk#132,ss_cdemo_sk#133,ss_hdemo_sk#134,ss_addr_sk#135,ss_store_sk#136,ss_promo_sk#137,ss_ticket_number#138L,ss_quantity#139,ss_wholesale_cost#140,ss_list_price#141,ss_sales_price#142,ss_ext_discount_amt#143,ss_ext_sales_price#144,ss_ext_wholesale_cost#145,ss_ext_list_price#146,ss_ext_tax#147,ss_coupon_amt#148,ss_net_paid#149,ss_net_paid_inc_tax#150,ss_net_profit#151,ss_sold_date_sk#152] parquet

     : benchmark
2022-09-08 15:22:48,826 INFO perf.Query: 
== Query: q82-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [i_item_id#565 ASC NULLS FIRST], true
      +- Aggregate [i_item_id#565, i_item_desc#568, i_current_price#569], [i_item_id#565, i_item_desc#568, i_current_price#569]
         +- Filter (((((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(62 as decimal(2,0)) as decimal(7,2))) AND (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((62 + 30) as decimal(10,0)) as decimal(12,2)))) AND (inv_item_sk#122 = i_item_sk#564)) AND ((d_date_sk#492 = inv_date_sk#125) AND ((d_date#494 >= cast(2000-05-25 as date)) AND (d_date#494 <= cast(2000-05-25 as date) + 60 days)))) AND ((i_manufact_id#577 IN (129,270,821,423) AND ((inv_quantity_on_hand#124 >= 100) AND (inv_quantity_on_hand#124 <= 500))) AND (ss_item_sk#131 = i_item_sk#564)))
            +- Join Inner
               :- Join Inner
               :  :- Join Inner
               :  :  :- SubqueryAlias item
               :  :  :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  :  +- SubqueryAlias inventory
               :  :     +- Relation[inv_item_sk#122,inv_warehouse_sk#123,inv_quantity_on_hand#124,inv_date_sk#125] parquet
               :  +- SubqueryAlias date_dim
               :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               +- SubqueryAlias store_sales
                  +- Relation[ss_sold_time_sk#130,ss_item_sk#131,ss_customer_sk#132,ss_cdemo_sk#133,ss_hdemo_sk#134,ss_addr_sk#135,ss_store_sk#136,ss_promo_sk#137,ss_ticket_number#138L,ss_quantity#139,ss_wholesale_cost#140,ss_list_price#141,ss_sales_price#142,ss_ext_discount_amt#143,ss_ext_sales_price#144,ss_ext_wholesale_cost#145,ss_ext_list_price#146,ss_ext_tax#147,ss_coupon_amt#148,ss_net_paid#149,ss_net_paid_inc_tax#150,ss_net_profit#151,ss_sold_date_sk#152] parquet

      running Thread[benchmark runner,5,main]
2022-09-08 15:22:48,892 WARN adaptive.InsertAdaptiveSparkPlan: spark.sql.adaptive.enabled is enabled but is not supported for query: TakeOrderedAndProject(limit=100, orderBy=[i_item_id#565 ASC NULLS FIRST], output=[i_item_id#565,i_item_desc#568,i_current_price#569])
+- HashAggregate(keys=[i_item_id#565, i_item_desc#568, i_current_price#569], functions=[], output=[i_item_id#565, i_item_desc#568, i_current_price#569])
   +- HashAggregate(keys=[i_item_id#565, i_item_desc#568, i_current_price#569], functions=[], output=[i_item_id#565, i_item_desc#568, i_current_price#569])
      +- Project [i_item_id#565, i_item_desc#568, i_current_price#569]
         +- SortMergeJoin [i_item_sk#564], [ss_item_sk#131], Inner
            :- Project [i_item_sk#564, i_item_id#565, i_item_desc#568, i_current_price#569]
            :  +- BroadcastHashJoin [inv_date_sk#125], [d_date_sk#492], Inner, BuildRight, false
            :     :- Project [i_item_sk#564, i_item_id#565, i_item_desc#568, i_current_price#569, inv_date_sk#125]
            :     :  +- BroadcastHashJoin [i_item_sk#564], [inv_item_sk#122], Inner, BuildLeft, false
            :     :     :- Project [i_item_sk#564, i_item_id#565, i_item_desc#568, i_current_price#569]
            :     :     :  +- Filter ((((isnotnull(i_current_price#569) AND (i_current_price#569 >= 62.00)) AND (i_current_price#569 <= 92.00)) AND i_manufact_id#577 IN (129,270,821,423)) AND isnotnull(i_item_sk#564))
            :     :     :     +- FileScan parquet [i_item_sk#564,i_item_id#565,i_item_desc#568,i_current_price#569,i_manufact_id#577] Batched: true, DataFilters: [isnotnull(i_current_price#569), (i_current_price#569 >= 62.00), (i_current_price#569 <= 92.00), ..., Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/item], PartitionFilters: [], PushedFilters: [IsNotNull(i_current_price), GreaterThanOrEqual(i_current_price,62.00), LessThanOrEqual(i_current..., ReadSchema: struct<i_item_sk:int,i_item_id:string,i_item_desc:string,i_current_price:decimal(7,2),i_manufact_...
            :     :     +- Project [inv_item_sk#122, inv_date_sk#125]
            :     :        +- Filter (((isnotnull(inv_quantity_on_hand#124) AND (inv_quantity_on_hand#124 >= 100)) AND (inv_quantity_on_hand#124 <= 500)) AND isnotnull(inv_item_sk#122))
            :     :           +- FileScan parquet [inv_item_sk#122,inv_quantity_on_hand#124,inv_date_sk#125] Batched: true, DataFilters: [isnotnull(inv_quantity_on_hand#124), (inv_quantity_on_hand#124 >= 100), (inv_quantity_on_hand#12..., Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/inventory], PartitionFilters: [isnotnull(inv_date_sk#125), dynamicpruning#6000 [inv_date_sk#125]], PushedFilters: [IsNotNull(inv_quantity_on_hand), GreaterThanOrEqual(inv_quantity_on_hand,100), LessThanOrEqual(i..., ReadSchema: struct<inv_item_sk:int,inv_quantity_on_hand:int>
            :     :                 +- Project [d_date_sk#492]
            :     :                    +- Filter (((isnotnull(d_date#494) AND (d_date#494 >= 11102)) AND (d_date#494 <= 11162)) AND isnotnull(d_date_sk#492))
            :     :                       +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            :     +- Project [d_date_sk#492]
            :        +- Filter (((isnotnull(d_date#494) AND (d_date#494 >= 11102)) AND (d_date#494 <= 11162)) AND isnotnull(d_date_sk#492))
            :           +- FileScan parquet [d_date_sk#492,d_date#494] Batched: true, DataFilters: [isnotnull(d_date#494), (d_date#494 >= 11102), (d_date#494 <= 11162), isnotnull(d_date_sk#492)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_date), GreaterThanOrEqual(d_date,2000-05-25), LessThanOrEqual(d_date,2000-07-24), Is..., ReadSchema: struct<d_date_sk:int,d_date:date>
            +- Project [ss_item_sk#131]
               +- Filter isnotnull(ss_item_sk#131)
                  +- FileScan parquet [ss_item_sk#131,ss_sold_date_sk#152] Batched: true, DataFilters: [isnotnull(ss_item_sk#131)], Format: Parquet, Location: InMemoryFileIndex[hdfs://aspyrou-1:9000/tpcds-data/store_sales], PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk)], ReadSchema: struct<ss_item_sk:int>
.
Execution time: 25.164513666999998s
Results written to table: 'sqlPerformance' at hdfs:///tpcds-result/timestamp=1662649970965
Reading result at hdfs:///tpcds-result/timestamp=1662649970965
+--------------------+---------+--------------------+------+-------------+
|       configuration|iteration|             results|  tags|    timestamp|
+--------------------+---------+--------------------+------+-------------+
|{2, {spark-f931be...|        1|[{0.006723, [], 1...|{true}|1662649970965|
|{2, {spark-f931be...|        2|[{8.12E-4, [], 11...|{true}|1662649970965|
|{2, {spark-f931be...|        3|[{8.6E-4, [], 234...|{true}|1662649970965|
+--------------------+---------+--------------------+------+-------------+

+---------+---------+------------------+
|iteration|queryName|  executionSeconds|
+---------+---------+------------------+
|        1| q64-v2.4|     132.062850862|
|        1| q70-v2.4|      15.216641577|
|        1| q82-v2.4|       24.67842403|
|        2| q64-v2.4|115.96094463300001|
|        2| q70-v2.4|13.594237106000001|
|        2| q82-v2.4|      21.697501952|
|        3| q64-v2.4|234.87521209399998|
|        3| q70-v2.4|       16.82603787|
|        3| q82-v2.4|25.164513666999998|
+---------+---------+------------------+

Final results at hdfs:///tpcds-result/timestamp=1662649970965
+---------+--------------------+------------------+------------------+
|queryName|medianRuntimeSeconds| minRuntimeSeconds| maxRuntimeSeconds|
+---------+--------------------+------------------+------------------+
| q64-v2.4|       132.062850862|115.96094463300001|234.87521209399998|
| q70-v2.4|        15.216641577|13.594237106000001|       16.82603787|
| q82-v2.4|         24.67842403|      21.697501952|25.164513666999998|
+---------+--------------------+------------------+------------------+

2022-09-08 15:23:19,031 WARN k8s.ExecutorPodsWatchSnapshotSource: Kubernetes client has been closed (this is expected if the application is shutting down.)
